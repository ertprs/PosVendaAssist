^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300    1) <?php
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300    2) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300    3) include 'dbconfig.php';
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300    4) include 'includes/dbconnect-inc.php';
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300    5) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300    6) $admin_privilegios = "cadastros";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300    7) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300    8) include 'autentica_admin.php';
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300    9) include 'funcoes.php';
606757d2 (root               2011-07-19 09:50:40 -0300   10) 
606757d2 (root               2011-07-19 09:50:40 -0300   11) $fabricaIntervaloSerie = array(15,45);
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300   12) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300   13) $msg_erro = "";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300   14) //  HD 96953 - Fotos de produtos para a Britânia
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300   15) if ($login_fabrica == 3 or $login_fabrica > 80) {
40f412d8 (root               2011-06-21 17:15:14 -0300   16) 		$imgType = '';
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300   17) 	function open_image ($file) {
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300   18) 		global $imgType;
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300   19) 		$img_data = getimagesize($file);
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300   20) 		switch($img_data["mime"]){
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300   21) 			case "image/jpeg":
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300   22) 				$im = imagecreatefromjpeg($file); //jpeg file
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300   23) 				$imgType = 'jpg';
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300   24) 			break;
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300   25) 			case "image/gif":
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300   26) 				$im = imagecreatefromgif($file); //gif file
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300   27) 				$imgType = 'gif';
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300   28) 			break;
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300   29) 			case "image/png":
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300   30) 				$im = imagecreatefrompng($file); //png file
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300   31) 				$imgType = 'png';
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300   32) 			break;
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300   33) 			case "image/bmp":
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300   34) 				$im = imagecreatefromwbmp($file); //png file
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300   35) 				$imgType = 'bmp';
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300   36) 			break;
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300   37) 			default:
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300   38) 			$im=false;
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300   39) 			break;
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300   40) 		}
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300   41) 		return $im;
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300   42) 	}
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300   43) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300   44) 	function save_image($file, $dest_path, $format='jpeg') {
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300   45) 		// Grava a imagem no $dest_path, no formato $format
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300   46) 		switch($format){
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300   47) 			case "bmp":
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300   48) 			case "jpg":
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300   49) 			case "jpeg":
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300   50) 				$ret = imagejpeg($file, $dest_path, 80); // Salva em formato JPeG
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300   51) 			break;
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300   52) 			case "gif":
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300   53) 				$ret = imagegif($file, $dest_path); // Salva como GIF
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300   54) 			break;
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300   55) 			case "png":
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300   56) 				$ret = imagepng($file, $dest_path, 2); // Salva como PNG, compressão nível 2
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300   57) 			break;
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300   58) 			default:
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300   59) 			$ret = false;
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300   60) 			break;
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300   61) 		}
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300   62) 		return $ret;
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300   63) 	}
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300   64) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300   65) 	function reduz_imagem($img, $max_x, $max_y, $nome_foto, $formato = 'jpg') {
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300   66)         list($original_x, $original_y) = getimagesize($img);    //pega o tamanho da imagem
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300   67) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300   68)         // se a largura for maior que altura
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300   69)         if($original_x > $original_y) {
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300   70)            $porcentagem = (100 * $max_x) / $original_x;
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300   71)         }
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300   72)         else {
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300   73)            $porcentagem = (100 * $max_y) / $original_y;
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300   74)         }
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300   75) 
40f412d8 (root               2011-06-21 17:15:14 -0300   76)         $tamanho_x    = $original_x * ($porcentagem / 100);
40f412d8 (root               2011-06-21 17:15:14 -0300   77)         $tamanho_y    = $original_y * ($porcentagem / 100);
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300   78)         $image_p    = imagecreatetruecolor($tamanho_x, $tamanho_y);
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300   79)         $image		= open_image($img);
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300   80) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300   81)         imagecopyresampled($image_p, $image, 0, 0, 0, 0, $tamanho_x, $tamanho_y, $original_x, $original_y);
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300   82)         return save_image($image_p, $nome_foto, $formato);
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300   83)     }
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300   84) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300   85)     if (isset($_FILES['arquivo'])) {
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300   86) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300   87)         $a_foto = $_FILES["arquivo"];
606757d2 (root               2011-07-19 09:50:40 -0300   88) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300   89)         if ($a_foto['tmp_name'] <> '' and
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300   90)             $a_foto['name'] != '' and
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300   91)             $a_foto['error'] == UPLOAD_ERR_OK and
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300   92) 			$a_foto['size'] < 1048576) { //HD 404604 - Rogério da Wanke pediu para liberar até 1Mb.
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300   93)             $Destino  = "/www/assist/www/imagens_produtos/$login_fabrica/media/";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300   94)             $DestinoP = "/www/assist/www/imagens_produtos/$login_fabrica/pequena/";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300   95)             $Nome     = $a_foto['name'];
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300   96)             $Tamanho  = $a_foto['size'];
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300   97)             $Tipo     = $a_foto['type'];
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300   98)             $Tmpname  = $a_foto['tmp_name'];
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300   99) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  100) 			if (preg_match('/^image\/(x-ms-bmp|bmp|x-bmp|pjpeg|jpeg|png|x-png|gif|jpg)$/', $Tipo)) {
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  101)                 if (!is_uploaded_file($Tmpname)) {
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  102)                     $msg_erro .= "Não foi possível efetuar o upload.";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  103)                 } else {
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  104)                     $ext = substr($Nome, strrpos($Nome, ".")+1);
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  105)                     if (strlen($Nome) == 0 and $ext <> "") {
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  106)                         $ext = $Nome;
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  107)                     }
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  108) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  109) 					list($void, $tipo_MIME) = explode('/', $Tipo);
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  110) 					$Caminho_foto	= $Destino . "$produto.jpg";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  111) 					$Caminho_thumb	= $DestinoP. "$produto.jpg";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  112) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  113) 					// Salvar o arquivo de imagem se já existir
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  114) 					$arq_ant = glob("$Destino$produto.{gif,GIF,png,PNG,jpg,JPG}", GLOB_BRACE);
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  115) 					//echo '<code>' . print_r($arq_ant) . '</code>';
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  116) 					if (count($arq_ant)) {
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  117) 						$img_anterior = $Destino . 'temp_' . basename($arq_ant[0]);
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  118) 						$thumb_anterior = $DestinoP . 'temp_' . basename($arq_ant[0]);
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  119) 						rename($arq_ant[0], $img_anterior);
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  120) 						rename(str_replace('media', 'pequena', $arq_ant[0]), $thumb_anterior);
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  121) 						$excl_ant = true;
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  122) 						//echo "<p>Imagem anterior: $img_anterior</p>";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  123) 					}
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  124) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  125) 					/* Estas linhas são para ajustar a extensão do arquivo ao formato,
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300  126) 					 * mas, por enquanto, o formato destino vai ser sempre JPG...
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  127) 					 * Comentando código.
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  128) 					 $path_info	= pathinfo($Caminho_foto);
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  129) 					 $nome		= $path_info['dirname'] . '/' . $path_info['filename'];
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  130) 					 $ext		= $path_info['extension'];
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  131) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  132) 					 if ($ext != $tipo_MIME) { // Muda a extensão do arquivo de acordo com o conteúdo
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  133) 					 $ext = ($tipo_MIME  == 'jpeg' or $tipo_MIME == 'bmp') ? 'jpg' : $tipo_MIME;
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  134) 					 }
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  135) 					 echo "\nExtensão: $ext\n<br />\n";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  136) 					 echo $Caminho_foto = $nome . '.' . $ext;
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  137) 					 */
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  138)                     reduz_imagem($Tmpname, 400,    300, $Caminho_foto);
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  139) 					if (!file_exists($Caminho_foto)) {
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  140) 						$msg_erro.= 'Não foi possível adicionar a imagem, formato não reconhecido.';
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  141) 						if ($excl_ant) {
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  142) 							rename($img_anterior, $arq_ant[0]); //Voltar o arquivo de imagem que já existia
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  143) 							rename($thumb_anterior, str_replace('media', 'pequena', $arq_ant[0]));
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  144) 						}
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  145) 					} else {
40f412d8 (root               2011-06-21 17:15:14 -0300  146)                     reduz_imagem($Tmpname, 80,    60,  $Caminho_thumb);
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  147) 						if ($excl_ant) {
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  148) 							unlink($img_anterior); //Excluir definitivamente o arquivo anterior, se existia
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  149) 							unlink($thumb_anterior); //Excluir definitivamente o arquivo anterior, se existia
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  150) 						}
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  151) 					}
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  152)                 }
606757d2 (root               2011-07-19 09:50:40 -0300  153) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  154)             } else {
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  155)                 $msg_erro .= "O formato do arquivo $Nome não é permitido!<br>";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  156)             }
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  157) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  158)         } else {
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  159) 			switch ($a_foto['error']) {
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  160) 				case 0: if ($a_foto['name'] != '' and $a_foto['tmp_name'] == '') $msg_erro .= 'Erro ao processar o arquivo ' . $a_foto['name'] . '.<br>'; break;
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  161) 				case 1: $msg_erro .= "O tamanho do arquivo é maior do que o permitido (2Mb)!<br>"; break;
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  162) 				case 2: $msg_erro .= "O tamanho do arquivo é maior do que o permitido (1Mb)!<br>"; break;
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  163) 				case 3: $msg_erro .= 'O arquivo não foi enviado completo, tente novamente.<br>'; break;
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  164) 				case 4: if ($a_foto['name'] != '') $msg_erro .= 'Arquivo não recebido.<br>'; break;
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  165) 				default: $msg_erro .= 'Erro interno. Tente novamente ou contate com a Telecontrol.<br>';
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  166) 			}
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  167)         }
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  168) 		/*if ($msg_erro) exit("<p>$msg_erro</p></body></html>");*/
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  169)     }
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  170) }
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  171) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  172) if (strlen($_GET['msg']) > 10) { //HD 406404 - Obrigar ao navegador a carregar de novo a imagem.
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  173) 	header("Cache-Control: no-cache, must-revalidate");
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  174) 	header("Expires: Sat, 26 Jul 1997 05:00:00 GMT");
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  175) }
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  176) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  177) $acao    = trim($_REQUEST["acao"]);
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  178) $btnacao = trim($_REQUEST["btnacao"]);
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  179) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  180) //HD 374998 - Usuários que podem alterar a liberação de produtos para diversos países (Bosch)
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  181) $prod_libera_br     = (in_array($login_admin, array(515,516)));
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  182) $prod_libera_outros = (pg_fetch_result(
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  183) 						pg_query($con,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  184) 								"SELECT altera_pais_produto FROM tbl_admin WHERE admin = $login_admin"), 0) == 't');
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  185) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  186) if ($acao == "a" and strlen($produto) > 0) {
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  187)     $pais = $_GET["pais"];
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  188)     if (strlen($pais)) {
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  189)         $sql = "SELECT produto,pais FROM tbl_produto_pais WHERE produto=$produto AND pais = '$pais'";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  190)         $res = @pg_query ($con,$sql);
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  191)         if(pg_num_rows($res)>0){
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  192)             $sql = "DELETE FROM tbl_produto_pais WHERE produto=$produto AND pais = '$pais'";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  193)             $res = @pg_query ($con,$sql);
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  194)         }
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  195)     }
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  196)     header ("Location: $PHP_SELF?produto=$produto");
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  197) }
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  198) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  199) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  200) if ($acao == "atribui" and strlen($produto) > 0) {
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  201)     $pais            = $_GET["pais"];
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  202)     $garantia_pais    = $_GET["garantia_pais"];
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  203) 
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300  204) 	if (!empty($_GET['preco_pais'])) {
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300  205) 		$preco_pais = str_replace(',', '.', $_GET['preco_pais']);
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300  206) 	} else {
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300  207) 		$preco_pais = 'null';
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300  208) 	}
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300  209) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  210)     if (strlen($garantia_pais) == 0) {
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  211)         $garantia_pais="null";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  212)     }
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  213) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  214)     if (strlen($pais) > 0) {
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  215)         $sql = "SELECT produto,pais FROM tbl_produto_pais WHERE produto=$produto AND pais = '$pais'";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  216)         $res = @pg_query ($con,$sql);
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  217)         if (pg_num_rows($res) == 0) {
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300  218)             $sql = "INSERT INTO tbl_produto_pais (produto,pais, garantia, valor) VALUES ($produto,'$pais', $garantia_pais, $preco_pais)";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  219)             $res = pg_query ($con,$sql);
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  220)         }
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  221)     }
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  222)     header ("Location: $PHP_SELF?produto=$produto");
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  223) }
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  224) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  225) if ($btnacao == "deletar" and strlen($produto) > 0) {
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  226) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  227)     $res = pg_query ($con,"BEGIN TRANSACTION");
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  228) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  229)     $sql = "DELETE FROM tbl_lista_basica
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  230)             WHERE  tbl_lista_basica.produto = tbl_produto.produto
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  231)             AND    tbl_produto.linha   = tbl_linha.linha
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  232)             AND    tbl_linha.fabrica   = $login_fabrica
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  233)             AND    tbl_produto.produto = $produto;";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  234)     $res = @pg_query ($con,$sql);
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  235)     $msg_erro = pg_errormessage($con);
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  236) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  237)     if (strlen($msg_erro) > 0) {
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  238)         if(strpos($msg_erro,'update or delete on "tbl_produto" violates foreign key constraint "$1" on "tbl_lista_basica"'))
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  239)             $msg_erro = "Este produto está presente na Lista Básica, e não pode ser apagado.";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  240)     }
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300  241) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  242)     if (strlen($msg_erro) == 0) {
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  243)         $sql = "DELETE FROM tbl_produto
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  244)                 WHERE  tbl_produto.linha   = tbl_linha.linha
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  245)                 AND    tbl_linha.fabrica   = $login_fabrica
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  246)                 AND    tbl_produto.produto = $produto;";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  247)         $res = @pg_query ($con,$sql);
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  248)         $msg_erro = pg_errormessage($con);
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300  249) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  250)         if(strpos($msg_erro,'update or delete on "tbl_produto" violates foreign key constraint "$1" on "tbl_subproduto"'))
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  251)             $msg_erro = "Não foi possível apagar o produto, pois o mesmo encontra-se cadastrado na tabela de subproduto.";
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300  252) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  253)         if(strpos($msg_erro,'update or delete on "tbl_produto" violates foreign key constraint "$2" on "tbl_subproduto"'))
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  254)             $msg_erro = "Não foi possível apagar o produto, pois o mesmo encontra-se cadastrado na tabela de subproduto.";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  255) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  256)         if(strpos($msg_erro,'"$1" on "tbl_produto_tipo_posto"'))
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  257)             $msg_erro = "Não foi possível apagar o produto, pois o mesmo encontra-se cadastrado na tabela de tipo posto mão-de-obra.";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  258) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  259)         if(strpos($msg_erro,'constraint "produto_fk" on "tbl_os"'))
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  260)             $msg_erro = "Não foi possível apagar o produto, pois o mesmo encontra-se cadastrado em uma Ordem de Serviço.";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  261) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  262)     }
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300  263) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  264)     if (strlen($msg_erro) == 0) {
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  265)         ###CONCLUI OPERAÇÃO DE INCLUSÃO/EXLUSÃO/ALTERAÇÃO E SUBMETE
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  266)         $res = pg_query ($con,"COMMIT TRANSACTION");
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  267)         header ("Location: $PHP_SELF");
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  268)         exit;
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  269)     }else{
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  270)         ###ABORTA OPERAÇÃO DE INCLUSÃO/EXLUSÃO/ALTERAÇÃO E RECARREGA CAMPOS
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  271)         $marca                    = $_POST["marca"];
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  272)         $produto                  = $_POST["produto"];
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  273)         $linha                    = $_POST["linha"];
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  274)         $familia                  = $_POST["familia"];
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  275)         $descricao                = $_POST["descricao"];
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  276)         $referencia               = $_POST["referencia"];
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  277)         $voltagem                 = $_POST["voltagem"];
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  278)         $garantia                 = $_POST["garantia"];
a53578b1 (aoki               2011-11-22 14:46:57 -0300  279) 		$garantia_horas           = $_POST["garantia_horas"];
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  280)         $preco                    = $_POST["preco"];
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  281)         $mao_de_obra              = $_POST["mao_de_obra"];
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  282)         $mao_de_obra_admin        = $_POST["mao_de_obra_admin"];
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  283)         $mao_de_obra_troca        = $_POST["mao_de_obra_troca"];
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  284)         $valor_troca_gas          = $_POST["valor_troca_gas"];
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  285)         $nome_comercial           = $_POST["nome_comercial"];
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  286)         $classificacao_fiscal     = $_POST["classificacao_fiscal"];
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  287)         $ipi                      = $_POST["ipi"];
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  288)         $radical_serie            = $_POST["radical_serie"];
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  289)         $radical_serie2           = $_POST["radical_serie2"];
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  290)         $radical_serie3           = $_POST["radical_serie3"];
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  291)         $radical_serie4           = $_POST["radical_serie4"];
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  292)         $radical_serie5           = $_POST["radical_serie5"];
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  293)         $radical_serie6           = $_POST["radical_serie6"];
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  294)         $numero_serie_obrigatorio = $_POST["numero_serie_obrigatorio"];
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  295)         $produto_principal        = $_POST["produto_principal"];
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  296)         $locador                  = $_POST["locador"];
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  297)         $ativo                    = $_POST["ativo"];
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  298)         $uso_interno_ativo        = $_POST["uso_interno_ativo"];
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  299)         $referencia_fabrica       = trim($_POST["referencia_fabrica"]);
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  300)         $code_convention          = $_POST["code_convention"];
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  301)         $abre_os                  = $_POST["abre_os"];
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  302)         $aviso_email              = $_POST["aviso_email"];
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  303)         $troca_obrigatoria        = $_POST["troca_obrigatoria"];
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  304)         $produto_critico          = $_POST["produto_critico"];
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  305)         $intervencao_tecnica      = $_POST["intervencao_tecnica"];
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  306)         $origem                   = $_POST["origem"];
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  307)         $qtd_etiqueta_os          = $_POST["qtd_etiqueta_os"];
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  308)         $lista_troca              = $_POST["lista_troca"];
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  309)         $produto_fornecedor       = $_POST["produto_fornecedor"];
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  310)         $valor_troca              = $_POST["valor_troca"];
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  311)         $troca_garantia           = $_POST["troca_garantia"];
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  312)         $troca_faturada           = $_POST["troca_faturada"];
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  313)         $observacao               = $_POST["observacao"];
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  314) 		$serie_in                 = $_POST["serie_in"];
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  315) 		$serie_out                = $_POST["serie_out"];
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  316) 		$apagar_serie             = $_POST["apagar_serie"];
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300  317) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  318)         $res = pg_query ($con,"ROLLBACK TRANSACTION");
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  319)     }
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  320) }
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  321) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  322) if ($btnacao == "gravar") {
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300  323) 
40f412d8 (root               2011-06-21 17:15:14 -0300  324)     if (strlen($_POST["linha"]) > 0)                $aux_linha = "'". trim($_POST["linha"]) ."'";
40f412d8 (root               2011-06-21 17:15:14 -0300  325)     else                                            $msg_erro = "Selecione a linha do produto.";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  326) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  327)     $aux_familia = (strlen($_POST["familia"]) > 0) ? "'". trim($_POST["familia"]) ."'" : "null";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  328) 
40f412d8 (root               2011-06-21 17:15:14 -0300  329)     if (strlen($_POST["mao_de_obra"]) > 0)            $aux_mao_de_obra = "'". trim($_POST["mao_de_obra"]) ."'";
40f412d8 (root               2011-06-21 17:15:14 -0300  330)     else{
40f412d8 (root               2011-06-21 17:15:14 -0300  331) 		if($login_fabrica != 96){
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  332) 			$msg_erro = "Digite o valor da mão-de-obra.";
40f412d8 (root               2011-06-21 17:15:14 -0300  333) 		}
40f412d8 (root               2011-06-21 17:15:14 -0300  334) 		else{
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  335) 			$aux_mao_de_obra = "'0'";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  336) 		}
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  337) 	}
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  338) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  339)     if (strlen($_POST["mao_de_obra_admin"]) > 0)    $aux_mao_de_obra_admin = "'". trim($_POST["mao_de_obra_admin"]) ."'";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  340)     else                                            $aux_mao_de_obra_admin = "null";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  341) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  342)     if (strlen($_POST["mao_de_obra_troca"]) > 0)    $aux_mao_de_obra_troca = "'". trim($_POST["mao_de_obra_troca"]) ."'";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  343)     else                                            $aux_mao_de_obra_troca = "null";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  344) 
40f412d8 (root               2011-06-21 17:15:14 -0300  345)     if (strlen($_POST["origem"]) > 0)                $aux_origem = "'". trim($_POST["origem"]) ."'";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  346)     else                                            $aux_origem = "null";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  347) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  348)     if (strlen($_POST["mao_de_obra_admin"]) > 0) {
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  349)         $aux_mao_de_obra_admin = "'". trim($_POST["mao_de_obra_admin"]) ."'";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  350)     } else {
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  351)         if ($login_fabrica == 1) {
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  352)             #hd 230831 a fabiola não quer que seja igual e não tem quem explique para ela....
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  353)             $aux_mao_de_obra_admin = "'"."0"."'";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  354)         } else {
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  355)             $aux_mao_de_obra_admin = $aux_mao_de_obra;
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  356)         }
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  357)     }
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  358) 
40f412d8 (root               2011-06-21 17:15:14 -0300  359)     if (strlen($_POST["valor_troca_gas"]) > 0)        $aux_valor_troca_gas= "'". trim($_POST["valor_troca_gas"]) ."'";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  360)     else                                            $aux_valor_troca_gas= "'0'";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  361) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  362)     if (strlen($_POST["preco"]) > 0)                $aux_preco = "'". trim($_POST["preco"]) ."'";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  363)     else                                            $aux_preco = "null";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  364) 
40f412d8 (root               2011-06-21 17:15:14 -0300  365)     if (strlen($_POST["garantia"]) > 0)                $aux_garantia = "'". trim($_POST["garantia"]) ."'";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  366)     else                                            $msg_erro = "Digite a garantia do produto.";
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300  367) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  368)     if (strlen($_POST["descricao"]) > 0)            $aux_descricao = "'". trim($_POST["descricao"]) ."'";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  369)     else                                            $msg_erro = "Digite a descrição do produto.";
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300  370) 
40f412d8 (root               2011-06-21 17:15:14 -0300  371)     if (strlen($_POST["referencia"]) > 0)            $aux_referencia = "'". trim($_POST["referencia"]) ."'";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  372)     else                                            $msg_erro = "Digite o referência do produto.";
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300  373) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  374)     if (in_array($login_fabrica,array(1,20,24,80,96))) {
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  375)         if (strlen($_POST["referencia_fabrica"]) > 0)    $aux_referencia_fabrica = "'". trim($_POST["referencia_fabrica"]) ."'";
40f412d8 (root               2011-06-21 17:15:14 -0300  376)         else{
40f412d8 (root               2011-06-21 17:15:14 -0300  377) 			if($login_fabrica == 96){
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  378) 				$msg_erro = "Digite o nome comercial do produto.";
40f412d8 (root               2011-06-21 17:15:14 -0300  379) 			}
40f412d8 (root               2011-06-21 17:15:14 -0300  380) 			else{
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  381) 				$msg_erro = "Digite a referência interna do produto.";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  382) 			}
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  383) 		}
40f412d8 (root               2011-06-21 17:15:14 -0300  384)     }else{
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  385)         $aux_referencia_fabrica = "'". trim($_POST["referencia"]) ."'";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  386)     }
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300  387) 
40f412d8 (root               2011-06-21 17:15:14 -0300  388)     if (strlen($_POST["code_convention"]) > 0)        $aux_code_convention = "'". trim($_POST["code_convention"]) ."'";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  389)     else                                            $aux_code_convention = "null";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  390) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  391)     $aux_voltagem = (strlen($_POST["voltagem"]) > 0) ? "'". trim($_POST["voltagem"]) ."'" : "null";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  392) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  393)     #HD 22873
40f412d8 (root               2011-06-21 17:15:14 -0300  394)     if (strlen($_POST["capacidade"]) > 0)            $aux_capacidade = trim($_POST["capacidade"]);
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  395)     else                                            $aux_capacidade = "null";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  396) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  397)     #HD 22873
40f412d8 (root               2011-06-21 17:15:14 -0300  398)     if (strlen($_POST["divisao"]) > 0)                $aux_divisao = "'". trim($_POST["divisao"]) ."'";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  399)     else                                            $aux_divisao = "null";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  400) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  401)     if (strlen($_POST["ativo"]) > 0){
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  402)         $aux_ativo = "'". trim($_POST["ativo"]) ."'";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  403)     }else{
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  404)         $msg_erro = "Por favor! Escolha o Status Rede para Ativo ou Inativo";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  405)     }
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  406) 
40f412d8 (root               2011-06-21 17:15:14 -0300  407)     if (strlen($_POST["uso_interno_ativo"]) > 0)                $aux_uso_interno_ativo = "'". trim($_POST["uso_interno_ativo"]) ."'";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  408)     else                                            $msg_erro = "Por favor! Escolha o Status Uso Interno Ativo ou Inativo";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  409) 
40f412d8 (root               2011-06-21 17:15:14 -0300  410)     if (strlen($_POST["produto_fornecedor"]) > 0)    $aux_produto_fornecedor = "'". trim($_POST["produto_fornecedor"]) ."'";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  411)     else                                            $aux_produto_fornecedor = "null";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  412) 
40f412d8 (root               2011-06-21 17:15:14 -0300  413)     if (strlen($_POST["nome_comercial"]) > 0)        $aux_nome_comercial = trim($_POST["nome_comercial"]) ;
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  414)     else                                            $aux_nome_comercial = "null";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  415) 
40f412d8 (root               2011-06-21 17:15:14 -0300  416)     if (strlen($_POST["classificacao_fiscal"]) > 0)    $aux_classificacao_fiscal = trim($_POST["classificacao_fiscal"]) ;
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  417)     else                                            $aux_classificacao_fiscal = "null";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  418) 
40f412d8 (root               2011-06-21 17:15:14 -0300  419)     if (strlen($_POST["ipi"]) > 0)                    $aux_ipi = trim($_POST["ipi"]) ;
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  420)     else                                            $aux_ipi = "null";
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300  421) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  422)     if (strlen($_POST["radical_serie"]) > 0)        $aux_radical_serie = "'".trim($_POST["radical_serie"])."'";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  423)     else                                            $aux_radical_serie = 'null';
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  424) 
40f412d8 (root               2011-06-21 17:15:14 -0300  425)     if (strlen($_POST["radical_serie2"]) > 0)        $aux_radical_serie2 = "'".trim($_POST["radical_serie2"])."'";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  426)     else                                            $aux_radical_serie2 = 'null';
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  427) 
40f412d8 (root               2011-06-21 17:15:14 -0300  428)     if (strlen($_POST["radical_serie3"]) > 0)        $aux_radical_serie3 = "'".trim($_POST["radical_serie3"])."'";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  429)     else                                            $aux_radical_serie3 = 'null';
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  430) 
40f412d8 (root               2011-06-21 17:15:14 -0300  431)     if (strlen($_POST["radical_serie4"]) > 0)        $aux_radical_serie4 = "'".trim($_POST["radical_serie4"])."'";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  432)     else                                            $aux_radical_serie4 = 'null';
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  433) 
40f412d8 (root               2011-06-21 17:15:14 -0300  434)     if (strlen($_POST["radical_serie5"]) > 0)        $aux_radical_serie5 = "'".trim($_POST["radical_serie5"])."'";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  435)     else                                            $aux_radical_serie5 = 'null';
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  436) 
40f412d8 (root               2011-06-21 17:15:14 -0300  437)     if (strlen($_POST["radical_serie6"]) > 0)        $aux_radical_serie6 = "'".trim($_POST["radical_serie6"])."'";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  438)     else                                            $aux_radical_serie6= 'null';
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  439) 
40f412d8 (root               2011-06-21 17:15:14 -0300  440)     if (strlen($_POST["qtd_etiqueta_os"]) > 0)        $aux_qtd_etiqueta_os = trim($_POST["qtd_etiqueta_os"]) ;
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  441)     else                                            $aux_qtd_etiqueta_os = "null";
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300  442) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  443)     if (strlen($_POST["marca"]) > 0)                $aux_marca = trim($_POST["marca"]) ;
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  444)     else                                            $aux_marca = "null";
40f412d8 (root               2011-06-21 17:15:14 -0300  445)     //$radical_serie = trim ($_POST ['radical_serie']);
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300  446) 
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300  447)     if (strlen($_POST["valor_troca"]) > 0)    $aux_valor_troca = trim($_POST["valor_troca"]) ; //hd 7474 TAKASHI 23/11/07
40f412d8 (root               2011-06-21 17:15:14 -0300  448)     else                                    $aux_valor_troca = "null";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  449) 
40f412d8 (root               2011-06-21 17:15:14 -0300  450)     if (strlen($_POST["observacao"]) > 0)    $observacao = trim($_POST["observacao"]) ; //113180
40f412d8 (root               2011-06-21 17:15:14 -0300  451)     else                                    $observacao = "null";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  452) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  453)     $sistema_operacional = (strlen($_POST["sistema_operacional"]) > 0) ? trim($_POST["sistema_operacional"]) : "null";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  454) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  455)     $serie_inicial = strtoupper($_POST["serie_inicial"]);
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  456)     $serie_final   = strtoupper($_POST["serie_final"]);
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  457)     $validar_serie = isset($_POST["validar_serie"]) ? 't' : 'f';//HD 256659
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  458) 
40f412d8 (root               2011-06-21 17:15:14 -0300  459)     $troca_garantia = $_POST["troca_garantia"];
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  460)     $aux_troca_garantia = $troca_garantia;
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  461) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  462)     if (strlen($troca_garantia) == 0) {
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  463)         $aux_troca_garantia = "f";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  464)     }
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  465) 
40f412d8 (root               2011-06-21 17:15:14 -0300  466)     $troca_faturada = $_POST["troca_faturada"];
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  467)     $aux_troca_faturada = $troca_faturada;
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  468) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  469)     if (strlen($troca_faturada) == 0) {
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  470)         $aux_troca_faturada = "f";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  471)     }
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  472) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  473)     if (strlen($_POST['link_img']) > 0) {
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  474)         $aux_link_img   = ($link_img=$_POST['link_img']);
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  475)     }
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  476) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  477)     $produto_critico         = $_POST['produto_critico'];
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  478)     $aux_produto_critico     = $produto_critico;
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  479) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  480)     $troca_obrigatoria       = $_POST['troca_obrigatoria'];
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  481)     $aux_troca_obrigatoria   = $troca_obrigatoria;
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  482) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  483)     $intervencao_tecnica     = $_POST['intervencao_tecnica'];
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  484)     $aux_intervencao_tecnica = $intervencao_tecnica;
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  485) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  486)     $numero_serie_obrigatorio     = $_POST['numero_serie_obrigatorio'];
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  487)     $aux_numero_serie_obrigatorio = $numero_serie_obrigatorio;
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300  488) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  489)     if (strlen($numero_serie_obrigatorio) == 0) $aux_numero_serie_obrigatorio = "f";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  490)     if (strlen($troca_obrigatoria) == 0)        $aux_troca_obrigatoria = "f";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  491)     if (strlen($produto_critico) == 0)          $aux_produto_critico = "f";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  492)     if (strlen($intervencao_tecnica) == 0)      $aux_intervencao_tecnica = "f";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  493) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  494)     $produto_principal = $_POST['produto_principal'];
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  495)     $aux_produto_principal = $produto_principal;
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  496)     if (strlen($produto_principal) == 0) $aux_produto_principal = "f";
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300  497) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  498)     $aux_locador = trim($_POST["locador"]);
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  499)     if (strlen($aux_locador) == 0) $aux_locador = "f";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  500) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  501)     $lista_troca = trim($_POST["lista_troca"]);
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  502)     $aux_lista_troca = (strlen($lista_troca) == 0) ? "FALSE" : "TRUE";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  503) 
37cd7adb (guilhermecurcio    2012-07-18 16:40:51 -0300  504)     if ($login_fabrica == 14 or $login_fabrica == 66 or $login_fabrica == 11) {
40f412d8 (root               2011-06-21 17:15:14 -0300  505)         $aux_abre_os = (strlen(trim($_POST["abre_os"])) > 0) ?  trim($_POST["abre_os"]) : 'f';
40f412d8 (root               2011-06-21 17:15:14 -0300  506) 
37cd7adb (guilhermecurcio    2012-07-18 16:40:51 -0300  507)         if ($login_fabrica <> 11) {
37cd7adb (guilhermecurcio    2012-07-18 16:40:51 -0300  508)              $aux_aviso_email = trim($_POST["aviso_email"]);
37cd7adb (guilhermecurcio    2012-07-18 16:40:51 -0300  509)              $retorno_produto = ($aux_aviso_email == 'f')  ? "'" . date("Y-m-d H:i:s") . "'" : "null";
37cd7adb (guilhermecurcio    2012-07-18 16:40:51 -0300  510)         } else {
37cd7adb (guilhermecurcio    2012-07-18 16:40:51 -0300  511)              $aux_aviso_email = 't';
37cd7adb (guilhermecurcio    2012-07-18 16:40:51 -0300  512)              $retorno_produto = "null";
37cd7adb (guilhermecurcio    2012-07-18 16:40:51 -0300  513)         }
37cd7adb (guilhermecurcio    2012-07-18 16:40:51 -0300  514)        
40f412d8 (root               2011-06-21 17:15:14 -0300  515)     }else{
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  516)         $aux_abre_os     = 't';
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  517)         $aux_aviso_email = 't';
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  518)         $retorno_produto = "null";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  519)     }
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  520) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  521)     # HD 50627
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  522)     $link_img = $_POST["link_img"];
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  523) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  524)     #HD 16207
40f412d8 (root               2011-06-21 17:15:14 -0300  525)     if ($login_fabrica<>1 and $login_fabrica <> 96){
40f412d8 (root               2011-06-21 17:15:14 -0300  526)         if (strlen($produto) > 0) {
40f412d8 (root               2011-06-21 17:15:14 -0300  527)             $sql_referencia = " AND tbl_produto.produto <> $produto ";
40f412d8 (root               2011-06-21 17:15:14 -0300  528)         }
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300  529) 
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300  530)       $sql = "SELECT produto,referencia,descricao
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  531)                 FROM tbl_produto
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  532)                 JOIN tbl_linha USING(linha)
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300  533)                 WHERE tbl_linha.fabrica      = $login_fabrica
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  534)                 AND   tbl_produto.referencia = $aux_referencia
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  535)                 $sql_referencia
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  536)                 ";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  537)         $res = pg_query ($con,$sql);
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  538)         if (@pg_num_rows($res) > 0){
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  539)             $msg_erro .= "Já existe um produto cadastrado com esta referência.";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  540)         }
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  541)     }
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  542) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  543)     if ($troca_obrigatoria == 't' and $produto_critico =='t') {
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  544)         $msg_erro .= "Troca obrigatoria e produto critico não podem estar selecionados para o mesmo produto";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  545)     }
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  546) 
a53578b1 (aoki               2011-11-22 14:46:57 -0300  547) 	//$aux_garantia_horas = !empty($garantia_horas) ? $garantia_horas : '';
a53578b1 (aoki               2011-11-22 14:46:57 -0300  548) 
a53578b1 (aoki               2011-11-22 14:46:57 -0300  549) 	if ($login_fabrica == 87){
a53578b1 (aoki               2011-11-22 14:46:57 -0300  550) 		$aux_garantia_horas = $garantia_horas;
a53578b1 (aoki               2011-11-22 14:46:57 -0300  551) 	} else {
a53578b1 (aoki               2011-11-22 14:46:57 -0300  552) 	$aux_garantia_horas = 0;
a53578b1 (aoki               2011-11-22 14:46:57 -0300  553) 	}
a53578b1 (aoki               2011-11-22 14:46:57 -0300  554) 
d41057f0 (Ronald Santos      2012-05-30 15:30:14 -0300  555) 	if($login_fabrica == 42){
d41057f0 (Ronald Santos      2012-05-30 15:30:14 -0300  556) 		$aux_classe = $_POST['classe_produto'];
d41057f0 (Ronald Santos      2012-05-30 15:30:14 -0300  557) 	}
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300  558) 
63157ab1 (guilhermecurcio    2012-07-17 11:20:34 -0300  559)     if ($login_fabrica == 42) {
63157ab1 (guilhermecurcio    2012-07-17 11:20:34 -0300  560)         $entrega_tecnica = $_POST["entrega_tecnica"];
63157ab1 (guilhermecurcio    2012-07-17 11:20:34 -0300  561) 
63157ab1 (guilhermecurcio    2012-07-17 11:20:34 -0300  562)         if ($entrega_tecnica <> "t") {
63157ab1 (guilhermecurcio    2012-07-17 11:20:34 -0300  563)             $entrega_tecnica = "f";
63157ab1 (guilhermecurcio    2012-07-17 11:20:34 -0300  564)         }
63157ab1 (guilhermecurcio    2012-07-17 11:20:34 -0300  565)     }
63157ab1 (guilhermecurcio    2012-07-17 11:20:34 -0300  566) 
a53578b1 (aoki               2011-11-22 14:46:57 -0300  567) 	if (strlen($msg_erro) == 0) {
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  568)         $res = pg_query ($con,"BEGIN TRANSACTION");
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  569) 		// echo $produto;
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  570) 		// exit;
a53578b1 (aoki               2011-11-22 14:46:57 -0300  571) 
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300  572) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  573)         if (strlen($produto) == 0) {
63157ab1 (guilhermecurcio    2012-07-17 11:20:34 -0300  574)             if ($login_fabrica == 42) {
63157ab1 (guilhermecurcio    2012-07-17 11:20:34 -0300  575)                 $sql_entrega_tecnica_c = ", entrega_tecnica";
63157ab1 (guilhermecurcio    2012-07-17 11:20:34 -0300  576)                 $sql_entrega_tecnica_v = ", '$sql_entrega_tecnica_v'";
63157ab1 (guilhermecurcio    2012-07-17 11:20:34 -0300  577)             }
63157ab1 (guilhermecurcio    2012-07-17 11:20:34 -0300  578) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  579)             ###INSERE NOVO REGISTRO
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  580)             $sql = "INSERT INTO tbl_produto (
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  581)                         linha                    ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  582)                         familia                  ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  583)                         descricao                ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  584)                         voltagem                 ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  585)                         referencia               ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  586)                         garantia                 ,
a53578b1 (aoki               2011-11-22 14:46:57 -0300  587) 						garantia_horas           ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  588)                         preco                    ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  589)                         mao_de_obra              ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  590)                         mao_de_obra_admin        ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  591)                         mao_de_obra_troca        ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  592)                         valor_troca_gas          ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  593)                         ativo                    ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  594)                         uso_interno_ativo        ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  595)                         /*off_line                 ,*/
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  596)                         nome_comercial           ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  597)                         classificacao_fiscal     ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  598)                         ipi                      ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  599)                         radical_serie            ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  600)                         radical_serie2           ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  601)                         radical_serie3           ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  602)                         radical_serie4           ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  603)                         radical_serie5           ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  604)                         radical_serie6           ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  605)                         numero_serie_obrigatorio ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  606)                         produto_principal        ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  607)                         locador                  ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  608)                         referencia_fabrica       ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  609)                         code_convention          ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  610)                         abre_os                  ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  611)                         aviso_email              ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  612)                         admin                    ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  613)                         data_atualizacao         ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  614)                         troca_obrigatoria        ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  615)                         produto_critico          ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  616)                         intervencao_tecnica      ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  617)                         origem                   ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  618)                         retorno_produto          ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  619)                         lista_troca              ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  620)                         qtd_etiqueta_os          ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  621)                         valor_troca              ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  622)                         troca_garantia           ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  623)                         troca_faturada           ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  624)                         marca                    ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  625)                         produto_fornecedor       ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  626)                         capacidade               ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  627)                         divisao                  ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  628)                         imagem                   ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  629)                         observacao               ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  630)                         sistema_operacional      ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  631)                         serie_inicial            ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  632)                         serie_final              ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  633)                         validar_serie
63157ab1 (guilhermecurcio    2012-07-17 11:20:34 -0300  634)                         $sql_entrega_tecnica_c
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  635)                     ) VALUES (
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  636)                         $aux_linha                       ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  637)                         $aux_familia                     ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  638)                         $aux_descricao                   ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  639)                         $aux_voltagem                    ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  640)                         $aux_referencia                  ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  641)                         $aux_garantia                    ,
a53578b1 (aoki               2011-11-22 14:46:57 -0300  642) 						$aux_garantia_horas              ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  643)                         fnc_limpa_moeda($aux_preco)      ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  644)                         fnc_limpa_moeda($aux_mao_de_obra),
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  645)                         fnc_limpa_moeda($aux_mao_de_obra_admin),
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  646)                         fnc_limpa_moeda($aux_mao_de_obra_troca),
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  647)                         fnc_limpa_moeda($aux_valor_troca_gas),
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  648)                         $aux_ativo                       ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  649)                         $aux_uso_interno_ativo          ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  650)                         /*$aux_off_line                    ,*/
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  651)                         '$nome_comercial'                ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  652)                         '$classificacao_fiscal'          ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  653)                         $aux_ipi                         ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  654)                         $aux_radical_serie               ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  655)                         $aux_radical_serie2              ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  656)                         $aux_radical_serie3              ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  657)                         $aux_radical_serie4              ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  658)                         $aux_radical_serie5              ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  659)                         $aux_radical_serie6              ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  660)                         '$aux_numero_serie_obrigatorio'  ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  661)                         '$aux_produto_principal'         ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  662)                         '$aux_locador'                   ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  663)                         $aux_referencia_fabrica          ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  664)                         $aux_code_convention             ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  665)                         '$aux_abre_os'                   ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  666)                         '$aux_aviso_email'               ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  667)                         $login_admin                     ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  668)                         current_timestamp                ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  669)                         '$aux_troca_obrigatoria'         ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  670)                         '$aux_produto_critico'           ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  671)                         '$aux_intervencao_tecnica'       ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  672)                         $aux_origem                      ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  673)                         $retorno_produto                 ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  674)                         $aux_lista_troca                 ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  675)                         $aux_qtd_etiqueta_os             ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  676)                         $aux_valor_troca                 ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  677)                         '$aux_troca_garantia'            ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  678)                         '$aux_troca_faturada'            ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  679)                         $aux_marca                       ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  680)                         $aux_produto_fornecedor          ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  681)                         $aux_capacidade                  ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  682)                         $aux_divisao                     ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  683)                         '$link_img'                      ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  684)                         '$observacao'                    ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  685)                         $sistema_operacional             ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  686)                         '$serie_inicial'                 ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  687)                         '$serie_final'                   ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  688)                         '$validar_serie'
63157ab1 (guilhermecurcio    2012-07-17 11:20:34 -0300  689)                         $sql_entrega_tecnica_v
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  690)                     );";
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300  691) 
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300  692) 
a53578b1 (aoki               2011-11-22 14:46:57 -0300  693) 			//echo nl2br ($sql);
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300  694) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  695)             $res = pg_query ($con,$sql);
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300  696) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  697) 			#HD 335150 INICIO
606757d2 (root               2011-07-19 09:50:40 -0300  698) 			if (in_array($login_fabrica,$fabricaIntervaloSerie)){
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  699) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  700) 				$sql = "select currval('seq_produto') AS produto;";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  701) 				$res = pg_query($con,$sql);
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300  702) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  703) 				$produto_aux = trim(pg_fetch_result($res,0,produto));
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  704) 				$totalSerie = count($_POST['produto_serie_in_out']);
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  705) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  706) 				for($i=0;$i<$totalSerie;$i++){
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  707) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  708) 					$serie_in = $_POST['serie_in'][$i];
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  709) 					$serie_out = $_POST['serie_out'][$i];
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  710) 					$produto_serie_in_out = $_POST['produto_serie_in_out'][$i];
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  711) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  712) 					if(strlen($produto_serie_in_out) == 0){
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300  713) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  714) 						$sql_serie_in_out = "
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  715) 							INSERT INTO tbl_produto_serie
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  716) 							(
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  717) 								fabrica      ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  718) 								produto      ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  719) 								serie_inicial,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  720) 								serie_final
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  721) 							) VALUES (
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  722) 								$login_fabrica,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  723) 								$produto_aux  ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  724) 								'$serie_in'     ,
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300  725) 								'$serie_out'
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  726) 							);
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  727) 						";
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300  728) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  729) 						$res_serie = pg_query ($con, $sql_serie_in_out);
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  730) 					}
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300  731) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  732) 				}
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300  733) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  734) 			}
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300  735) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  736)             /* ----------------------- INICIO - IGOR HD 2846 -------------------------*/
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  737) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  738) 			// Atribuir o país como sendo o Brasil quando for 515 | Andre Ribeiro, 514 | Mara, 516 | Daniel
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  739)              if($login_fabrica == 20 and ($login_admin == 514 or $login_admin == 515 or $login_admin == 516 or $login_admin == 1550 or $login_admin== 3128)) {
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  740) 				$sql = "select currval('seq_produto') as produto;";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  741) //                    $res = pg_query ($con,$sql);
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  742) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  743) 				$produto = trim(pg_fetch_result($res,0,produto));
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  744) 				//$sql = "SELECT produto,pais FROM tbl_produto_pais WHERE produto=$produto AND pais = '$pais'";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  745) 				//$res = @pg_query ($con,$sql);
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  746) 				if(strlen($produto)>0){
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  747) 					$sql = "INSERT INTO tbl_produto_pais (produto,pais) VALUES ($produto,'BR')";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  748) //                        $res = pg_query ($con,$sql);
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  749) 				}
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  750) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  751)             }
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  752)             /* ----------------------- FIM - IGOR HD 2846 -------------------------*/
d41057f0 (Ronald Santos      2012-05-30 15:30:14 -0300  753) 			
d41057f0 (Ronald Santos      2012-05-30 15:30:14 -0300  754) 			if($login_fabrica == 42){
d41057f0 (Ronald Santos      2012-05-30 15:30:14 -0300  755) 				$sql = "select currval('seq_produto') as produto;";
d41057f0 (Ronald Santos      2012-05-30 15:30:14 -0300  756) 				$res = pg_query ($con,$sql);
d41057f0 (Ronald Santos      2012-05-30 15:30:14 -0300  757) 				$produto = trim(pg_fetch_result($res,0,produto));
d41057f0 (Ronald Santos      2012-05-30 15:30:14 -0300  758) 				
d41057f0 (Ronald Santos      2012-05-30 15:30:14 -0300  759) 				if(!empty($aux_classe)){
d41057f0 (Ronald Santos      2012-05-30 15:30:14 -0300  760) 					$sql = "INSERT INTO tbl_classe_produto(classe,produto) VALUES ($aux_classe,$produto)";
d41057f0 (Ronald Santos      2012-05-30 15:30:14 -0300  761) 					$res = pg_query ($con,$sql);
d41057f0 (Ronald Santos      2012-05-30 15:30:14 -0300  762) 				}
d41057f0 (Ronald Santos      2012-05-30 15:30:14 -0300  763) 			}
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  764) 
d41057f0 (Ronald Santos      2012-05-30 15:30:14 -0300  765) 			$msg_erro = pg_errormessage($con);
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  766) 		}else{
63157ab1 (guilhermecurcio    2012-07-17 11:20:34 -0300  767)             if ($login_fabrica == 42) {
63157ab1 (guilhermecurcio    2012-07-17 11:20:34 -0300  768)                 $sql_entrega_tecnica = ", entrega_tecnica = '$entrega_tecnica'";
63157ab1 (guilhermecurcio    2012-07-17 11:20:34 -0300  769)             }
63157ab1 (guilhermecurcio    2012-07-17 11:20:34 -0300  770) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  771)             ###ALTERA REGISTRO
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  772)             $sql = "UPDATE tbl_produto SET
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  773)                             linha                    = $aux_linha                             ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  774)                             familia                  = $aux_familia                           ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  775)                             descricao                = $aux_descricao                         ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  776)                             voltagem                 = $aux_voltagem                          ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  777)                             referencia               = $aux_referencia                        ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  778)                             garantia                 = $aux_garantia                          ,
a53578b1 (aoki               2011-11-22 14:46:57 -0300  779) 							garantia_horas           = $aux_garantia_horas                    ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  780)                             preco                    = fnc_limpa_moeda($aux_preco)            ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  781)                             mao_de_obra              = fnc_limpa_moeda($aux_mao_de_obra)      ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  782)                             mao_de_obra_admin        = fnc_limpa_moeda($aux_mao_de_obra_admin),
2fc18fb3 (Brayan Laurindo    2011-10-10 09:21:43 -0300  783) 							mao_de_obra_ajuste       = fnc_limpa_moeda($aux_mao_de_obra_admin),
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  784)                             mao_de_obra_troca        = fnc_limpa_moeda($aux_mao_de_obra_troca),
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  785)                             valor_troca_gas          = fnc_limpa_moeda($aux_valor_troca_gas)  ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  786)                             ativo                    = $aux_ativo                             ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  787)                             uso_interno_ativo        = $aux_uso_interno_ativo                 ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  788)                             /*off_line                 = $aux_off_line                        ,*/
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  789)                             nome_comercial           = '$nome_comercial'                      ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  790)                             classificacao_fiscal     = '$classificacao_fiscal'                ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  791)                             ipi                      = $aux_ipi                               ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  792)                             radical_serie            = $aux_radical_serie                     ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  793)                             radical_serie2           = $aux_radical_serie2                    ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  794)                             radical_serie3           = $aux_radical_serie3                    ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  795)                             radical_serie4           = $aux_radical_serie4                    ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  796)                             radical_serie5           = $aux_radical_serie5                    ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  797)                             radical_serie6           = $aux_radical_serie6                    ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  798)                             numero_serie_obrigatorio = '$aux_numero_serie_obrigatorio'        ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  799)                             produto_principal        = '$aux_produto_principal'               ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  800)                             locador                  = '$aux_locador'                         ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  801)                             referencia_fabrica       = $aux_referencia_fabrica                ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  802)                             code_convention          = $aux_code_convention                   ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  803)                             abre_os                  = '$aux_abre_os'                         ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  804)                             aviso_email              = '$aux_aviso_email'                     ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  805)                             admin                    = $login_admin                           ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  806)                             data_atualizacao         = current_timestamp                      ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  807)                             troca_obrigatoria        = '$aux_troca_obrigatoria'               ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  808)                             produto_critico          = '$aux_produto_critico'                 ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  809)                             intervencao_tecnica      = '$aux_intervencao_tecnica'             ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  810)                             origem                   = $aux_origem                            ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  811)                             retorno_produto          = $retorno_produto                       ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  812)                             lista_troca              = $aux_lista_troca                       ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  813)                             qtd_etiqueta_os          = $aux_qtd_etiqueta_os                   ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  814)                             valor_troca              = $aux_valor_troca                       ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  815)                             troca_garantia           = '$aux_troca_garantia'                  ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  816)                             troca_faturada           = '$aux_troca_faturada'                  ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  817)                             marca                    = $aux_marca                             ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  818)                             produto_fornecedor       = $aux_produto_fornecedor                ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  819)                             capacidade               = $aux_capacidade                        ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  820)                             divisao                  = $aux_divisao                           ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  821)                             imagem                   = '$link_img'                            ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  822)                             observacao               = '$observacao'                          ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  823)                             sistema_operacional      = $sistema_operacional                   ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  824)                             serie_inicial            = '$serie_inicial'                       ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  825)                             serie_final              = '$serie_final'                         ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  826)                             validar_serie            = '$validar_serie'
63157ab1 (guilhermecurcio    2012-07-17 11:20:34 -0300  827)                             $sql_entrega_tecnica
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  828)                     FROM tbl_linha
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  829)                     WHERE  tbl_produto.linha         = tbl_linha.linha
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  830)                     AND    tbl_linha.fabrica         = $login_fabrica
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  831)                     AND    tbl_produto.produto       = $produto;";
a53578b1 (aoki               2011-11-22 14:46:57 -0300  832) 			//echo nl2br ($sql);
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  833)             $res = @pg_query ($con,$sql);
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300  834) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  835) 			#HD 335150 INICIO
606757d2 (root               2011-07-19 09:50:40 -0300  836) 			if(in_array($login_fabrica,$fabricaIntervaloSerie)){
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300  837) 
a830ce09 (Gabriel Silveira   2012-06-29 10:37:05 -0300  838) 				$linhas = $_POST['qtde_itens'];
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  839) 
cb10c977 (Gabriel Silveira   2012-06-28 15:16:21 -0300  840) 				for($i=0;$i < $linhas; $i++){
cb10c977 (Gabriel Silveira   2012-06-28 15:16:21 -0300  841)                     
a830ce09 (Gabriel Silveira   2012-06-29 10:37:05 -0300  842) 					$serie_in = trim($_POST['serie_in_'.$i]);
a830ce09 (Gabriel Silveira   2012-06-29 10:37:05 -0300  843) 					$serie_out = trim($_POST['serie_out_'.$i]);
a830ce09 (Gabriel Silveira   2012-06-29 10:37:05 -0300  844) 					$produto_serie_in_out = $_POST['produto_serie_in_out_'.$i];
a830ce09 (Gabriel Silveira   2012-06-29 10:37:05 -0300  845) 					$excluir = $_POST['apagar_serie_'.$i];
a830ce09 (Gabriel Silveira   2012-06-29 10:37:05 -0300  846)                     echo "ProdSérieInOut: $produto_serie_in_out --- SerieIn: $serie_in --- SerieOut: $serie_out --- Ecluir: $excluir <br> ";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  847) 					if ($excluir == 'excluir'){
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300  848) 						$sql_delete = " DELETE FROM tbl_produto_serie
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  849) 										WHERE tbl_produto_serie.produto_serie = $produto_serie_in_out
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  850) 										and tbl_produto_serie.produto = $produto
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  851) 						";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  852) 						$res = pg_query($con,$sql_delete);
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  853) 					}
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300  854) 
a830ce09 (Gabriel Silveira   2012-06-29 10:37:05 -0300  855)                     if($login_fabrica == 15 and empty($excluir) and !empty($serie_in) and !empty($serie_out)){ //882760
cb10c977 (Gabriel Silveira   2012-06-28 15:16:21 -0300  856)                         
cb10c977 (Gabriel Silveira   2012-06-28 15:16:21 -0300  857)                         $serie_in_first  = substr($serie_in, 0,1);
cb10c977 (Gabriel Silveira   2012-06-28 15:16:21 -0300  858)                         $serie_out_first = substr($serie_out, 0,1); 
cb10c977 (Gabriel Silveira   2012-06-28 15:16:21 -0300  859)                         $ano_serie_in    = substr($serie_in, 3,1);
cb10c977 (Gabriel Silveira   2012-06-28 15:16:21 -0300  860)                         $ano_serie_out   = substr($serie_out, 3,1);
cb10c977 (Gabriel Silveira   2012-06-28 15:16:21 -0300  861)                         $serie_in_lote   = substr($serie_in, 4,5);
cb10c977 (Gabriel Silveira   2012-06-28 15:16:21 -0300  862)                         $serie_out_lote  = substr($serie_out, 4,5);
cb10c977 (Gabriel Silveira   2012-06-28 15:16:21 -0300  863)                         $ano_atual = date('Y');
cb10c977 (Gabriel Silveira   2012-06-28 15:16:21 -0300  864)                         $ano_letra_inicial = 'A';
cb10c977 (Gabriel Silveira   2012-06-28 15:16:21 -0300  865)                         $anos_verificar = array();
cb10c977 (Gabriel Silveira   2012-06-28 15:16:21 -0300  866) 
cb10c977 (Gabriel Silveira   2012-06-28 15:16:21 -0300  867)                         // Série In Lote
a830ce09 (Gabriel Silveira   2012-06-29 10:37:05 -0300  868)                         if ( (in_array($serie_in_first, array(1,4)) and strlen($serie_in_lote) < 4) or substr($serie_in_lote, 0,1) == 0 ){
cb10c977 (Gabriel Silveira   2012-06-28 15:16:21 -0300  869)                             
cb10c977 (Gabriel Silveira   2012-06-28 15:16:21 -0300  870)                             $msg_erro = "Número de Série $serie_in Inválido <br> ";
cb10c977 (Gabriel Silveira   2012-06-28 15:16:21 -0300  871) 
a830ce09 (Gabriel Silveira   2012-06-29 10:37:05 -0300  872)                         }elseif( (in_array($serie_in_first, array(9)) and strlen($serie_in_lote) < 3 ) or substr($serie_in_lote, 0,1) == 0 ){
cb10c977 (Gabriel Silveira   2012-06-28 15:16:21 -0300  873)                             
cb10c977 (Gabriel Silveira   2012-06-28 15:16:21 -0300  874)                             $msg_erro = "Número de Série $serie_in Inválido <br>";
cb10c977 (Gabriel Silveira   2012-06-28 15:16:21 -0300  875) 
cb10c977 (Gabriel Silveira   2012-06-28 15:16:21 -0300  876)                         }
cb10c977 (Gabriel Silveira   2012-06-28 15:16:21 -0300  877) 
cb10c977 (Gabriel Silveira   2012-06-28 15:16:21 -0300  878)                         //Série Out Lote
a830ce09 (Gabriel Silveira   2012-06-29 10:37:05 -0300  879)                         if ( (in_array($serie_out_first, array(1,4)) and strlen($serie_out_lote) < 4 ) or substr($serie_out_lote, 0,1) ==  0 ){
cb10c977 (Gabriel Silveira   2012-06-28 15:16:21 -0300  880)                            
cb10c977 (Gabriel Silveira   2012-06-28 15:16:21 -0300  881)                             $msg_erro = "Número de Série $serie_out Inválido <br>";
cb10c977 (Gabriel Silveira   2012-06-28 15:16:21 -0300  882) 
a830ce09 (Gabriel Silveira   2012-06-29 10:37:05 -0300  883)                         }elseif( (in_array($serie_out_first, array(9)) and strlen($serie_out_lote) < 3) or substr($serie_out_lote, 0,1) == 0 ){
cb10c977 (Gabriel Silveira   2012-06-28 15:16:21 -0300  884)                             
cb10c977 (Gabriel Silveira   2012-06-28 15:16:21 -0300  885)                             $msg_erro = "Número de Série $serie_out Inválido <br>";
cb10c977 (Gabriel Silveira   2012-06-28 15:16:21 -0300  886) 
cb10c977 (Gabriel Silveira   2012-06-28 15:16:21 -0300  887)                         }
cb10c977 (Gabriel Silveira   2012-06-28 15:16:21 -0300  888)                        
cb10c977 (Gabriel Silveira   2012-06-28 15:16:21 -0300  889)                         //Anos
a830ce09 (Gabriel Silveira   2012-06-29 10:37:05 -0300  890)                         $qtde_de_anos_for = $ano_atual - 1994;
cb10c977 (Gabriel Silveira   2012-06-28 15:16:21 -0300  891)                         for ($x=1; $x <= $qtde_de_anos_for; $x++) { 
cb10c977 (Gabriel Silveira   2012-06-28 15:16:21 -0300  892)                             $anos_verificar[$x] = $ano_letra_inicial++;
cb10c977 (Gabriel Silveira   2012-06-28 15:16:21 -0300  893)                         }
cb10c977 (Gabriel Silveira   2012-06-28 15:16:21 -0300  894)                         if (!in_array($ano_serie_in, $anos_verificar)){
cb10c977 (Gabriel Silveira   2012-06-28 15:16:21 -0300  895)                             $msg_erro = "Número de Série $serie_in Inválido <br>";
cb10c977 (Gabriel Silveira   2012-06-28 15:16:21 -0300  896)                         } 
cb10c977 (Gabriel Silveira   2012-06-28 15:16:21 -0300  897) 
cb10c977 (Gabriel Silveira   2012-06-28 15:16:21 -0300  898)                         if( !in_array($ano_serie_out, $anos_verificar) ){
cb10c977 (Gabriel Silveira   2012-06-28 15:16:21 -0300  899)                           
cb10c977 (Gabriel Silveira   2012-06-28 15:16:21 -0300  900)                             $msg_erro = "Número de Série $serie_out Inválido <br>";    
cb10c977 (Gabriel Silveira   2012-06-28 15:16:21 -0300  901) 
cb10c977 (Gabriel Silveira   2012-06-28 15:16:21 -0300  902)                         }
cb10c977 (Gabriel Silveira   2012-06-28 15:16:21 -0300  903) 
cb10c977 (Gabriel Silveira   2012-06-28 15:16:21 -0300  904)                     }
cb10c977 (Gabriel Silveira   2012-06-28 15:16:21 -0300  905) 
cb10c977 (Gabriel Silveira   2012-06-28 15:16:21 -0300  906) 					if (strlen($produto_serie_in_out) > 0 && strlen($excluir) == 0 && empty($msg_erro)){
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300  907) 						$sql_serie_in_out = "
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300  908) 							UPDATE tbl_produto_serie SET
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  909) 								fabrica       = $login_fabrica  ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  910) 								produto       = $produto        ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  911) 								serie_inicial = '$serie_in'     ,
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300  912) 								serie_final   = '$serie_out'
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  913) 							WHERE	tbl_produto_serie.produto = $produto
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  914) 							AND		tbl_produto_serie.produto_serie = $produto_serie_in_out";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  915) 						$res_serie = pg_query ($con, $sql_serie_in_out);
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  916) 					}
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300  917) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  918) 					if(strlen($produto_serie_in_out) == 0 && strlen($msg_erro)==0 && strlen($serie_in) > 0){
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300  919) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  920) 						$sql_serie_in_out = "
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  921) 							INSERT INTO tbl_produto_serie
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  922) 							(
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  923) 								fabrica      ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  924) 								produto      ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  925) 								serie_inicial,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  926) 								serie_final
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  927) 							) VALUES (
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  928) 								$login_fabrica,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  929) 								$produto ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  930) 								'$serie_in'     ,
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300  931) 								'$serie_out'
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  932) 							);
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  933) 						";
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300  934) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  935) 						$res_serie = pg_query ($con, $sql_serie_in_out);
cb10c977 (Gabriel Silveira   2012-06-28 15:16:21 -0300  936) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  937) 					}
cb10c977 (Gabriel Silveira   2012-06-28 15:16:21 -0300  938) 
cb10c977 (Gabriel Silveira   2012-06-28 15:16:21 -0300  939)                 }
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300  940) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  941) 			}
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  942) 
d41057f0 (Ronald Santos      2012-05-30 15:30:14 -0300  943) 			if($login_fabrica == 42){
d41057f0 (Ronald Santos      2012-05-30 15:30:14 -0300  944) 				$sql = "SELECT produto FROM tbl_classe_produto WHERE produto = $produto";
d41057f0 (Ronald Santos      2012-05-30 15:30:14 -0300  945) 				$res = pg_query ($con,$sql);
d41057f0 (Ronald Santos      2012-05-30 15:30:14 -0300  946) 				if(pg_numrows($res) > 0){
d41057f0 (Ronald Santos      2012-05-30 15:30:14 -0300  947) 					if(empty($aux_classe)){
d41057f0 (Ronald Santos      2012-05-30 15:30:14 -0300  948) 						$sql = "DELETE FROM tbl_classe_produto WHERE produto = $produto";
d41057f0 (Ronald Santos      2012-05-30 15:30:14 -0300  949) 						$res = pg_query ($con,$sql);
d41057f0 (Ronald Santos      2012-05-30 15:30:14 -0300  950) 					} else {
d41057f0 (Ronald Santos      2012-05-30 15:30:14 -0300  951) 						$sql = "UPDATE tbl_classe_produto SET classe = $aux_classe WHERE produto = $produto";
d41057f0 (Ronald Santos      2012-05-30 15:30:14 -0300  952) 						$res = pg_query ($con,$sql);
d41057f0 (Ronald Santos      2012-05-30 15:30:14 -0300  953) 					}
d41057f0 (Ronald Santos      2012-05-30 15:30:14 -0300  954) 				}else if(!empty($aux_classe)){
d41057f0 (Ronald Santos      2012-05-30 15:30:14 -0300  955) 					$sql = "INSERT INTO tbl_classe_produto(classe,produto) VALUES ($aux_classe,$produto)";
d41057f0 (Ronald Santos      2012-05-30 15:30:14 -0300  956) 					$res = pg_query ($con,$sql);
d41057f0 (Ronald Santos      2012-05-30 15:30:14 -0300  957) 				}
d41057f0 (Ronald Santos      2012-05-30 15:30:14 -0300  958) 			}
d41057f0 (Ronald Santos      2012-05-30 15:30:14 -0300  959) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  960)         }
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  961) 
cb10c977 (Gabriel Silveira   2012-06-28 15:16:21 -0300  962)         $msg_erro .= pg_errormessage($con);
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  963) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  964)         //--=== TRADUÇÂO DOS PRODUTOS =========================================
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  965)         $idioma           = $_POST["idioma"];
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  966)         $idioma_novo      = $_POST["idioma_novo"];
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  967)         $descricao_idioma = $_POST["descricao_idioma"];
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  968) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  969)         if (strlen($idioma) == 2 AND strlen($descricao_idioma) > 0 AND strlen($produto) > 0) {
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  970) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  971)             if (strlen($idioma_novo) == 2) {
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  972) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  973)                 $sql = "INSERT INTO tbl_produto_idioma (produto,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  974)                                                         descricao,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  975)                                                         idioma
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  976)                                               ) VALUES ($produto,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  977)                                                         '$descricao_idioma',
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  978)                                                         '$idioma')";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  979) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  980)             } else {
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  981) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  982)                 $sql = "UPDATE tbl_produto_idioma SET descricao = '$descricao_idioma'
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300  983)                          WHERE produto = $produto
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  984)                            AND idioma  = '$idioma'";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  985) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  986)             }
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  987) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  988)             $res      = @pg_query ($con,$sql);
cb10c977 (Gabriel Silveira   2012-06-28 15:16:21 -0300  989)             $msg_erro .= pg_errormessage($con);
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  990) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  991)         }
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  992) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  993)         $qtde_item = $_POST['qtde_item'];
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  994) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  995)         for ($i = 0; $i < $qtde_item; $i++) {
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  996) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  997)             $referencia_opcao    = $_POST["referencia_opcao_".$i];
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  998)             $descricao_opcao     = $_POST["descricao_opcao_".$i];
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300  999)             $produto_opcao       = $_POST["produto_opcao_".$i];
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1000)             $produto_troca_opcao = $_POST["produto_troca_opcao_".$i];
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1001)             $voltagem_opcao      = $_POST["voltagem_opcao_".$i];
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1002)             $kit_opcao           = $_POST["kit_opcao_".$i];
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1003) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1004)             if (strlen($voltagem_opcao) == 0 and strlen($referencia_opcao) > 0) {
cb10c977 (Gabriel Silveira   2012-06-28 15:16:21 -0300 1005)                 $msg_erro .= "Informe a voltagem para o produto de opção troca $referencia_opcao. Clique na lupa para pesquisar.";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1006)                 $erro_linha = "erro_linha" . $i;
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1007)                 $$erro_linha = 1 ;
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1008)                 break;
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1009)             }
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1010) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1011)             if (strlen($msg_erro) == 0 and strlen($referencia_opcao)) {
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1012) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1013)                 $sql = "SELECT produto
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1014)                           FROM tbl_produto
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1015)                           JOIN tbl_linha using(linha)
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1016)                          WHERE referencia = '$referencia_opcao'
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1017)                            AND voltagem   = '$voltagem_opcao'
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1018)                            AND fabrica    = $login_fabrica
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1019)                          LIMIT 1";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1020) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1021)                 $res = pg_query($con, $sql);
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1022) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1023)                 if (pg_num_rows($res) == 0) {
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1024)                     $msg_erro = "Produto com referência $referencia_opcao e voltagem $voltagem_opcao não encontrado.";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1025)                 } else {
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1026)                     $produto_opcao = pg_fetch_result($res,0,0);
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1027)                 }
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1028) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1029)             }
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1030) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1031)             if (strlen($msg_erro) == 0) {
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1032) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1033)                 if (strlen($produto_troca_opcao) > 0) {
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1034) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1035)                     if (strlen($referencia_opcao) == 0) {
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1036) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1037)                         $sql = "DELETE FROM tbl_produto_troca_opcao
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1038)                                 WHERE produto_troca_opcao = $produto_troca_opcao";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1039) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1040)                         $res = pg_query($con, $sql);
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1041) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1042)                         if (strlen( pg_errormessage($con) ) > 0) {
cb10c977 (Gabriel Silveira   2012-06-28 15:16:21 -0300 1043)                             $msg_erro .= pg_errormessage($con) ;
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1044)                         }
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1045) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1046)                     } else {
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1047) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1048)                         $sql = "UPDATE tbl_produto_troca_opcao SET
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1049)                                     produto_opcao = $produto_opcao,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1050)                                     kit = $kit_opcao
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1051)                                 WHERE produto_troca_opcao = $produto_troca_opcao";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1052) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1053)                         $res = pg_query($con, $sql);
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1054) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1055)                         if (strlen(pg_errormessage($con) ) > 0) {
cb10c977 (Gabriel Silveira   2012-06-28 15:16:21 -0300 1056)                             $msg_erro .= pg_errormessage($con);
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1057)                         }
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1058) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1059)                     }
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1060) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1061)                 } else {
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1062) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1063)                     if (strlen($referencia_opcao)>0) {
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1064)                         $sql = "INSERT INTO tbl_produto_troca_opcao (produto, produto_opcao, kit)
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1065)                                 VALUES ($produto, $produto_opcao, $kit_opcao)";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1066)                         $res = pg_query($con, $sql);
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1067)                         if (strlen( pg_errormessage($con) ) > 0) {
cb10c977 (Gabriel Silveira   2012-06-28 15:16:21 -0300 1068)                             $msg_erro .= pg_errormessage($con) ;
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1069)                         }
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1070)                     }
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1071) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1072)                 }
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1073) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1074)             }
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1075) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1076)         }
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1077) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1078) 		if ($login_fabrica == 3) {//HD 325481
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1079) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1080) 			for ($i = 0; $i < $total_mascara; $i++) {
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1081) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1082) 				if (isset($_POST['mascara_'.$i])) {
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1083) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1084) 					$mascara = trim($_POST['mascara_'.$i]);
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1085) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1086) 					if (!empty($mascara)) {
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1087) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1088) 						$sql = "SELECT * FROM tbl_produto_valida_serie WHERE fabrica = $login_fabrica AND produto = $produto AND mascara = '$mascara';";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1089) 						$res = pg_exec($con,$sql);
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1090) 						$tot = pg_num_rows($res);
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1091) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1092) 						if ($tot == 0) {
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1093) 							$sql = "INSERT INTO tbl_produto_valida_serie (fabrica, produto, mascara) values ($login_fabrica, $produto, '$mascara')";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1094) 							$res = pg_exec($con,$sql);
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1095) 						}
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1096) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1097) 					}
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1098) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1099) 				}
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1100) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1101) 			}
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1102) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1103) 		}//HD 325481
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1104)         if (strlen($msg_erro) == 0) {
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1105)             $res = pg_query ($con,"COMMIT TRANSACTION");
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1106)             header ('Location: '.$PHP_SELF.'?produto='.$produto.'&msg=Gravado com Sucesso!');
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1107)             exit;
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1108)         } else {
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1109) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1110)             ###ABORTA OPERAÇÃO DE INCLUSÃO/EXLUSÃO/ALTERAÇÃO E RECARREGA CAMPOS
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1111)             $produto                    = $_POST["produto"];
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1112)             $marca                      = $_POST["marca"];
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1113)             $linha                      = $_POST["linha"];
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1114)             $familia                    = $_POST["familia"];
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1115)             $descricao                  = $_POST["descricao"];
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1116)             $referencia                 = $_POST["referencia"];
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1117)             $voltagem                   = $_POST["voltagem"];
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1118)             $garantia                   = $_POST["garantia"];
a53578b1 (aoki               2011-11-22 14:46:57 -0300 1119) 			$garantia_horas             = $_POST["garantia_horas"];
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1120)             $preco                      = $_POST["preco"];
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1121)             $mao_de_obra                = $_POST["mao_de_obra"];
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1122)             $mao_de_obra_admin          = $_POST["mao_de_obra_admin"];
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1123)             $mao_de_obra_troca          = $_POST["mao_de_obra_troca"];
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1124)             $valor_troca_gas            = $_POST["valor_troca_gas"];
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1125)             $ativo                      = $_POST["ativo"];
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1126)             $uso_interno_ativo          = $_POST["uso_interno_ativo"];
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1127)             $nome_comercial             = $_POST["nome_comercial"];
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1128)             $classificacao_fiscal       = $_POST["classificacao_fiscal"];
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1129)             $ipi                        = $_POST["ipi"];
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1130)             $radical_serie              = $_POST["radical_serie"];
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1131)             $radical_serie2             = $_POST["radical_serie2"];
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1132)             $radical_serie3             = $_POST["radical_serie3"];
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1133)             $radical_serie4             = $_POST["radical_serie4"];
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1134)             $radical_serie5             = $_POST["radical_serie5"];
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1135)             $radical_serie6             = $_POST["radical_serie6"];
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1136)             $numero_serie_obrigatorio   = $_POST["numero_serie_obrigatorio"];
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1137)             $troca_obrigatoria          = $_POST["troca_obrigatoria"];
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1138)             $produto_critico            = $_POST["produto_critico"];
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1139)             $intervencao_tecnica        = $_POST["intervencao_tecnica"];
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1140)             $produto_principal          = $_POST["produto_principal"];
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1141)             $locador                    = $_POST["locador"];
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1142)             $referencia_fabrica         = trim($_POST["referencia_fabrica"]);
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1143)             $code_convention            = $_POST["code_convention"];
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1144)             $abre_os                    = $_POST["abre_os"];
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1145)             $origem                     = $_POST["origem"];
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1146)             $produto_fornecedor         = $_POST["produto_fornecedor"];
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1147)             $aviso_email                = $_POST["aviso_email"];
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1148)             $qtd_etiqueta_os            = $_POST["qtd_etiqueta_os"];
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1149)             $lista_troca                = $_POST["lista_troca"];
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300 1150)             $valor_troca                = $_POST["valor_troca"];
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300 1151)             $troca_garantia             = $_POST["troca_garantia"];
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300 1152)             $troca_faturada             = $_POST["troca_faturada"];
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1153)             $sistema_operacional        = $_POST['sistema_operacional'];
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1154)             $serie_inicial              = $_POST['serie_inicial'];
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1155)             $serie_final                = $_POST['serie_final'];
d41057f0 (Ronald Santos      2012-05-30 15:30:14 -0300 1156) 			$aux_classe                 = $_POST['classe_produto'];
63157ab1 (guilhermecurcio    2012-07-17 11:20:34 -0300 1157)             $entrega_tecnica            = $_POST["entrega_tecnica"];
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1158) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1159)             if (strpos ($msg_erro,"duplicate key violates unique constraint \"tbl_produto_referencia_pesquisa\"") > 0)
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1160)             $msg_erro = "Referência para esta linha de produtos já existe e não pode ser duplicada.";
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300 1161) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1162)             if (strpos ($msg_erro,"duplicate key violates unique constraint \"tbl_produto_unico\"") > 0)
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1163)             $msg_erro = "Referência para esta linha de produtos já existe e não pode ser duplicada.";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1164) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1165)             $res = pg_query ($con,"ROLLBACK TRANSACTION");
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1166) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1167)         }
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1168) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1169)     }//fim if msg erro
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1170) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1171) }
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1172) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1173) ###CARREGA REGISTRO
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1174) $produto = $_GET['produto'];
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1175) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1176) if (strlen($produto) > 0) {
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1177) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1178)     $sql = "SELECT  tbl_produto.produto                            ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1179)                     tbl_produto.linha                              ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1180)                     tbl_produto.familia                            ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1181)                     tbl_produto.descricao                          ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1182)                     tbl_produto.voltagem                           ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1183)                     tbl_produto.referencia                         ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1184)                     tbl_produto.garantia                           ,
a53578b1 (aoki               2011-11-22 14:46:57 -0300 1185) 					tbl_produto.garantia_horas                     ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1186)                     tbl_produto.preco                              ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1187)                     tbl_produto.mao_de_obra                        ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1188)                     tbl_produto.mao_de_obra_admin                  ,
8a75d566 (Brayan             2011-07-26 15:26:59 -0300 1189) 					tbl_produto.mao_de_obra_ajuste                 ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1190)                     tbl_produto.mao_de_obra_troca                  ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1191)                     tbl_produto.valor_troca_gas                    ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1192)                     tbl_produto.ativo                              ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1193)                     tbl_produto.uso_interno_ativo                  ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1194)                     tbl_produto.nome_comercial                     ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1195)                     tbl_produto.classificacao_fiscal               ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1196)                     tbl_produto.ipi                                ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1197)                     tbl_produto.origem                             ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1198)                     tbl_produto.radical_serie                      ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1199)                     tbl_produto.radical_serie2                     ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1200)                     tbl_produto.radical_serie3                     ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1201)                     tbl_produto.radical_serie4                     ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1202)                     tbl_produto.radical_serie5                     ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1203)                     tbl_produto.radical_serie6                     ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1204)                     tbl_produto.numero_serie_obrigatorio           ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1205)                     tbl_produto.produto_principal                  ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1206)                     tbl_produto.locador                            ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1207)                     tbl_produto.referencia_fabrica                 ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1208)                     tbl_produto.code_convention                    ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1209)                     tbl_produto.abre_os                            ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1210)                     tbl_produto.aviso_email                        ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1211)                     tbl_produto.troca_obrigatoria                  ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1212)                     tbl_produto.produto_critico                    ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1213)                     tbl_produto.intervencao_tecnica                ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1214)                     tbl_produto.qtd_etiqueta_os                    ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1215)                     tbl_produto.lista_troca                        ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1216)                     tbl_admin.login                                ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1217)                     tbl_marca.marca                                ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1218)                     tbl_produto.valor_troca                        ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1219)                     tbl_produto.troca_garantia                     ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1220)                     tbl_produto.troca_faturada                     ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1221)                     tbl_produto.produto_fornecedor                 ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1222)                     to_char(tbl_produto.data_atualizacao, 'DD/MM/YYYY HH24:MI') AS data_atualizacao,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1223)                     tbl_produto.capacidade                         ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1224)                     tbl_produto.divisao                            ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1225)                     tbl_produto.observacao                         ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1226)                     tbl_produto.imagem                             ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1227)                     tbl_produto.sistema_operacional                ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1228)                     tbl_produto.serie_inicial                      ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1229)                     tbl_produto.serie_final                        ,
d41057f0 (Ronald Santos      2012-05-30 15:30:14 -0300 1230)                     tbl_produto.validar_serie                      ,
63157ab1 (guilhermecurcio    2012-07-17 11:20:34 -0300 1231) 					tbl_classe_produto.classe,
63157ab1 (guilhermecurcio    2012-07-17 11:20:34 -0300 1232)                     tbl_produto.entrega_tecnica
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300 1233) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1234)             FROM    tbl_produto
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1235)             JOIN    tbl_linha ON tbl_linha.linha = tbl_produto.linha
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300 1236) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1237)             LEFT JOIN tbl_admin ON tbl_admin.admin = tbl_produto.admin
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1238)             LEFT JOIN tbl_marca ON tbl_marca.marca = tbl_produto.marca
d41057f0 (Ronald Santos      2012-05-30 15:30:14 -0300 1239) 			LEFT JOIN tbl_classe_produto ON tbl_produto.produto = tbl_classe_produto.produto
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1240)             WHERE   tbl_linha.fabrica   = $login_fabrica
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1241)             AND     tbl_produto.produto = $produto;";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1242) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1243)     $res = pg_query ($con,$sql);
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300 1244) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1245)     if (pg_num_rows($res) > 0) {
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1246) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1247)         $produto                  = trim(pg_fetch_result($res,0,'produto'));
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1248)         $linha                    = trim(pg_fetch_result($res,0,'linha'));
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1249)         $familia                  = trim(pg_fetch_result($res,0,'familia'));
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1250)         $descricao                = trim(pg_fetch_result($res,0,'descricao'));
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1251)         $referencia               = trim(pg_fetch_result($res,0,'referencia'));
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1252)         $voltagem                 = trim(pg_fetch_result($res,0,'voltagem'));
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1253)         $garantia                 = trim(pg_fetch_result($res,0,'garantia'));
a53578b1 (aoki               2011-11-22 14:46:57 -0300 1254) 		$garantia_horas           = trim(pg_fetch_result($res,0,'garantia_horas'));
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1255)         $preco                    = trim(pg_fetch_result($res,0,'preco'));
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1256)         $mao_de_obra              = trim(pg_fetch_result($res,0,'mao_de_obra'));
8a75d566 (Brayan             2011-07-26 15:26:59 -0300 1257) 		if ($login_fabrica == 101) {
8a75d566 (Brayan             2011-07-26 15:26:59 -0300 1258) 			$mao_de_obra_admin        = trim(pg_fetch_result($res,0,'mao_de_obra_ajuste'));
8a75d566 (Brayan             2011-07-26 15:26:59 -0300 1259) 		}
8a75d566 (Brayan             2011-07-26 15:26:59 -0300 1260) 		else {
8a75d566 (Brayan             2011-07-26 15:26:59 -0300 1261) 			$mao_de_obra_admin        = trim(pg_fetch_result($res,0,'mao_de_obra_admin'));
8a75d566 (Brayan             2011-07-26 15:26:59 -0300 1262) 		}
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1263)         $mao_de_obra_troca        = trim(pg_fetch_result($res,0,'mao_de_obra_troca'));
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1264)         $valor_troca_gas          = trim(pg_fetch_result($res,0,'valor_troca_gas'));
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1265)         $ativo                    = trim(pg_fetch_result($res,0,'ativo'));
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1266)         $uso_interno_ativo        = trim(pg_fetch_result($res,0,'uso_interno_ativo'));
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1267)         $nome_comercial           = trim(pg_fetch_result($res,0,'nome_comercial'));
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1268)         $classificacao_fiscal     = trim(pg_fetch_result($res,0,'classificacao_fiscal'));
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1269)         $ipi                      = trim(pg_fetch_result($res,0,'ipi'));
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1270)         $radical_serie            = trim(pg_fetch_result($res,0,'radical_serie'));
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1271)         $radical_serie2           = trim(pg_fetch_result($res,0,'radical_serie2'));
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1272)         $radical_serie3           = trim(pg_fetch_result($res,0,'radical_serie3'));
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1273)         $radical_serie4           = trim(pg_fetch_result($res,0,'radical_serie4'));
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1274)         $radical_serie5           = trim(pg_fetch_result($res,0,'radical_serie5'));
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1275)         $radical_serie6           = trim(pg_fetch_result($res,0,'radical_serie6'));
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1276)         $numero_serie_obrigatorio = trim(pg_fetch_result($res,0,'numero_serie_obrigatorio'));
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1277)         $produto_principal        = trim(pg_fetch_result($res,0,'produto_principal'));
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1278)         $locador                  = trim(pg_fetch_result($res,0,'locador'));
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1279)         $referencia_fabrica       = trim(pg_fetch_result($res,0,'referencia_fabrica'));
2be9f2d7 (Ederson            2011-08-18 11:39:34 -0300 1280) 		if($login_fabrica == 96)
2be9f2d7 (Ederson            2011-08-18 11:39:34 -0300 1281) 			$modelo = $referencia_fabrica;
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1282)         $code_convention          = trim(pg_fetch_result($res,0,'code_convention'));
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1283)         $abre_os                  = trim(pg_fetch_result($res,0,'abre_os'));
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1284)         $aviso_email              = trim(pg_fetch_result($res,0,'aviso_email'));
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1285)         $origem                   = trim(pg_fetch_result($res,0,'origem'));
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1286)         $produto_fornecedor       = trim(pg_fetch_result($res,0,'produto_fornecedor'));
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1287)         $admin                    = trim(pg_fetch_result($res,0,'login'));
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1288)         $data_atualizacao         = trim(pg_fetch_result($res,0,'data_atualizacao'));
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1289)         $troca_obrigatoria        = trim(pg_fetch_result($res,0,'troca_obrigatoria'));
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1290)         $produto_critico          = trim(pg_fetch_result($res,0,'produto_critico'));
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1291)         $intervencao_tecnica      = trim(pg_fetch_result($res,0,'intervencao_tecnica'));
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1292)         $qtd_etiqueta_os          = trim(pg_fetch_result($res,0,'qtd_etiqueta_os'));
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1293)         $lista_troca              = trim(pg_fetch_result($res,0,'lista_troca'));
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1294)         $marca                    = trim(pg_fetch_result($res,0,'marca'));
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1295)         $valor_troca              = trim(pg_fetch_result($res,0,'valor_troca'));
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1296)         $troca_garantia           = trim(pg_fetch_result($res,0,'troca_garantia'));
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1297)         $troca_faturada           = trim(pg_fetch_result($res,0,'troca_faturada'));
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1298)         $capacidade               = trim(pg_fetch_result($res,0,'capacidade'));
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1299)         $divisao                  = trim(pg_fetch_result($res,0,'divisao'));
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1300)         $observacao               = trim(pg_fetch_result($res,0,'observacao'));
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1301)         $link_img                 = trim(pg_fetch_result($res,0,'imagem'));
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1302)         $sistema_operacional      = trim(pg_fetch_result($res,0,'sistema_operacional'));
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1303)         $serie_inicial            = trim(pg_fetch_result($res,0,'serie_inicial'));
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1304)         $serie_final              = trim(pg_fetch_result($res,0,'serie_final'));
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1305)         $validar_serie            = trim(pg_fetch_result($res,0,'validar_serie'));
d41057f0 (Ronald Santos      2012-05-30 15:30:14 -0300 1306) 		$aux_classe               = trim(pg_fetch_result($res,0,'classe'));
63157ab1 (guilhermecurcio    2012-07-17 11:20:34 -0300 1307)         if ($login_fabrica == 42) {
63157ab1 (guilhermecurcio    2012-07-17 11:20:34 -0300 1308)             $entrega_tecnica = pg_fetch_result($res, 0, "entrega_tecnica");
63157ab1 (guilhermecurcio    2012-07-17 11:20:34 -0300 1309)         }
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1310) 		// $serie_in                 = trim(pg_fetch_result($res,0,'serie_in'));
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1311) 		// $serie_out                = trim(pg_fetch_result($res,0,'serie_out'));
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1312)     }
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1313) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1314) }
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1315) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1316) $msg = $_GET['msg'];
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1317) $layout_menu = "cadastro";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1318) $title = "Cadastramento De Produtos";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1319) include 'cabecalho.php';
8a75d566 (Brayan             2011-07-26 15:26:59 -0300 1320) echo '<link rel="stylesheet" type="text/css" href="../css/ebano.css" media="screen">';
8a75d566 (Brayan             2011-07-26 15:26:59 -0300 1321) echo "<center>";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1322) ?>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1323) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1324) <link rel="stylesheet" type="text/css" href="js/thickbox.css" media="screen">
a830ce09 (Gabriel Silveira   2012-06-29 10:37:05 -0300 1325) <script src="http://code.jquery.com/jquery-latest.min.js"></script>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1326) <script type="text/javascript"    src="js/thickbox.js"></script>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1327) <script type="text/javascript"    src="js/jquery.alphanumeric.js"></script>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1328) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1329) <script language="JavaScript">
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1330) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1331) 	$( document ).ready( function(){
a830ce09 (Gabriel Silveira   2012-06-29 10:37:05 -0300 1332) 			$('input[name=garantia]').numeric();
a830ce09 (Gabriel Silveira   2012-06-29 10:37:05 -0300 1333) 			$('input[name=garantia_horas]').numeric();
a830ce09 (Gabriel Silveira   2012-06-29 10:37:05 -0300 1334) 			$('input[name=mao_de_obra_admin]').numeric({ allow : ',.' });
a830ce09 (Gabriel Silveira   2012-06-29 10:37:05 -0300 1335) 			$('input[name=mao_de_obra]').numeric({ allow : ',.' });
a830ce09 (Gabriel Silveira   2012-06-29 10:37:05 -0300 1336) 			$('input[name=qtd_etiqueta_os]').numeric();
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300 1337) 
a830ce09 (Gabriel Silveira   2012-06-29 10:37:05 -0300 1338) 			$('input[name=preco_pais]').numeric({ allow: ',.' });
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300 1339) 
40f412d8 (root               2011-06-21 17:15:14 -0300 1340) 			$('.versao').alpha();
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300 1341) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1342) 		} )
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1343) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1344)     function checarNumero(campo) {
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1345)         var num = campo.value.replace(",",".");
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1346)         campo.value = parseFloat(num).toFixed(2);
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1347)         if (campo.value=='NaN') {
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1348)             campo.value='';
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1349)         }
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1350)     }
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300 1351) 
606757d2 (root               2011-07-19 09:50:40 -0300 1352)     function somenteMaiusculaSemAcento(obj) {
606757d2 (root               2011-07-19 09:50:40 -0300 1353) 		com_acento = 'áàãâäéèêëíìîïóòõôöúùûüçÁÀÃÂÄÉÈÊËÍÌÎÏÓÒÕÖÔÚÙÛÜÇ';
606757d2 (root               2011-07-19 09:50:40 -0300 1354) 		sem_acento = 'aaaaaeeeeiiiiooooouuuucAAAAAEEEEIIIIOOOOOUUUUC';
606757d2 (root               2011-07-19 09:50:40 -0300 1355) 
606757d2 (root               2011-07-19 09:50:40 -0300 1356) 		resultado='';
606757d2 (root               2011-07-19 09:50:40 -0300 1357) 
606757d2 (root               2011-07-19 09:50:40 -0300 1358) 		for(i=0; i<obj.value.length; i++) {
606757d2 (root               2011-07-19 09:50:40 -0300 1359) 			if (com_acento.indexOf(obj.value.substr(i,1))>=0) {
606757d2 (root               2011-07-19 09:50:40 -0300 1360) 				resultado += sem_acento.substr(com_acento.indexOf(obj.value.substr(i,1)),1);
606757d2 (root               2011-07-19 09:50:40 -0300 1361) 			}
606757d2 (root               2011-07-19 09:50:40 -0300 1362) 			else {
606757d2 (root               2011-07-19 09:50:40 -0300 1363) 				resultado += obj.value.substr(i,1);
606757d2 (root               2011-07-19 09:50:40 -0300 1364) 			}
606757d2 (root               2011-07-19 09:50:40 -0300 1365) 		}
606757d2 (root               2011-07-19 09:50:40 -0300 1366) 
606757d2 (root               2011-07-19 09:50:40 -0300 1367) 		resultado = resultado.toUpperCase();
606757d2 (root               2011-07-19 09:50:40 -0300 1368) 
606757d2 (root               2011-07-19 09:50:40 -0300 1369) 		re = /[^\w|\s]/g;
606757d2 (root               2011-07-19 09:50:40 -0300 1370) 		obj.value = resultado.replace(re, "");
606757d2 (root               2011-07-19 09:50:40 -0300 1371) 	}
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1372) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1373)     function checarNumeroInteiro(campo){
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1374)         campo.value = parseInt(campo.value);
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1375)         if (campo.value=='NaN') {
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1376)             campo.value='';
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1377)         }
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1378)     }
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1379) 
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300 1380) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1381) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1382)     function fnc_pesquisa_produto (campo, tipo) {
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300 1383) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1384)         if (campo.value != "") {
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1385)             var url = "";
2be9f2d7 (Ederson            2011-08-18 11:39:34 -0300 1386) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1387)             url = "produto_pesquisa.php?retorno=<? echo $PHP_SELF ?>&forma=reload&campo=" + campo.value + "&tipo=" + tipo ;
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1388)             janela = window.open(url, "janela", "toolbar=no, location=no, status=yes, scrollbars=yes, directories=no, width=600, height=400, top=0, left=0");
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1389)             janela.retorno = "<? echo $PHP_SELF ?>";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1390)             janela.referencia= document.frm_produto.referencia;
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1391)             janela.descricao = document.frm_produto.descricao;
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1392)             janela.linha     = document.frm_produto.linha;
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1393)             janela.familia   = document.frm_produto.familia;
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1394)             janela.focus();
2be9f2d7 (Ederson            2011-08-18 11:39:34 -0300 1395)         }else
2be9f2d7 (Ederson            2011-08-18 11:39:34 -0300 1396) 		alert("Informe toda ou parte da informação para realizar a pesquisa!");
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1397)     }
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1398) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1399)     function qtdeLinhas(campo) {
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1400)         var linha = 0;
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1401)         if (campo.value > 0){
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1402)             $(".tabela_item tr").each( function (){
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1403)                 linha = parseInt( $(this).attr("rel") );
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1404)                 if (linha  +1 > campo.value) {
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1405)                     $(this).css('display','none');
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1406)                 }else{
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1407)                     $(this).css('display','');
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1408)                 }
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1409)             });
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1410)         }
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1411)     }
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1412) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1413)     function fnc_pesquisa_produto_opcao (campo, campo2, campo3, campo4, tipo) {
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1414)         if (tipo == "referencia" ) {
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1415)             var xcampo = campo;
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1416)         }
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1417) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1418)         if (tipo == "descricao" ) {
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1419)             var xcampo = campo2;
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1420)         }
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1421) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1422)         if (xcampo.value != "") {
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1423)             var url = "";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1424)             url = "produto_pesquisa_2.php?campo=" + xcampo.value + "&tipo=" + tipo + "&lbm=sim" ;
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1425)             janela = window.open(url, "janela", "toolbar=no, location=no, status=yes, scrollbars=yes, directories=no, width=500, height=400, top=18, left=0");
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1426)             janela.referencia    = campo;
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1427)             janela.descricao    = campo2;
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1428)             janela.produto        = campo3;
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1429)             janela.voltagem        = campo4;
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1430)             janela.focus();
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1431)         }
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1432) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1433) 		else
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1434) 			alert("Informe toda ou parte da informação para realizar a pesquisa!");
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1435)     }
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300 1436) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1437) 	function validaForm(){
606757d2 (root               2011-07-19 09:50:40 -0300 1438) 		<?php if (in_array($login_fabrica,$fabricaIntervaloSerie)):?>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1439) 			if(validaSerie()){
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300 1440) 				document.frm_produto.btnacao.value='gravar' ;
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1441) 				document.frm_produto.submit();
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1442) 			}
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1443) 		<?php else:?>
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300 1444) 			document.frm_produto.btnacao.value='gravar' ;
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1445) 			document.frm_produto.submit();
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1446) 		<?php endif;?>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1447) 	}
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300 1448) 
606757d2 (root               2011-07-19 09:50:40 -0300 1449) 	<?php if(in_array($login_fabrica,$fabricaIntervaloSerie)):?>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1450) 		var totals = 0;
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1451) 		function adiciona(){
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1452) 			totals++;
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1453) 			tbl = document.getElementById("table_serie_in_out");
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300 1454) 
a830ce09 (Gabriel Silveira   2012-06-29 10:37:05 -0300 1455)             var linha = parseInt($('#qtde_itens').val());
a830ce09 (Gabriel Silveira   2012-06-29 10:37:05 -0300 1456)             
a830ce09 (Gabriel Silveira   2012-06-29 10:37:05 -0300 1457) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1458) 			var novaLinha = tbl.insertRow(-1);
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300 1459) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1460) 			var novaCelula;
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1461) 			if(totals%2==0) cl = "#F7F5F0";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1462) 			else cl = "#F1F4FA";
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300 1463) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1464) 			novaCelula = novaLinha.insertCell(0);
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1465) 			novaCelula.align = "center";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1466) 			novaCelula.height= "25px";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1467) 			novaCelula.style.backgroundColor = cl
a830ce09 (Gabriel Silveira   2012-06-29 10:37:05 -0300 1468) 			novaCelula.innerHTML = "<input type='hidden' name='produto_serie_in_out_"+linha+"'><input class='frm serie' rel='"+linha+"' id='serie_in_"+linha+"' type='text' name='serie_in_"+linha+"' size='15' maxlength='10' onKeyUp='somenteMaiusculaSemAcento(this);'>";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1469) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1470) 			novaCelula = novaLinha.insertCell(1);
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1471) 			novaCelula.align = "center";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1472) 			novaCelula.height= "25px";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1473) 			novaCelula.style.backgroundColor = cl;
a830ce09 (Gabriel Silveira   2012-06-29 10:37:05 -0300 1474) 			novaCelula.innerHTML = "<input class='frm serie' rel='"+linha+"' id='serie_out_"+linha+"' type='text' name='serie_out_"+linha+"' size='15' maxlength='10' onKeyUp='somenteMaiusculaSemAcento(this);'>";
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300 1475) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1476) 			novaCelula = novaLinha.insertCell(2);
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1477) 			novaCelula.align = "center";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1478) 			novaCelula.height= "25px";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1479) 			novaCelula.style.backgroundColor = cl;
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1480) 			novaCelula.innerHTML = "&nbsp;";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1481) 
a830ce09 (Gabriel Silveira   2012-06-29 10:37:05 -0300 1482)             linha++;
a830ce09 (Gabriel Silveira   2012-06-29 10:37:05 -0300 1483)             $('#qtde_itens').val(linha);
a830ce09 (Gabriel Silveira   2012-06-29 10:37:05 -0300 1484) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1485) 		}
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300 1486) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1487) 		function indiceAlfabeto(letra){
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1488) 			var str = "AB";//CDEFGHIJKLMNOPQRSTUVWXYZ";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1489) 			var total = str.length;
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1490) 			for(var i=0; i<total; i++){
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1491) 				if(str.charAt(i) == letra){
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1492) 					return i;
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1493) 					break;
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1494) 				}
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1495) 			}
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1496) 		}
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300 1497) 
606757d2 (root               2011-07-19 09:50:40 -0300 1498) 		<?if ($login_fabrica == 15){?>
606757d2 (root               2011-07-19 09:50:40 -0300 1499) 			//Verifica se o numero de série corresponde
606757d2 (root               2011-07-19 09:50:40 -0300 1500) 			//A Expressão Regular para o número de Série da Latinatec corresponde aos dados
606757d2 (root               2011-07-19 09:50:40 -0300 1501) 			//1 => Fábricante: pode ser 1, 4 ou 9
606757d2 (root               2011-07-19 09:50:40 -0300 1502) 			//2 => Versão: letra
606757d2 (root               2011-07-19 09:50:40 -0300 1503) 			//3 => Mês: letra: A = JAN; B = FEV; C = MAR...
606757d2 (root               2011-07-19 09:50:40 -0300 1504) 			//4 => Ano: letra: A = 1995; B = 1995; ... Q = 2011
606757d2 (root               2011-07-19 09:50:40 -0300 1505) 			//5 ao 8 => Sequencial numérico, sempre maior que 1000
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300 1506) 
606757d2 (root               2011-07-19 09:50:40 -0300 1507) 			function validaSerie(){
606757d2 (root               2011-07-19 09:50:40 -0300 1508) 
606757d2 (root               2011-07-19 09:50:40 -0300 1509) 				//Retorno já verdadeiro, caso não tenha uma série correta, retorna falso
606757d2 (root               2011-07-19 09:50:40 -0300 1510) 				var retorno = true;
606757d2 (root               2011-07-19 09:50:40 -0300 1511) 				var sa_in = ""; //Serie anterior de entrada
606757d2 (root               2011-07-19 09:50:40 -0300 1512) 				var sa_out = ""; //Serie anterior de saída
606757d2 (root               2011-07-19 09:50:40 -0300 1513) 				var s_in = ""; //Serie de entrada
606757d2 (root               2011-07-19 09:50:40 -0300 1514) 				var s_out = ""; //Serie de saída
606757d2 (root               2011-07-19 09:50:40 -0300 1515) 				var ident; //id da linha
a830ce09 (Gabriel Silveira   2012-06-29 10:37:05 -0300 1516)                 var serie = new RegExp();
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300 1517) 
606757d2 (root               2011-07-19 09:50:40 -0300 1518) 				var serie_inicial = $("#serie_inicial").val();
606757d2 (root               2011-07-19 09:50:40 -0300 1519) 				var serie_final = $("#serie_final").val();
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300 1520) 
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300 1521) 
a830ce09 (Gabriel Silveira   2012-06-29 10:37:05 -0300 1522)                 //Percorre todas as séries pra ver se estão válidas
a830ce09 (Gabriel Silveira   2012-06-29 10:37:05 -0300 1523)                 $('.serie').each(function(){
a830ce09 (Gabriel Silveira   2012-06-29 10:37:05 -0300 1524) 
a830ce09 (Gabriel Silveira   2012-06-29 10:37:05 -0300 1525)                     ident = $(this).attr('rel');
a830ce09 (Gabriel Silveira   2012-06-29 10:37:05 -0300 1526)                     s_in = $('#serie_in_'+ident).val();
a830ce09 (Gabriel Silveira   2012-06-29 10:37:05 -0300 1527)                     s_out = $('#serie_out_'+ident).val();
a830ce09 (Gabriel Silveira   2012-06-29 10:37:05 -0300 1528) 
a830ce09 (Gabriel Silveira   2012-06-29 10:37:05 -0300 1529)                     if (s_in.substr(0,1) == 1 || s_in.substr(0,1) == 4){
a830ce09 (Gabriel Silveira   2012-06-29 10:37:05 -0300 1530)                         serie = new RegExp('[14]['+serie_inicial+'-'+serie_final+'][A-L][A-Z][1-9][0-9]{3,5}');
a830ce09 (Gabriel Silveira   2012-06-29 10:37:05 -0300 1531)                     }else if(s_in.substr(0,1) == 9){
a830ce09 (Gabriel Silveira   2012-06-29 10:37:05 -0300 1532)         				serie = new RegExp('[9]['+serie_inicial+'-'+serie_final+'][A-L][A-Z][1-9][0-9]{2,5}');
a830ce09 (Gabriel Silveira   2012-06-29 10:37:05 -0300 1533)                     }
a830ce09 (Gabriel Silveira   2012-06-29 10:37:05 -0300 1534) 
a830ce09 (Gabriel Silveira   2012-06-29 10:37:05 -0300 1535)                     if (s_out.substr(0,1) == 1 || s_out.substr(0,1) == 4){
a830ce09 (Gabriel Silveira   2012-06-29 10:37:05 -0300 1536)                         serie = new RegExp('[14]['+serie_inicial+'-'+serie_final+'][A-L][A-Z][1-9][0-9]{3,5}');
a830ce09 (Gabriel Silveira   2012-06-29 10:37:05 -0300 1537)                     }else if(s_out.substr(0,1) == 9){
a830ce09 (Gabriel Silveira   2012-06-29 10:37:05 -0300 1538)                         serie = new RegExp('[9]['+serie_inicial+'-'+serie_final+'][A-L][A-Z][1-9][0-9]{2,5}');
a830ce09 (Gabriel Silveira   2012-06-29 10:37:05 -0300 1539)                     }
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300 1540) 
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300 1541) 
a830ce09 (Gabriel Silveira   2012-06-29 10:37:05 -0300 1542)                     //Recebe em formato de RegEx o filtro de series
a830ce09 (Gabriel Silveira   2012-06-29 10:37:05 -0300 1543) 					if(s_in.length > 0 && s_out.length > 0 && !$('#apagar_serie_'+ident).is(':checked')){
606757d2 (root               2011-07-19 09:50:40 -0300 1544) 						if(s_out.length == 0){
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300 1545) 
606757d2 (root               2011-07-19 09:50:40 -0300 1546) 							if (!$('#serie_in_'+ident).val().match(serie)){
606757d2 (root               2011-07-19 09:50:40 -0300 1547) 								retorno = false;
606757d2 (root               2011-07-19 09:50:40 -0300 1548) 								return false;
606757d2 (root               2011-07-19 09:50:40 -0300 1549) 							}
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300 1550) 
606757d2 (root               2011-07-19 09:50:40 -0300 1551) 						}else if(s_in.substr(1,1) == s_out.substr(1,1)){
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300 1552) 
606757d2 (root               2011-07-19 09:50:40 -0300 1553) 							if (!$(this).val().match(serie)){
606757d2 (root               2011-07-19 09:50:40 -0300 1554) 								retorno = false;
606757d2 (root               2011-07-19 09:50:40 -0300 1555) 								return false;
606757d2 (root               2011-07-19 09:50:40 -0300 1556) 							}
606757d2 (root               2011-07-19 09:50:40 -0300 1557) 
606757d2 (root               2011-07-19 09:50:40 -0300 1558) 						}else{
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1559) 							retorno = false;
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1560) 							return false;
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1561) 						}
cb10c977 (Gabriel Silveira   2012-06-28 15:16:21 -0300 1562) 
cb10c977 (Gabriel Silveira   2012-06-28 15:16:21 -0300 1563)                         if(s_in.substr(0,1) == s_out.substr(0,1)){
cb10c977 (Gabriel Silveira   2012-06-28 15:16:21 -0300 1564) 
cb10c977 (Gabriel Silveira   2012-06-28 15:16:21 -0300 1565)                             if (!$(this).val().match(serie)){
cb10c977 (Gabriel Silveira   2012-06-28 15:16:21 -0300 1566)                                 retorno = false;
cb10c977 (Gabriel Silveira   2012-06-28 15:16:21 -0300 1567)                                 return false;
cb10c977 (Gabriel Silveira   2012-06-28 15:16:21 -0300 1568)                             }
cb10c977 (Gabriel Silveira   2012-06-28 15:16:21 -0300 1569) 
cb10c977 (Gabriel Silveira   2012-06-28 15:16:21 -0300 1570)                         }else{
cb10c977 (Gabriel Silveira   2012-06-28 15:16:21 -0300 1571)                             retorno = false;
cb10c977 (Gabriel Silveira   2012-06-28 15:16:21 -0300 1572)                             return false;
cb10c977 (Gabriel Silveira   2012-06-28 15:16:21 -0300 1573)                         } 
cb10c977 (Gabriel Silveira   2012-06-28 15:16:21 -0300 1574) 
606757d2 (root               2011-07-19 09:50:40 -0300 1575) 					}
606757d2 (root               2011-07-19 09:50:40 -0300 1576) 
606757d2 (root               2011-07-19 09:50:40 -0300 1577) 					sa_in = s_in;
606757d2 (root               2011-07-19 09:50:40 -0300 1578) 					sa_out = s_out;
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300 1579) 
606757d2 (root               2011-07-19 09:50:40 -0300 1580) 				});
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300 1581) 
606757d2 (root               2011-07-19 09:50:40 -0300 1582) 				if(retorno == false){
606757d2 (root               2011-07-19 09:50:40 -0300 1583) 					$('#msg_erro').css('display','');
606757d2 (root               2011-07-19 09:50:40 -0300 1584) 					$('.sucesso').css('display','none');
606757d2 (root               2011-07-19 09:50:40 -0300 1585) 					$('#msg_erro').html('<td colspan="6">Número de série inválido</td>');
a830ce09 (Gabriel Silveira   2012-06-29 10:37:05 -0300 1586) 					$(document).scrollTop('slow');
606757d2 (root               2011-07-19 09:50:40 -0300 1587) 				}
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300 1588) 
606757d2 (root               2011-07-19 09:50:40 -0300 1589) 				return retorno;
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300 1590) 
606757d2 (root               2011-07-19 09:50:40 -0300 1591) 			}
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300 1592) 
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300 1593) 
606757d2 (root               2011-07-19 09:50:40 -0300 1594) 		<?
606757d2 (root               2011-07-19 09:50:40 -0300 1595) 		}
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300 1596) 
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300 1597) 
606757d2 (root               2011-07-19 09:50:40 -0300 1598) 		if ($login_fabrica == 45){?>
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300 1599) 
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300 1600) 			// HD 410420
606757d2 (root               2011-07-19 09:50:40 -0300 1601) 			// NUMERO DE SÉRIE NKS
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300 1602) 			// 1º => Linha (será composto por dois dígitos EX: PC)
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300 1603) 			// 2° => Modelo (será composto por quatro dígitos numéricos)
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300 1604) 			// 3º => Voltagem do produto (será composto por uma letra)
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300 1605) 			// 4º => fabricante (composto por uma letra)
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300 1606) 			// 5º => Ano de fabricação (será composto por uma letra, que representará o ano)
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300 1607) 			// 6º => lote do fabricante (composto por dois dígitos EX 01;02...)
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300 1608) 			// 7º => Reservado para informação de montagem (nacional ou importado)
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300 1609) 			// 8º => Seqüência numérica iniciando sempre do 00001(será composto por cinco ou seis dígitos)
606757d2 (root               2011-07-19 09:50:40 -0300 1610) 
606757d2 (root               2011-07-19 09:50:40 -0300 1611) 
606757d2 (root               2011-07-19 09:50:40 -0300 1612) 			// PC2303CAA01X00001
606757d2 (root               2011-07-19 09:50:40 -0300 1613) 			// 1) PC-
606757d2 (root               2011-07-19 09:50:40 -0300 1614) 			// 2) 2303 -
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300 1615) 			// 3) C
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300 1616) 			// 4) A
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300 1617) 			// 5) A
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300 1618) 			// 6) 01
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300 1619) 			// 7) X
606757d2 (root               2011-07-19 09:50:40 -0300 1620) 			// 8) 00001
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300 1621) 
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300 1622) 
606757d2 (root               2011-07-19 09:50:40 -0300 1623) 			function validaSerie(){
606757d2 (root               2011-07-19 09:50:40 -0300 1624) 
606757d2 (root               2011-07-19 09:50:40 -0300 1625) 				//Retorno já verdadeiro, caso não tenha uma série correta, retorna falso
606757d2 (root               2011-07-19 09:50:40 -0300 1626) 				var retorno = true;
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300 1627) 
606757d2 (root               2011-07-19 09:50:40 -0300 1628) 				var s_in = ""; //Serie de entrada
606757d2 (root               2011-07-19 09:50:40 -0300 1629) 				var s_out = ""; //Serie de saída
606757d2 (root               2011-07-19 09:50:40 -0300 1630) 				var ident; //id da linha
606757d2 (root               2011-07-19 09:50:40 -0300 1631) 				var codigo_serie;
606757d2 (root               2011-07-19 09:50:40 -0300 1632) 
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300 1633) 				var codigo_familia = $('#codigo_validacao_serie').val();
606757d2 (root               2011-07-19 09:50:40 -0300 1634) 				var serie_inicial = $("#serie_inicial").val();
606757d2 (root               2011-07-19 09:50:40 -0300 1635) 				var serie_final = $("#serie_final").val();
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300 1636) 
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300 1637) 
606757d2 (root               2011-07-19 09:50:40 -0300 1638) 				//Recebe em formato de RegEx o filtro de series
c6a76b65 (Gabriel            2011-08-03 11:12:49 -0300 1639) 				var serie = new RegExp('[A-Z]{2}[0-9]{4}[A-C][A-Z][A-Z][0-9]{2}[A-Z][0-9]{5,6}$');
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300 1640) 
606757d2 (root               2011-07-19 09:50:40 -0300 1641) 				//Percorre todas as séries pra ver se estão válidas
606757d2 (root               2011-07-19 09:50:40 -0300 1642) 				$('.serie').each(function(){
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300 1643) 
606757d2 (root               2011-07-19 09:50:40 -0300 1644) 					ident = $(this).attr('rel');
606757d2 (root               2011-07-19 09:50:40 -0300 1645) 					s_in = $('#serie_in_'+ident).val();
606757d2 (root               2011-07-19 09:50:40 -0300 1646) 					s_out = $('#serie_out_'+ident).val();
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300 1647) 
606757d2 (root               2011-07-19 09:50:40 -0300 1648) 					if(s_in.length > 0 && !$('#apagar_serie_'+ident).is(':checked')){
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300 1649) 
606757d2 (root               2011-07-19 09:50:40 -0300 1650) 						codigo_serie = s_in.substring(0,2);
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300 1651) 
606757d2 (root               2011-07-19 09:50:40 -0300 1652) 						if(codigo_familia.indexOf(codigo_serie) == -1){
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1653) 							retorno = false;
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1654) 							return false;
606757d2 (root               2011-07-19 09:50:40 -0300 1655) 						}
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300 1656) 
606757d2 (root               2011-07-19 09:50:40 -0300 1657) 						if(s_in.substr(0,11) == s_out.substr(0,11) && retorno != false){
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300 1658) 
606757d2 (root               2011-07-19 09:50:40 -0300 1659) 							if (!$(this).val().match(serie)){
40f412d8 (root               2011-06-21 17:15:14 -0300 1660) 								retorno = false;
40f412d8 (root               2011-06-21 17:15:14 -0300 1661) 								return false;
606757d2 (root               2011-07-19 09:50:40 -0300 1662) 							}else{
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300 1663) 
606757d2 (root               2011-07-19 09:50:40 -0300 1664) 								t_pos5_s_in = (s_in.substr(8,1).charCodeAt(0) + 1944);
606757d2 (root               2011-07-19 09:50:40 -0300 1665) 								t_pos5_s_out = (s_in.substr(8,1).charCodeAt(0) + 1944);
606757d2 (root               2011-07-19 09:50:40 -0300 1666) 								hoje = new Date();
606757d2 (root               2011-07-19 09:50:40 -0300 1667) 								ano = hoje.getFullYear();
606757d2 (root               2011-07-19 09:50:40 -0300 1668) 								if (t_pos5_s_in > ano || t_pos5_s_out > ano){
606757d2 (root               2011-07-19 09:50:40 -0300 1669) 									retorno = false;
606757d2 (root               2011-07-19 09:50:40 -0300 1670) 									return false;
606757d2 (root               2011-07-19 09:50:40 -0300 1671) 								}
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300 1672) 
606757d2 (root               2011-07-19 09:50:40 -0300 1673) 								//validar NUMERO FINAL < INICIAL
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300 1674) 
606757d2 (root               2011-07-19 09:50:40 -0300 1675) 								t_pos8_s_in = (s_in.substr(12,5));
606757d2 (root               2011-07-19 09:50:40 -0300 1676) 								t_pos8_s_out = (s_out.substr(12,5));
606757d2 (root               2011-07-19 09:50:40 -0300 1677) 								if (t_pos8_s_in > t_pos8_s_out){
606757d2 (root               2011-07-19 09:50:40 -0300 1678) 									retorno = false;
606757d2 (root               2011-07-19 09:50:40 -0300 1679) 									return false;
606757d2 (root               2011-07-19 09:50:40 -0300 1680) 								}
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300 1681) 
40f412d8 (root               2011-06-21 17:15:14 -0300 1682) 							}
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1683) 
606757d2 (root               2011-07-19 09:50:40 -0300 1684) 						}else{
606757d2 (root               2011-07-19 09:50:40 -0300 1685) 							retorno = false;
606757d2 (root               2011-07-19 09:50:40 -0300 1686) 							return false;
606757d2 (root               2011-07-19 09:50:40 -0300 1687) 						}
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1688) 					}
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1689) 
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300 1690) 
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300 1691) 
606757d2 (root               2011-07-19 09:50:40 -0300 1692) 				});
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300 1693) 
606757d2 (root               2011-07-19 09:50:40 -0300 1694) 				if(retorno == false){
606757d2 (root               2011-07-19 09:50:40 -0300 1695) 					$('#msg_erro').css('display','');
606757d2 (root               2011-07-19 09:50:40 -0300 1696) 					$('.sucesso').css('display','none');
606757d2 (root               2011-07-19 09:50:40 -0300 1697) 					$('#msg_erro').html('<td colspan="6">Número de série inválido</td>');
606757d2 (root               2011-07-19 09:50:40 -0300 1698) 					$('body').animate({scrollTop:0});
606757d2 (root               2011-07-19 09:50:40 -0300 1699) 				}
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300 1700) 
606757d2 (root               2011-07-19 09:50:40 -0300 1701) 				return retorno;
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300 1702) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1703) 			}
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300 1704) 
606757d2 (root               2011-07-19 09:50:40 -0300 1705) 			function changeTypeCode(familia){
606757d2 (root               2011-07-19 09:50:40 -0300 1706) 				var valor = $(familia).val();
606757d2 (root               2011-07-19 09:50:40 -0300 1707) 				var codigo = $('#codigo_familia_'+valor).attr('rel');
606757d2 (root               2011-07-19 09:50:40 -0300 1708) 				$('#codigo_validacao_serie').val(codigo);
606757d2 (root               2011-07-19 09:50:40 -0300 1709) 			}
606757d2 (root               2011-07-19 09:50:40 -0300 1710) 	<?php
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1711) 		}
606757d2 (root               2011-07-19 09:50:40 -0300 1712) 
606757d2 (root               2011-07-19 09:50:40 -0300 1713) 	endif;?>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1714) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1715) 	//HD 325481
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1716) 	function inserirLinhaSerie() {
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1717) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1718) 		var total  = parseInt(document.getElementById('total_mascara').value);
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1719) 		var cor    = (total % 2) ? '#F7F5F0' : '#F1F4FA';
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1720) 		var td1    = document.createElement('td');
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1721) 		var td2    = document.createElement('td');
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1722) 		var tr     = document.createElement('tr');
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1723) 		var input1 = document.createElement('input');
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1724) 		var input2 = document.createElement('input');
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1725) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1726) 		input1.setAttribute('type', 'text');
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1727) 		input1.setAttribute('name', 'mascara_'+total);
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1728) 		input1.setAttribute('id', 'mascara_'+total);
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1729) 		input1.setAttribute('size', '60');
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300 1730) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1731) 		input2.setAttribute('type', 'button');
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1732) 		input2.setAttribute('name', 'btn_excluir_'+total);
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1733) 		input2.setAttribute('id', 'btn_excluir_'+total);
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1734) 		input2.setAttribute('value', 'Excluir');
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1735) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1736) 		tr.setAttribute('bgColor', cor);
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1737) 		tr.setAttribute('align', 'center');
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1738) 		tr.setAttribute('id', 'mascara_serie_' + total);
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1739) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1740) 		td1.appendChild(input1);
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1741) 		td2.appendChild(input2);
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1742) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1743) 		tr.appendChild(td1);
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1744) 		tr.appendChild(td2);
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1745) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1746) 		document.getElementById('tabela_mascara').appendChild(tr);
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1747) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1748) 		$('#mascara_'+total).keypress(function(event) {
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1749) 			return validaMascaraSerie(event);
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1750) 		});
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1751) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1752) 		$('#mascara_'+total).keyup(function() {
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1753) 			this.value = this.value.toUpperCase();
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1754) 		});
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300 1755) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1756) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1757) 		$('#btn_excluir_'+total).click(function() {
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1758) 			excluirMascara(total);
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1759) 		});
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1760) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1761) 		document.getElementById('total_mascara').value = total + 1;
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1762) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1763) 	}
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1764) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1765) 	function validaMascaraSerie(e) {
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1766) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1767) 		var tecla = e.keyCode ? e.keyCode : e.which ? e.which : e.charCode;
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1768) 		var str   = String.fromCharCode(tecla);
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1769) 		var reg   = new RegExp('[LlNn]');
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1770) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1771) 		//{"8" : "BACKSPACE", "9" : "TAB", "35" : "END", "36" : "HOME", "37" : "<-", "39" : "->", "46" : "DEL"}
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1772) 		if (tecla == 8 || tecla == 9 || tecla == 35 || tecla == 36 || tecla == 37 || tecla == 39 || tecla == 46) return true;
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1773) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1774) 		return reg.test(str);
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1775) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1776) 	}
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1777) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1778) 	function excluirMascara(id) {
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300 1779) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1780) 		if (confirm('Deseja realmente Excluir esta Máscara?')) {
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1781) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1782) 			$.ajax({
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1783) 				url: 'ajax_mascara_serie.php',
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1784) 				type: 'POST',
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1785) 				data: {
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1786) 					mascara : document.getElementById('mascara_'+id).value,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1787) 					produto : document.getElementById('produto').value
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1788) 				},
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1789) 				success: function(ret) {
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1790) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1791) 					if (ret == 1) {
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1792) 						document.getElementById('tabela_mascara').removeChild(document.getElementById('mascara_serie_'+id));
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1793) 					} else {
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1794) 						alert('Aconteceu um erro ao excluir o registro!');
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1795) 					}
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300 1796) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1797) 				}
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1798) 			});
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1799) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1800) 		}
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1801) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1802) 	}
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1803) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1804) </script>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1805) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1806) <style type='text/css'>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1807) .Div{
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1808) 	border:              #6699cc 1px solid;
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1809) 	font:             normal normal 10pt arial ;
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1810) 	color:            #000;
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1811) 	background-color: #ffffff;
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1812) }
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1813) .titulo_tabela{
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1814) 	background-color:#596d9b;
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1815) 	font: bold 14px "Arial";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1816) 	color:#FFFFFF;
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1817) 	text-align:center;
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1818) }
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1819) .titulo_coluna{
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1820) 	background-color:#596d9b;
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1821) 	font: bold 11px "Arial";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1822) 	color:#FFFFFF;
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1823) 	text-align:center;
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1824) }
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1825) .msg_erro{
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1826) 	background-color:#FF0000;
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1827) 	font: bold 16px "Arial";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1828) 	color:#FFFFFF;
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1829) 	text-align:center;
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1830) }
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1831) .sucesso{
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1832) 	background-color:green;
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1833) 	font: bold 16px "Arial";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1834) 	color:#FFFFFF;
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1835) 	text-align:center;
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1836) }
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1837) .formulario{
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1838) 	background-color:#D9E2EF;
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1839) 	font:11px Arial;
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1840) }
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1841) .subtitulo {
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1842)     background-color: #7092BE;
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1843) 	color: #FFFFFF;
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1844)     font: bold 14px Arial;
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1845)     text-align: center;
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1846) }
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1847) table.tabela tr td{
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1848) 	font-family: verdana;
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1849) 	font-size: 11px;
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1850) 	border-collapse: collapse;
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1851) 	border:1px solid #596d9b;
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1852) }
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1853) </style>
606757d2 (root               2011-07-19 09:50:40 -0300 1854) <?php $onsubmit = (in_array($login_fabrica,$fabricaIntervaloSerie)) ? 'onsubmit="return validaSerie()"' : null;?>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1855) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1856) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1857) <form name="frm_produto" method="post" enctype='multipart/form-data' action="<? $PHP_SELF ?>" <?php echo $onsubmit;?>>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1858) 	<input type="hidden" name="produto" id="produto" value="<?=$produto;?>">
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1859) 	<table width="700" border="0" cellpadding="2" cellspacing="1" class="formulario" align='center'>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1860) 		<? if (strlen($msg_erro) > 0) { ?>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1861) 			<tr class="msg_erro">
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1862) 				<td colspan="100%"><? echo $msg_erro; ?></td>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1863) 			</tr>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1864) 		<? } ?>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1865) 		<tr class="msg_erro" id="msg_erro" style="display:none;">
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1866) 			<td colspan="100%"></td>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1867) 		</tr>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1868) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1869) 		<? if (strlen($msg) > 0 AND strlen($msg_erro)==0) { ?>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1870) 			<tr class="sucesso">
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1871) 				<td colspan="100%"><? echo $msg; ?></td>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1872) 			</tr>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1873) 		<? } ?>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1874) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1875) 		<tr class="titulo_tabela"><td colspan="100%">Cadastrar Produtos</td></tr>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1876) 			<tr><td colspan="4">&nbsp;</td>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1877) 		</tr>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1878) 		<tr>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1879) 			<td width="20">&nbsp;</td>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1880) 			<td width="210">Referência *</td>
2be9f2d7 (Ederson            2011-08-18 11:39:34 -0300 1881) 			<? if($login_fabrica == 96) {?>
2be9f2d7 (Ederson            2011-08-18 11:39:34 -0300 1882) 			<td width="210">Modelo</td>
2be9f2d7 (Ederson            2011-08-18 11:39:34 -0300 1883) 			<? }?>
2be9f2d7 (Ederson            2011-08-18 11:39:34 -0300 1884) 			<td colspan=4>Descrição *</td>
2be9f2d7 (Ederson            2011-08-18 11:39:34 -0300 1885) 			<?php
2be9f2d7 (Ederson            2011-08-18 11:39:34 -0300 1886) 				if ($login_fabrica == 19 or $login_fabrica == 96) {
2be9f2d7 (Ederson            2011-08-18 11:39:34 -0300 1887) 					echo "<td>Preço</td>";
2be9f2d7 (Ederson            2011-08-18 11:39:34 -0300 1888) 				}
2be9f2d7 (Ederson            2011-08-18 11:39:34 -0300 1889) 			?>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1890) 		</tr>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1891) 		<tr>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1892) 			<td width="20">&nbsp;</td>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1893) 			<td nowrap><input type="text" class="frm" name="referencia" value="<? echo $referencia ?>" size="14" maxlength="20" <? if ($login_fabrica == 5) { ?> onblur="javascript: fnc_pesquisa_produto (document.frm_produto.referencia, 'referencia')" <? } ?>><a href='#'><img src="imagens/lupa.png" onclick="javascript: fnc_pesquisa_produto(document.frm_produto.referencia, 'referencia')"></a></td>
2be9f2d7 (Ederson            2011-08-18 11:39:34 -0300 1894) 			<? if($login_fabrica == 96) {?>
2be9f2d7 (Ederson            2011-08-18 11:39:34 -0300 1895) 				<td nowrap><input type="text" class="frm" name="modelo" value="<? echo $modelo ?>" size="14" maxlength="20" ><a href='#'><img src="imagens/lupa.png" onclick="javascript: fnc_pesquisa_produto(document.frm_produto.modelo, 'referencia')"></a></td>
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300 1896) 			<? }?>
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300 1897) 			<td colspan=4 nowrap><input type="text" class="frm" size="45" name="descricao" value="<? echo $descricao ?>" maxlength="70" <? if ($login_fabrica == 5) { ?> onblur="javascript: fnc_pesquisa_produto (document.frm_produto.descricao, 'descricao')" <? } ?>><a href='#'><img src="imagens/lupa.png" onclick="javascript: fnc_pesquisa_produto(document.frm_produto.descricao, 'descricao')"></a></td><?php
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1898) 			if ($login_fabrica == 19 or $login_fabrica == 96) {
2be9f2d7 (Ederson            2011-08-18 11:39:34 -0300 1899) 				echo "<td width='140'>&nbsp;&nbsp;R$ <input type='text' class='frm' name='preco' value='$preco' size='6' maxlength='20'></td>";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1900) 			}?>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1901) 		</tr>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1902) 		<tr><td colspan="4">&nbsp;</td></tr>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1903) 	</table>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1904) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1905) 	<table width="700" border="0" cellpadding="0" cellspacing="1" class="formulario" align='center'>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1906) 		<tr>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1907) 			<td width="20">&nbsp;</td>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1908) 			<td width="*">Garantia *</td>
a53578b1 (aoki               2011-11-22 14:46:57 -0300 1909) 			<? if ($login_fabrica == 87){?>
a53578b1 (aoki               2011-11-22 14:46:57 -0300 1910) 			<td width="*">Garantia Horas</td>
a53578b1 (aoki               2011-11-22 14:46:57 -0300 1911) 			<?}?>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1912) 			<td width="*"><acronym title="Valor da mão-de-obra de OS digitada pelo posto autorizado">M.Obra <?if ($login_fabrica == 14 or $login_fabrica == 66) echo "ASTEC"; else echo "Posto"; ?> <? if($login_fabrica != 96) echo "*"; ?></acronym></td><?php
2fc18fb3 (Brayan Laurindo    2011-10-10 09:21:43 -0300 1913) 			if ($login_fabrica != 86 && $login_fabrica != 101) {//HD 387824?>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1914) 				<td><acronym title="Valor da mão-de-obra de OS digitada pelo administrador/fábrica">M.Obra  <?if ($login_fabrica == 14 or $login_fabrica == 66) echo "LAI"; else echo "Admin"; ?> </acronym></td><?php
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1915) 			}
2fc18fb3 (Brayan Laurindo    2011-10-10 09:21:43 -0300 1916) 			else if ($login_fabrica == 101) { ?>
2fc18fb3 (Brayan Laurindo    2011-10-10 09:21:43 -0300 1917) 
2fc18fb3 (Brayan Laurindo    2011-10-10 09:21:43 -0300 1918) 				<td><acronym title="Valor da Mão de Obra quando lançado Orientação ao Consumidor no defeito constatado da OS">M.Obra Orientação</acronym></td>
2fc18fb3 (Brayan Laurindo    2011-10-10 09:21:43 -0300 1919) 
2fc18fb3 (Brayan Laurindo    2011-10-10 09:21:43 -0300 1920) 			<?php }
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300 1921) 			if ($login_fabrica == 3) {?>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1922) 				<td><acronym title="Valor adicional referente à recarga de gás.">Valor Recarga de Gás</acronym></td><?php
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1923) 			}
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300 1924) 			if ($login_fabrica == 35) {?>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1925) 				<td><acronym title="Valor da mão-de-obra de OS para Troca">M.Obra Troca</acronym></td><?php
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1926) 			}?>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1927) 		</tr>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1928) 		<tr>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1929) 			<td width="20">&nbsp;</td>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1930) 			<td><input type="text" class="frm" name="garantia" value="<? echo $garantia ?>" size="5" maxlength="20"> meses</td>
a53578b1 (aoki               2011-11-22 14:46:57 -0300 1931) 			<? if ($login_fabrica == 87){?>
a53578b1 (aoki               2011-11-22 14:46:57 -0300 1932) 			<td><input type="text" class="frm" name="garantia_horas" value="<? echo $garantia_horas ?>" size="5" maxlength="20"> horas</td>
a53578b1 (aoki               2011-11-22 14:46:57 -0300 1933) 			<?}?>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1934) 			<td>R$ <input type="text" class="frm" name="mao_de_obra" value="<? echo $mao_de_obra ?>" size="7" maxlength="20"></td><?php
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1935) 			if ($login_fabrica != 86) {//HD 387824?>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1936) 				<td>R$ <input type="text" class="frm" name="mao_de_obra_admin" value="<? echo $mao_de_obra_admin ?>" size="7" maxlength="20"></td><?php
606757d2 (root               2011-07-19 09:50:40 -0300 1937) 			}
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1938) 			if ($login_fabrica == 3) {?>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1939) 				<td>R$ <input type="text" class="frm" name="valor_troca_gas" value="<? echo $valor_troca_gas ?>" size="7" maxlength="20"></td><?php
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1940) 			}
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1941) 			if ($login_fabrica == 35) {?>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1942) 				<td>R$ <input type="text" class="frm" name="mao_de_obra_troca" value="<?=$mao_de_obra_troca?>" size="7" maxlength="20"></td><?php
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1943) 			}?>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1944) 		</tr><?php
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1945) 		if ($login_fabrica == 5) {
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1946) 			echo "<tr><td colspan='4'>&nbsp;</td></tr>";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1947) 			echo "<tr>";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1948) 			echo "<td width='20'>&nbsp;</td>";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1949) 			echo "<td nowrap colspan='3'>Link para imagem:&nbsp;";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1950) 			echo "<input acronym title='O caminho deve ser digitado por completo' type='text' ";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1951) 			echo "class='frm' name='link_img' value='$link_img' size='43'></td>";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1952) 			echo "</tr>";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1953) 		}?>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1954) 		<tr><td colspan="4">&nbsp;</td></tr>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1955) 	</table>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1956) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1957) 	<?
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1958) 	if($login_fabrica == 20 AND  strlen($produto)>0){
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1959) 		echo "<table width='700'align='center'><tr><td><div class='Div'>";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1960) 		echo "<table width='100%' border='0' class='formulario'><tr><td valign='top'>";
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300 1961) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1962) 		$sql = "SELECT * FROM tbl_produto_idioma WHERE produto = $produto";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1963) 		$res2 = pg_query ($con,$sql);
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1964) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1965) 		if (pg_num_rows($res2) > 0) {
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1966) 			$produto                  = trim(pg_fetch_result($res2,0,produto));
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1967) 			$idioma                   = trim(pg_fetch_result($res2,0,idioma));
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1968) 			$descricao_idioma         = trim(pg_fetch_result($res2,0,descricao));
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1969) 		}else{
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1970) 			echo "Não existe descrição para esse produto em outro idioma, preencha o campo abaixo para inserir uma.<br>";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1971) 			echo "<input type='hidden' name='idioma_novo' value='ES'>";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1972) 		}
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1973) 		echo "<b>Espanhol</b><br>";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1974) 		echo "Descrição: <input  type='text' class='frm' name='descricao_idioma' value='$descricao_idioma' size='30' maxlength='50'><br><br>";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1975) 		echo "<input type='hidden' name='idioma' value='ES'>";
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300 1976) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1977) 		echo "</td><td width:1px;></td>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1978) 		<td valign='top' >";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1979) 
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300 1980) 		$sql = "SELECT pais, garantia, valor FROM tbl_produto_pais WHERE produto = $produto";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1981) 		$res2 = pg_query ($con,$sql);
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1982) 		if (pg_num_rows($res2) > 0) {
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300 1983) 			echo "<TABLE class='formulario' ";
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300 1984) 			if ($prod_libera_br or $prod_libera_outros) {
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300 1985) 				echo 'width="200px"';
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300 1986) 			} else {
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300 1987) 				echo 'width="100%"';
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300 1988) 			}
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300 1989) 			echo ">";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1990) 			echo "<caption class='titulo_coluna'>Máquina liberada para</caption>";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1991) 			echo "<TR>";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1992) 			echo "<TD align='center'><b>País </b></TD>";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1993) 			echo "<TD align='center'><b>Garantia</b></TD>";
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300 1994) 			echo '<td align="center"><strong>Preço</strong></td>';
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1995) 			if ($prod_libera_br or $prod_libera_outros) echo "<TD><b>Ação</b></TD>";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1996) 			echo "</TD>";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1997) 			echo "</TR>";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1998) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 1999) 			for($i = 0 ; $i < pg_num_rows($res2) ; $i++ ){
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2000) 				$pais                  = trim(pg_fetch_result($res2,$i,pais));
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2001) 				$garantia_pais         = trim(pg_fetch_result($res2,$i,garantia));
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300 2002) 				$preco_pais = number_format(pg_fetch_result($res2, $i, 'valor'), 2, ',', '');
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2003) 				echo "<TR>";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2004) 				echo "<TD align='center'>$pais </TD>";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2005) 				echo "<TD align='center'>$garantia_pais</TD>";
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300 2006) 				echo "<TD align='center'>$ $preco_pais</TD>";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2007) 				//MLG 2011-05-06 - HD 374998
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2008) 				if (($pais=='BR' and $prod_libera_br) or $prod_libera_outros) echo "<TD><a href=\"javascript: if (confirm('Deseja excluir?')) {window.location='$PHP_SELF?produto=$produto&acao=a&pais=$pais'}; \">Excluir</a></TD>";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2009) 				echo "</TD>";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2010) 				echo "</TR>";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2011) 			}
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2012) 			echo "</TABLE>";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2013) 		}
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300 2014) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2015) 		//MLG 2011-05-06 - HD 374998
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2016) 		if ($prod_libera_br or $prod_libera_outros) {
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2017) 			$msg_libera = ($prod_libera_br) ? 'Liberar o produto para o' : 'Escolha o país';
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2018) 			$cond_libera= ($prod_libera_br) ? " WHERE pais = 'BR'" : '';
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2019) 			echo "</td><td width='1px' bgcolor='#6699CC'></td><td valign='top'><b>$msg_libera</b><br>";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2020) 			echo "<select name='produto_pais' id='produto_pais'>";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2021) 			$sql = "SELECT '<option value=\"'||pais||'\">'||nome||'</option>' AS opcao_pais
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2022) 						FROM tbl_pais $cond_libera
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2023) 						ORDER BY nome";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2024) 				$res = pg_query($con, $sql);
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2025) 				if(pg_num_rows($res)>0){
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2026) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2027) 					for($x=0; $x<pg_num_rows($res); $x++){
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2028) 						echo pg_fetch_result($res, $x, 0);
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2029) 					}
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2030) 				}
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2031) 			echo "</select>";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2032) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2033) 			echo "<br>";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2034) 			echo "<b>Garantia do País</b><br> <input  type='text' class='frm' name='garantia_pais' value='' size='15' id='garantia_pais' maxlength='50'><br>";
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300 2035) 			echo '<strong>Preço:</strong><br/>';
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300 2036) 			echo '<input type="text" class="frm" name="preco_pais" value="" size="5" id="preco_pais" /></br/><br/> ';
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300 2037) 			echo "<input type='button' name='btn_produto_pais' value = 'Atribui Pais'onclick=\"javascript:window.location='$PHP_SELF?produto=$produto&acao=atribui&pais='+document.getElementById('produto_pais').value+'&garantia_pais='+document.getElementById('garantia_pais').value+'&preco_pais='+document.getElementById('preco_pais').value\">";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2038) 			echo "</td>";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2039) 		}
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2040) 		echo "</tr></table>";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2041) 		echo "</div></td></tr></table>";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2042) 	}
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2043) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2044) 	?>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2045) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2046) 	<table width="700" border="0" cellpadding="2" cellspacing="1" class="formulario" align='center'>
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300 2047) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2048) 		<tr>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2049) 			<td width="20">&nbsp;</td>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2050) 			<td width="210">Linha *</td>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2051) 			<td width="290">Família</td>
606757d2 (root               2011-07-19 09:50:40 -0300 2052) 			<?php $style_codigo = ($login_fabrica == 45) ? '' : 'style="display:none"';?>
606757d2 (root               2011-07-19 09:50:40 -0300 2053) 			<td width="150" <?=$style_codigo;?>>Código Família</td>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2054) 			<td>Origem</td>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2055) 		</tr>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2056) 		<tr>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2057) 			<td width="20">&nbsp;</td>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2058) 			<td>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2059) 			<?
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2060) 			##### INÍCIO LINHA #####
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2061) 			$sql = "SELECT  *
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2062) 					FROM    tbl_linha
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2063) 					WHERE   tbl_linha.fabrica = $login_fabrica
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2064) 					AND     tbl_linha.ativo = TRUE
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2065) 					ORDER BY tbl_linha.nome;";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2066) 			$res = pg_query ($con,$sql);
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2067) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2068) 			if (pg_num_rows($res) > 0) {
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2069) 				echo "<select class='frm' style='width: 150px;' name='linha'>\n";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2070) 				echo "<option value=''>ESCOLHA</option>\n";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2071) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2072) 				for ($x = 0 ; $x < pg_num_rows($res) ; $x++){
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2073) 					$aux_linha = trim(pg_fetch_result($res,$x,linha));
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2074) 					$aux_nome  = trim(pg_fetch_result($res,$x,nome));
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2075) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2076) 					echo "<option value='$aux_linha'"; if ($linha == $aux_linha) echo " SELECTED "; echo ">$aux_nome</option>\n";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2077) 				}
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2078) 				echo "</select>\n";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2079) 			}
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2080) 			##### FIM LINHA #####
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2081) 			?>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2082) 			</td>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2083) 			<td>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2084) 			<?
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2085) 			##### INÍCIO FAMÍLIA #####
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2086) 			$sql = "SELECT  *
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2087) 					FROM    tbl_familia
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2088) 					WHERE   tbl_familia.fabrica = $login_fabrica
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2089) 					AND     tbl_familia.ativo = TRUE
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2090) 					ORDER BY tbl_familia.descricao;";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2091) 			$res = pg_query ($con,$sql);
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2092) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2093) 			if (pg_num_rows($res) > 0) {
606757d2 (root               2011-07-19 09:50:40 -0300 2094) 				echo "<select class='frm' style='width: 150px;' name='familia' onchange='changeTypeCode(this);'>\n";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2095) 				echo "<option value=''>ESCOLHA</option>\n";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2096) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2097) 				for ($x = 0 ; $x < pg_num_rows($res) ; $x++){
c6a76b65 (Gabriel            2011-08-03 11:12:49 -0300 2098) 					$aux_familia 		= trim(pg_fetch_result($res,$x,familia));
c6a76b65 (Gabriel            2011-08-03 11:12:49 -0300 2099) 					$aux_descricao  	= trim(pg_fetch_result($res,$x,descricao));
c6a76b65 (Gabriel            2011-08-03 11:12:49 -0300 2100) 					$aux_codigo  		= trim(pg_fetch_result($res,$x,codigo_validacao_serie));
c6a76b65 (Gabriel            2011-08-03 11:12:49 -0300 2101) 					$aux_codigo_familia = trim(pg_fetch_result($res,$x,codigo_familia));
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300 2102) 
606757d2 (root               2011-07-19 09:50:40 -0300 2103) 					if ($familia == $aux_familia){
606757d2 (root               2011-07-19 09:50:40 -0300 2104) 						$selected = 'selected="selected"';
c6a76b65 (Gabriel            2011-08-03 11:12:49 -0300 2105) 						$codigo_selecionado = (empty($aux_codigo)) ? $aux_codigo_familia : $aux_codigo;
606757d2 (root               2011-07-19 09:50:40 -0300 2106) 					}else{
606757d2 (root               2011-07-19 09:50:40 -0300 2107) 						$selected = null;
606757d2 (root               2011-07-19 09:50:40 -0300 2108) 					}
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300 2109) 
c6a76b65 (Gabriel            2011-08-03 11:12:49 -0300 2110) 					$codigo_serie =  (empty($aux_codigo)) ? $aux_codigo_familia : $aux_codigo;
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300 2111) 
c6a76b65 (Gabriel            2011-08-03 11:12:49 -0300 2112) 					echo "<option id='codigo_familia_$aux_familia' rel='$codigo_serie' value='$aux_familia' $selected>$aux_descricao</option>\n";
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300 2113) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2114) 				}
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2115) 				echo "</select>\n";
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300 2116) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2117) 			}
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2118) 			##### FIM FAMÍLIA #####
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2119) 			?>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2120) 			</td>
606757d2 (root               2011-07-19 09:50:40 -0300 2121) 			<?php
606757d2 (root               2011-07-19 09:50:40 -0300 2122) 				echo "
606757d2 (root               2011-07-19 09:50:40 -0300 2123) 				<td $style_codigo>
606757d2 (root               2011-07-19 09:50:40 -0300 2124) 					<input type='text' class='frm' style='width:75px' name='codigo_validacao_serie' id='codigo_validacao_serie' readonly='readonly' value='$codigo_selecionado'>
606757d2 (root               2011-07-19 09:50:40 -0300 2125) 				</td>";
606757d2 (root               2011-07-19 09:50:40 -0300 2126) 			?>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2127) 			<td>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2128) 			<select name="origem" class="frm" style="width:150px;">
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2129) 				<option value="">ESCOLHA</option>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2130) 				<option value="Nac" <? if ($origem == "Nac") echo " SELECTED "; ?>>Nacional</option>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2131) 				<option value="Imp" <? if ($origem == "Imp") echo " SELECTED "; ?>>Importado</option>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2132) 				<option value="USA" <? if ($origem == "USA") echo " SELECTED "; ?>>Importado USA</option>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2133) 				<option value="Asi" <? if ($origem == "Asi") echo " SELECTED "; ?>>Importado Asia</option>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2134) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2135) 			</select>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2136) 			</td>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2137) 			<?
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2138) 			if($login_fabrica==3){
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2139) 				echo "</tr><tr><td width='20'>&nbsp;</td><td colspan='3'  bgcolor='#D9E2EF'><br>Fornecedor do Produto</td>";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2140) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2141) 				$sql = "SELECT  *
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2142) 						FROM    tbl_produto_fornecedor
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2143) 						WHERE   tbl_produto_fornecedor.fabrica = $login_fabrica
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2144) 						ORDER BY tbl_produto_fornecedor.nome;";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2145) 				$res = pg_query ($con,$sql);
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300 2146) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2147) 				if (pg_num_rows($res) > 0) {
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2148) 					echo "</tr><tr><td width='20'>&nbsp;</td><td colspan='3'><select class='frm' style='width:400px'  name='produto_fornecedor'>\n";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2149) 					echo "<option value=''>ESCOLHA</option>\n";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2150) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2151) 					for ($x = 0 ; $x < pg_num_rows($res) ; $x++){
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2152) 						$aux_produto_fornecedor = trim(pg_fetch_result($res,$x,produto_fornecedor));
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2153) 						$aux_nome               = trim(pg_fetch_result($res,$x,nome));
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2154) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2155) 						echo "<option value='$aux_produto_fornecedor'"; if ($produto_fornecedor == $aux_produto_fornecedor) echo " SELECTED "; echo ">$aux_nome</option>\n";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2156) 					}
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2157) 					echo "</select></td>\n";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2158) 				}
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2159) 			}?>
40f412d8 (root               2011-06-21 17:15:14 -0300 2160) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2161) 		</tr>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2162) 		<tr><td colspan="100%">&nbsp;</td></tr>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2163) 	</table>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2164) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2165) 	<?if($login_fabrica==3 and strlen($produto)>0){
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2166) 		echo "<table width='700'align='center'><tr><td><div class='Div'>";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2167) 		echo "<table width='100%'><tr><td valign='top'>";
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300 2168) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2169) 		$sql = "SELECT * FROM tbl_produto_idioma WHERE produto = $produto";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2170) 		$res2 = pg_query ($con,$sql);
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2171) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2172) 		if (pg_num_rows($res2) > 0) {
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2173) 			$produto                  = trim(pg_fetch_result($res2,0,produto));
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2174) 			$idioma                   = trim(pg_fetch_result($res2,0,idioma));
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2175) 			$descricao_idioma         = trim(pg_fetch_result($res2,0,descricao));
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2176) 		}else{
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2177) 			echo "Não existe descrição para esse produto do fornecedor, preencha o campo abaixo para inserir uma.<br>";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2178) 			echo "<input type='hidden' name='idioma_novo' value='EN'>";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2179) 		}
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2180) 		echo "<b>Descrição do Fornecedor:</b> <input  type='text' class='frm' name='descricao_idioma' value='$descricao_idioma' size='30' maxlength='50'><br><br>";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2181) 		echo "<input type='hidden' name='idioma' value='EN'>";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2182) 		echo "</td>";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2183) 		echo "</table>";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2184) 		echo "</td>";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2185) 		echo "</tr>";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2186) 		echo "</table>";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2187) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2188) 	}?>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2189) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2190) 	<table width="700" border="0" cellpadding="2" cellspacing="1" class="formulario" align='center'>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2191) 		<tr><td colspan="4">&nbsp;</td></tr>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2192) 		<tr>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2193) 			<td width="20">&nbsp;</td>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2194) 			<td width="210">Voltagem</td>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2195) 			<?
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2196) 			if ($login_fabrica ==7 )  {
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2197) 				echo "<td>Capacidade</td>";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2198) 				echo "<td>Divisão</td>";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2199) 			}
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2200) 			?>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2201) 			<td width="290">Status Rede</td>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2202) 			<td><acronym title="Produto visível somente pelo Posto Interno, apesar de inativo para a rede!">Status uso Interno</acronym></td>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2203) 			<!--<td>Off-line (*)</td>-->
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2204) 		</tr>
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300 2205) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2206) 		<tr>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2207) 			<td width="20">&nbsp;</td>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2208) 			<td>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2209) 			<select name="voltagem" class="frm " style="width: 150px;">
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2210) 				<option value="">ESCOLHA</option>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2211) 				<option value="12 V" <? if ($voltagem == "12 V") echo " SELECTED "; ?>>12 V</option>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2212) 				<? if ($login_fabrica <> 1) { ?>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2213) 				<option value="110 V" <? if ($voltagem == "110 V") echo " SELECTED "; ?>>110 V</option>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2214) 				<?}?>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2215) 				<option value="127 V" <? if ($voltagem == "127 V") echo " SELECTED "; ?>>127 V</option>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2216) 				<option value="220 V" <? if ($voltagem == "220 V") echo " SELECTED "; ?>>220 V</option>
b07a7adc (root               2011-08-22 15:02:43 -0300 2217) 				<option value="230 V" <? if ($voltagem == "230 V") echo " SELECTED "; ?>>230 V</option>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2218) 				<option value="Bivolt" <? if ($voltagem == "Bivolt") echo " SELECTED "; ?>>Bivolt</option>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2219) 				<option value="Bivolt Aut" <? if ($voltagem == "Bivolt Aut") echo " SELECTED "; ?>>Bivolt Aut</option>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2220) 	<!--            <option value="Trivolt" <? if ($voltagem == "Trivolt") echo " SELECTED "; ?>>Trivolt</option> - -->
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2221) 				<option value="Bateria" <? if ($voltagem == "Bateria") echo " SELECTED "; ?>>Bateria</option>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2222) 				<option value="Pilha" <? if ($voltagem == "Pilha") echo " SELECTED "; ?>>Pilha</option>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2223) 				<?if($login_fabrica == 15) { // HD 75711?>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2224) 				<option value="Full Range" <? if ($voltagem == "Full Range") echo " SELECTED "; ?>>Full Range</option>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2225) 				<?}?>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2226) 				<?if($login_fabrica == 1) { // HD 75711?>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2227) 				<option value="SEM" <? if ($voltagem == "SEM") echo " SELECTED "; ?>>SEM</option>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2228) 				<?}?>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2229) 			</select>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2230) 			</td>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2231) 			<? if ($login_fabrica == 7) { ?>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2232) 				<td>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2233) 				<input type="text" class="frm" name="capacidade" value="<? echo $capacidade ?>" size="8" maxlength="8">Kg
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2234) 				</td>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2235) 				<td>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2236) 				<input type="text" class="frm" name="divisao" value="<? echo $divisao ?>" size="6" maxlength="8">
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2237) 				</td>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2238) 			<?}?>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2239) 			<td>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2240) 			<select name="ativo" class="frm" style="width: 150px;">
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2241) 				<option value="">ESCOLHA</option>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2242) 				<option value="t" <? if ($ativo == "t") echo " SELECTED "; ?>>Ativo</option>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2243) 				<option value="f" <? if ($ativo == "f") echo " SELECTED "; ?>>Inativo</option>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2244) 			</select>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2245) 			</td>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2246) 			<td>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2247) 			<select name="uso_interno_ativo" class="frm" style="width: 150px;">
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2248) 				<option value="">ESCOLHA</option>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2249) 				<option value="t" <? if ($uso_interno_ativo == "t") echo " SELECTED "; ?>>Ativo</option>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2250) 				<option value="f" <? if ($uso_interno_ativo == "f") echo " SELECTED "; ?>>Inativo</option>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2251) 			</select>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2252) 			</td>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2253) 		</tr>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2254) 		<tr><td colspan="4">&nbsp;</td></tr>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2255) 		<tr>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2256) 			<td width="20">&nbsp;</td>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2257) 			<td><acronym title="Quantidade de etiqueta a ser imprimida se for maior que 5 etiquetas">Qtd Etiqueta</acronym></td>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2258) 			<?
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2259) 			if ($login_fabrica ==96 )  echo "<td>Nome Comercial *</td>";
37cd7adb (guilhermecurcio    2012-07-18 16:40:51 -0300 2260) 			if ($login_fabrica == 14 or $login_fabrica == 66 or $login_fabrica == 11) {
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2261) 				echo "<td>Permitido abrir OS (*)</td>";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2262) 				if($login_fabrica == 14 or $login_fabrica == 66) {
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2263) 					echo "<td>Receber E-mail</td>";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2264) 				}
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2265) 			}
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2266) 			if ($login_fabrica == 1 or $login_fabrica == 80 ) {
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2267) 				echo "<td>Referência Interna (*)</td>";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2268) 				if ($login_fabrica == 1 ) {
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2269) 					echo "<td>Code Convention</td>";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2270) 				}
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2271) 				echo "<td>Locador</td>";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2272) 			}
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2273) 			if ($login_fabrica ==20 )  echo "<td>Bar Tool (*)</td>";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2274) 			if ($login_fabrica ==24 )  echo "<td>Referência Única (*)</td>";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2275) 			if ($login_fabrica ==3 or $login_fabrica == 30 or $login_fabrica >80 )   echo "<td>Marca</td>";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2276) 			if ($login_fabrica ==43 )  echo "<td>Sistema Operacional</td>";
d41057f0 (Ronald Santos      2012-05-30 15:30:14 -0300 2277) 			if ($login_fabrica ==42 )  echo "<td>Classe</td>";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2278) 			?>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2279) 		</tr>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2280) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2281) 		<tr>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2282) 			<td width="20">&nbsp;</td>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2283) 			<td><input type="text" class="frm" name="qtd_etiqueta_os" value="<? echo $qtd_etiqueta_os ?>" size="3" maxlength="10"></td>
37cd7adb (guilhermecurcio    2012-07-18 16:40:51 -0300 2284) 			<? if ($login_fabrica == 14 or $login_fabrica == 66 or $login_fabrica == 11) { ?>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2285) 			<td>
ffdee854 (guilhermecurcio    2012-07-19 16:49:39 -0300 2286) 			<input type="radio" class="frm" name="abre_os" <? if ($abre_os == 't') echo "checked"; ?> checked value="t"> Sim
ffdee854 (guilhermecurcio    2012-07-19 16:49:39 -0300 2287) 			<input type="radio" class="frm" name="abre_os" <? if ($abre_os == 'f') echo "checked"; ?> value="f"> Não
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2288) 			</td>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2289) 			<? if($login_fabrica == 14 or $login_fabrica == 66) { ?>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2290) 			<td>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2291) 			<input type="radio" class="frm" name="aviso_email" <? if ($aviso_email == 't' OR strlen($aviso_email) == 0) echo "checked"; ?> value="t"> Sim
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2292) 			<input type="radio" class="frm" name="aviso_email" <? if ($aviso_email == 'f') echo "checked"; ?> value="f"> Não
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2293) 			</td>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2294) 			<? } } ?>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2295) 			<? if (in_array($login_fabrica,array(1,20,24,80,96))) { ?>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2296) 				<td>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2297) 				<input type="text" class="frm" name="referencia_fabrica" value="<? echo $referencia_fabrica ?>" size="16" maxlength="20">
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2298) 				</td>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2299) 			<?}?>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2300) 			<?if ($login_fabrica==1){ //HD 14624?>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2301) 				<td><input type="text" class="frm" name="code_convention" value="<? echo $code_convention?>" size="15" maxlength="20"></td>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2302) 			<? } ?>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2303) 			<?if ($login_fabrica==1){ //HD 14624?>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2304) 				<td><input type="checkbox" class="frm" name="locador" <? if ($locador == 't' ) echo " checked " ?> value='t'></td>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2305) 			<? } ?>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2306) 			<? if ($login_fabrica == 3 or $login_fabrica == 30 or $login_fabrica >80) { ?>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2307) 			<td>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2308) 			<select name="marca" class="frm" style="width: 150px;">
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2309) 				<option value="">ESCOLHA</option>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2310) 				<?
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2311) 					$sql = "SELECT marca, nome from tbl_marca where fabrica = $login_fabrica and visivel is true order by nome";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2312) 					$res = pg_query($con,$sql);
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2313) 					if(pg_num_rows($res)>0){
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2314) 						for($i=0;pg_num_rows($res)>$i;$i++){
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2315) 							$xmarca = pg_fetch_result($res,$i,marca);
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2316) 							$xnome  = pg_fetch_result($res,$i,nome);
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2317) 						?>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2318) 						<option value="<?echo $xmarca;?>" <? if ($xmarca == $marca) echo " SELECTED "; ?>><?echo $xnome;?></option>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2319) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2320) 						<?}
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2321) 					}
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2322) 				?>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2323) 			</select>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2324) 			</td>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2325) 			<? } ?>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2326) 			<? if ($login_fabrica == 43) { ?>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2327) 			<td>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2328) 			<select name="sistema_operacional" class="frm" style="width: 110px;">
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2329) 				<option value="">ESCOLHA</option>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2330) 				<option value="1" <? if($sistema_operacional == 1) echo " SELECTED ";?>>Windows</option>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2331) 				<option value="2" <? if($sistema_operacional == 2) echo " SELECTED ";?>>Linux</option>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2332) 				<option value="3" <? if($sistema_operacional == 3) echo " SELECTED ";?>>Apple</option>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2333) 			</select>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2334) 			</td>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2335) 			<? } ?>
d41057f0 (Ronald Santos      2012-05-30 15:30:14 -0300 2336) 
d41057f0 (Ronald Santos      2012-05-30 15:30:14 -0300 2337) 			<? if ($login_fabrica == 42) { ?>
d41057f0 (Ronald Santos      2012-05-30 15:30:14 -0300 2338) 			<td>
d41057f0 (Ronald Santos      2012-05-30 15:30:14 -0300 2339) 			<select name="classe_produto" class="frm" >
d41057f0 (Ronald Santos      2012-05-30 15:30:14 -0300 2340) 				<option value="">ESCOLHA</option>
d41057f0 (Ronald Santos      2012-05-30 15:30:14 -0300 2341) 				<?
d41057f0 (Ronald Santos      2012-05-30 15:30:14 -0300 2342) 					$sql = "SELECT classe, nome FROM tbl_classe WHERE fabrica = $login_fabrica ORDER BY nome";
d41057f0 (Ronald Santos      2012-05-30 15:30:14 -0300 2343) 					$res = pg_query($con,$sql);
d41057f0 (Ronald Santos      2012-05-30 15:30:14 -0300 2344) 					if(pg_numrows($res) > 0){
d41057f0 (Ronald Santos      2012-05-30 15:30:14 -0300 2345) 						for($x = 0; $x < pg_numrows($res); $x++){
d41057f0 (Ronald Santos      2012-05-30 15:30:14 -0300 2346) 							$classe      = pg_result($res,$x,'classe');
d41057f0 (Ronald Santos      2012-05-30 15:30:14 -0300 2347) 							$nome_classe = pg_result($res,$x,'nome');
d41057f0 (Ronald Santos      2012-05-30 15:30:14 -0300 2348) 
d41057f0 (Ronald Santos      2012-05-30 15:30:14 -0300 2349) 							echo "<option value='$classe'";
d41057f0 (Ronald Santos      2012-05-30 15:30:14 -0300 2350) 							echo ($classe == $aux_classe) ? "SELECTED" : "";
d41057f0 (Ronald Santos      2012-05-30 15:30:14 -0300 2351) 							echo ">$nome_classe</option>";
d41057f0 (Ronald Santos      2012-05-30 15:30:14 -0300 2352) 						}
d41057f0 (Ronald Santos      2012-05-30 15:30:14 -0300 2353) 					}
d41057f0 (Ronald Santos      2012-05-30 15:30:14 -0300 2354) 				?>
d41057f0 (Ronald Santos      2012-05-30 15:30:14 -0300 2355) 			</select>
d41057f0 (Ronald Santos      2012-05-30 15:30:14 -0300 2356) 			</td>
d41057f0 (Ronald Santos      2012-05-30 15:30:14 -0300 2357) 			<? } ?>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2358) 		</tr>
606757d2 (root               2011-07-19 09:50:40 -0300 2359) 		<tr>
606757d2 (root               2011-07-19 09:50:40 -0300 2360) 			<td>&nbsp;</td>
606757d2 (root               2011-07-19 09:50:40 -0300 2361) 		</tr>
781e3f84 (Ederson            2011-09-09 08:57:07 -0300 2362) 		<? if(!in_array($login_fabrica,$fabricaIntervaloSerie) OR ($login_fabrica == 15)) {
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300 2363) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2364) 			?>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2365) 			<tr><td><br></td></tr>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2366) 			<tr>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2367) 				<td colspan=5>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2368) 					<table class="formulario" width="250px" align='center' border="0">
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300 2369) 
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300 2370) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2371) 						<tr align='left'>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2372) 							<td width="17px">&nbsp;</td>
40f412d8 (root               2011-06-21 17:15:14 -0300 2373) 							<td>Versão Inicial</td>
40f412d8 (root               2011-06-21 17:15:14 -0300 2374) 							<td colspan='2'>Versão Final</td>
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300 2375) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2376) 						</tr>
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300 2377) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2378) 						<tr align='left'>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2379) 							<td width="17px">&nbsp;</td>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2380) 							<td>
40f412d8 (root               2011-06-21 17:15:14 -0300 2381) 								<input type='text' maxlength='1' class='frm versao' id='serie_inicial' name='serie_inicial' value='<?echo $serie_inicial ?>' size='10' maxlength='20'><br>&nbsp;
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2382) 							</td>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2383) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2384) 							<td colspan='2'>
40f412d8 (root               2011-06-21 17:15:14 -0300 2385) 								<input type='text' maxlength='1' class='frm versao' id='serie_final' name='serie_final' value='<? echo $serie_final ?>' size='10' maxlength='20'><br>&nbsp;
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2386) 							</td>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2387) 						</tr>
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300 2388) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2389) 					</table>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2390) 				</td>
40f412d8 (root               2011-06-21 17:15:14 -0300 2391) 			</tr>
40f412d8 (root               2011-06-21 17:15:14 -0300 2392) 		<?
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2393) 		}?>
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300 2394) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2395) 		<tr><td colspan="100%">&nbsp;</td></tr>
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300 2396) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2397) 	</table><?php
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2398) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2399) 	if ($login_fabrica == 3 && !empty($produto)) {//HD 325481?>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2400) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2401) 		<table width="700" border="0" cellpadding="5" cellspacing="1" class="formulario" align='center'>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2402) 			<thead>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2403) 				<tr class="subtitulo">
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2404) 					<th colspan="100%">Máscara</th>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2405) 				</tr>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2406) 			</thead>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2407) 			<tbody id="tabela_mascara"><?php
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2408) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2409) 				$sql_mask = "SELECT * FROM tbl_produto_valida_serie WHERE fabrica = $login_fabrica AND produto = $produto;";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2410) 				$res_mask = pg_query($sql_mask);
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2411) 				$tot_mask = pg_num_rows($res_mask);
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2412) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2413) 				for ($i = 0; $i < $tot_mask; $i++) {
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2414) 					$cor = ($i % 2) ? "#F7F5F0" : "#F1F4FA";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2415) 					echo '<tr id="mascara_serie_'.$i.'" bgcolor="'.$cor.'" align="center">';
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2416) 							echo '<td><input type="text" name="mascara_'.$i.'" id="mascara_'.$i.'" size="60" value="'.pg_result($res_mask, $i, 'mascara').'" readonly="readonly" /></td>';
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2417) 						echo '<td width="150px"><input type="button" name="btn_excluir_'.$i.'" value="Excluir" onclick="excluirMascara('.$i.')" /></td>';
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2418) 					echo '</tr>';
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2419) 				}?>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2420) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2421) 			</tbody>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2422) 		</table>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2423) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2424) 		<table width="700" border="0" cellpadding="5" cellspacing="1" class="formulario" align='center'>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2425) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2426) 			<tr>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2427) 				<td align="center" colspan="100%">
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2428) 					<input type="hidden" name="total_mascara" id="total_mascara" value="<?=$i?>" />
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2429) 					<input type="button" name="btn_inserir" value="Inserir" onclick="inserirLinhaSerie()" />
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2430) 				</td>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2431) 			</tr>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2432) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2433) 			<tr><td colspan="100%">&nbsp;</td></tr>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2434) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2435) 		</table><?php
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2436) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2437) 	}?>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2438) 	<table width="700" border="0" cellpadding="2" cellspacing="1" class="formulario" align='center'>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2439) 		<tr class="subtitulo">
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2440) 			<td>Nome Comercial</td>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2441) 			<td>Classificação Fiscal</td>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2442) 			<td>I.P.I.</td><?php
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2443) 			if ($login_fabrica != 3 && $login_fabrica != 86) {//HD 387824?>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2444) 				<td>Radical No. Série </td><?php
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2445) 			}?>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2446) 			<td title='Esta opção serve para que este produto apareça na lista de TROCA DE PRODUTOS'>Lista de Troca</td>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2447) 			<?if($login_fabrica == 3 or $login_fabrica==11 or $login_fabrica==14 or $login_fabrica==86){?>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2448) 				<td>Intervenção Técnica</td>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2449) 			<?}?>
63d31eda (Ronald             2011-08-18 14:19:48 -0300 2450) 			<td>No. Série Obrigatório</td>
63d31eda (Ronald             2011-08-18 14:19:48 -0300 2451) 				<td>Produto Principal</td>
63d31eda (Ronald             2011-08-18 14:19:48 -0300 2452) 			<?php
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2453) 			echo "<td>Troca Obrigatória</td>";
cf6be55f (Gabriel            2011-08-04 08:41:21 -0300 2454) 			if ($login_fabrica == 3 || $login_fabrica == 45) {
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2455) 				echo "<td>Validar Série</td>";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2456) 			}
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2457) 			if ($login_fabrica == 35) {
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2458) 				echo "<td>Produto Crítico</td>";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2459) 			}
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2460) 			if ($login_fabrica == 1) {
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2461) 				echo "<td>Troca Faturada(valor)</td>";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2462) 				echo "<td>Troca Garantia</td>";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2463) 				echo "<td>Troca Faturada</td>";
63157ab1 (guilhermecurcio    2012-07-17 11:20:34 -0300 2464) 			}
63157ab1 (guilhermecurcio    2012-07-17 11:20:34 -0300 2465)             if ($login_fabrica == 42) {
63157ab1 (guilhermecurcio    2012-07-17 11:20:34 -0300 2466)                 echo "<td>Entrega Técnica</td>";
63157ab1 (guilhermecurcio    2012-07-17 11:20:34 -0300 2467)             }
63157ab1 (guilhermecurcio    2012-07-17 11:20:34 -0300 2468)             ?>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2469) 		</tr>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2470) 		<tr align="center">
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2471) 			<td><input type="text" class="frm" name="nome_comercial" value="<? echo $nome_comercial ?>" size="15" maxlength="20"></td>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2472) 			<td><input type="text" class="frm" name="classificacao_fiscal" value="<? echo $classificacao_fiscal ?>" size="15" maxlength="20"></td>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2473) 			<td><input type="text" class="frm" name="ipi" value="<? echo $ipi ?>" size="5" maxlength="10"></td><?php
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2474) 			if ($login_fabrica != 3 && $login_fabrica != 86) {//HD 387824?>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2475) 				<td><input type="text" class="frm" name="radical_serie" value="<? echo $radical_serie ?>" size="12" maxlength="10"></td><?php
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2476) 			}?>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2477) 			<td><input type="checkbox" class="frm" name="lista_troca" <? if ($lista_troca == 't' ) echo " checked " ?> value='t' ></td>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2478) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2479) 			<?if($login_fabrica==3 or $login_fabrica==11 or $login_fabrica == 14 or $login_fabrica == 86){?>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2480) 				<td><input type="checkbox" class="frm" name="intervencao_tecnica" <? if ($intervencao_tecnica == 't' or $login_fabrica == 86 ) echo " checked " ?> value='t' ></td>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2481) 			<?}?>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2482) 
63d31eda (Ronald             2011-08-18 14:19:48 -0300 2483) 			<td><input type="checkbox" class="frm" name="numero_serie_obrigatorio" <? if ($numero_serie_obrigatorio == 't' ) echo " checked " ?> value='t' ></td>
63d31eda (Ronald             2011-08-18 14:19:48 -0300 2484) 				<td><input type="checkbox" class="frm" name="produto_principal" <? if ($produto_principal == 't' ) {echo " checked ";} if(($login_fabrica == 46 OR $login_fabrica > 73) AND strlen($produto) == 0){ echo "checked"; } ?> value='t' ></td>
63d31eda (Ronald             2011-08-18 14:19:48 -0300 2485) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2486) 			<td><input type="checkbox" class="frm" name="troca_obrigatoria" <? if ($troca_obrigatoria == 't' ) echo " checked " ?> value='t' ></td>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2487) 
cf6be55f (Gabriel            2011-08-04 08:41:21 -0300 2488) 			<? if ($login_fabrica == 3 || $login_fabrica == 45) { ?>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2489) 				<td><input type="checkbox" class="frm" name="validar_serie" <? if ($validar_serie == 't' ) echo " checked " ?> value='t' ></td>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2490) 			<? }?>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2491) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2492) 			<? if ($login_fabrica == 35) { ?>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2493) 				<td><input type="checkbox" class="frm" name="produto_critico" <? if ($produto_critico == 't' ) echo " checked " ?> value='t' ></td>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2494) 			<? }?>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2495) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2496) 			<? if ($login_fabrica == 1) { //hd 7474 TAKASHI 23/11/07  //hd 7474 Fabio 30/11/07 ?>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2497) 				<td><input type="text" class="frm" name="valor_troca" value="<? echo $valor_troca ?>" size="6" maxlength="6" onBlur='checarNumero(this)'></td>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2498) 				<td><input type="checkbox" class="frm" name="troca_garantia" <? if ($troca_garantia == 't' ) echo " checked " ?> value='t' ></td>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2499) 				<td><input type="checkbox" class="frm" name="troca_faturada" <? if ($troca_faturada == 't' ) echo " checked " ?> value='t' ></td>
63157ab1 (guilhermecurcio    2012-07-17 11:20:34 -0300 2500) 			<? 
63157ab1 (guilhermecurcio    2012-07-17 11:20:34 -0300 2501)             }
63157ab1 (guilhermecurcio    2012-07-17 11:20:34 -0300 2502)             if ($login_fabrica == 42) {
63157ab1 (guilhermecurcio    2012-07-17 11:20:34 -0300 2503)             ?>
63157ab1 (guilhermecurcio    2012-07-17 11:20:34 -0300 2504)                 <td>
63157ab1 (guilhermecurcio    2012-07-17 11:20:34 -0300 2505)                     <input type="checkbox" class="frm" name="entrega_tecnica" <? if ($entrega_tecnica == "t") echo "checked" ?> value="t" />
63157ab1 (guilhermecurcio    2012-07-17 11:20:34 -0300 2506)                 </td>
63157ab1 (guilhermecurcio    2012-07-17 11:20:34 -0300 2507)             <?
63157ab1 (guilhermecurcio    2012-07-17 11:20:34 -0300 2508)             }
63157ab1 (guilhermecurcio    2012-07-17 11:20:34 -0300 2509)             ?>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2510) 		</tr>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2511)         <?
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2512)         if($login_fabrica==20){?>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2513) 			<tr align='center'>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2514) 				<td colspan='8'>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2515) 					Comentário
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2516) 				</td>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2517) 			</tr>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2518) 			<tr>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2519) 				<td colspan='8' align='center'>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2520) 					<textarea name='observacao' cols='90' rows='4' class='frm'>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2521) 					<?
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2522) 						if(strlen($observacao)>0){
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2523) 							echo nl2br($observacao);
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2524) 						}
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2525) 					?>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2526) 					</textarea>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2527) 				</td>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2528) 			</tr>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2529) 		<? } ?>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2530) 	</table>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2531) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2532) 	<? #RADICAL DE NÚMERO DE SÉRIE - BRITÂNIA HD 259784
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2533) 	if($login_fabrica==3){
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2534) 	?>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2535) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2536) 		<table width="700" border="0" cellpadding="2" cellspacing="1" class="formulario" align='center'>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2537) 			<tr><td colspan="3">&nbsp;</td></tr>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2538) 			<tr>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2539) 				<td>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2540) 					<span>Radical N. Série 1</span>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2541) 				</td>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2542) 				<td>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2543) 					<span>Radical N. Série 2</span>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2544) 				</td>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2545) 				<td>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2546) 					<span>Radical N. Série 3</span>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2547) 				</td>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2548) 			</tr>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2549) 			<tr>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2550) 				<td>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2551) 					<input type="text" class="frm" name="radical_serie" value="<? echo $radical_serie ?>" size="5" maxlength="10" title="Digite o nº do radical série">
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2552) 				</td>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2553) 				<td>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2554) 					<input type="text" class="frm" name="radical_serie2" value="<? echo $radical_serie2 ?>" size="5" maxlength="10" title="Digite o nº do radical série(2)">
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2555) 				</td>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2556) 				<td>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2557) 					<input type="text" class="frm" name="radical_serie3" value="<? echo $radical_serie3 ?>" size="5" maxlength="10" title="Digite o nº do radical série(3)">
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2558) 				</td>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2559) 			</tr>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2560) 			<tr>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2561) 				<td>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2562) 					<span>Radical N. Série 4</span>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2563) 					<br>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2564) 				</td>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2565) 				<td>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2566) 					<span>Radical N. Série 5</span>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2567) 				</td>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2568) 				<td>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2569) 					<span>Radical N. Série 6</span>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2570) 				</td>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2571) 			</tr>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2572) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2573) 			<tr>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2574) 				<td>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2575) 					<input type="text" class="frm" name="radical_serie4" value="<? echo $radical_serie4 ?>" size="5" maxlength="10" title="Digite o nº do radical série(4)">
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2576) 				</td>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2577) 				<td>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2578) 					<input type="text" class="frm" name="radical_serie5" value="<? echo $radical_serie5 ?>" size="5" maxlength="10" title="Digite o nº do radical série(5)">
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2579) 				</td>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2580) 				<td>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2581) 					<input type="text" class="frm" name="radical_serie6" value="<? echo $radical_serie6 ?>" size="5" maxlength="10" title="Digite o nº do radical série(6)">
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2582) 				</td>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2583) 			</tr>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2584) 		</table>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2585) 	<?
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2586) 	} #FIM - RADICAL DE NÚMERO DE SÉRIE - BRITÂNIA
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2587) 	?>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2588) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2589) 	<?  // HD 96953 - Adicionar imagem do produto para a Britânia
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2590)     if ($login_fabrica==3 or $login_fabrica>80) {
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2591) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2592)         $imagem_produto = $produto.'.jpg';
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2593)         if (strlen($imagem_produto)>4) {
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2594)             $imagem     = "imagens_produtos/$login_fabrica/pequena/$imagem_produto";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2595)             $msg_imagem = "Anexar imagem:";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2596)             if (file_exists("../$imagem")) {
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2597)                 $tag_imagem = "<a href='../".str_replace("pequena", "media", $imagem)."' class='thickbox' ><img src='../$imagem?bypass=" . md5(mt_rand(100,999)) . "' title='Clique para ver a imagem' valign='middle' class='thickbox' height='60'></a>\n";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2598)                 $msg_imagem = "Mudar imagem:";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2599)             }
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2600) ?>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2601) <table width='700' class='formulario'>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2602) 	<caption class='subtitulo'>Imagem do produto <?=$descricao?><?=(strlen($referencia)>0) ? " (ref. $referencia)":""?></caption>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2603) 	<tr>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2604) 		<td nowrap='nowrap' width='20%'><?=$msg_imagem?></td>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2605) 		<td align='center'>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2606) 			<input type='hidden' name='MAX_FILE_SIZE' value='1048576'>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2607) 			<?=$tag_imagem?>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2608) 		</td>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2609) 		<td width='60%' align='left'>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2610) 			<input title='Selecione o arquivo com a foto do produto'
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2611) 			        type='file' name='arquivo' size='18'
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2612) 					class="multi {accept:'jpg|gif|png', max:'1', STRING: {remove:'Remover',selected:'Selecionado: <?=$file?>', denied:'Tipo de arquivo inválido: <?=$ext?>!'}}">
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2613) 		</td>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2614) 	</tr>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2615) </table>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2616) <?		}
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2617)     }
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2618) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2619)    //hd 21461
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2620) 	if ($login_fabrica == 1) {
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2621) 		$qtde_item = 100;
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2622) 		$qtde_item_visiveis = 5;
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2623) 		$qtde_linhas = 0;
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2624) 
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300 2625) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2626) 		if (strlen($produto) > 0) {
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2627) 			$sql = "SELECT  tbl_produto.referencia                     ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2628) 							tbl_produto.descricao                      ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2629) 							tbl_produto.produto                        ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2630) 							tbl_produto_troca_opcao.produto_troca_opcao,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2631) 							tbl_produto.voltagem                       ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2632) 							tbl_produto_troca_opcao.kit
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2633) 					FROM tbl_produto
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2634) 					JOIN tbl_produto_troca_opcao ON tbl_produto.produto = tbl_produto_troca_opcao.produto_opcao
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2635) 					AND  tbl_produto_troca_opcao.produto = $produto
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2636) 					ORDER by tbl_produto_troca_opcao.kit, tbl_produto.descricao, tbl_produto.voltagem";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2637) 			$res = pg_query($con, $sql);
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2638) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2639) 			if (pg_num_rows($res) > 0) {
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2640) 				$qtde_linhas = pg_num_rows($res);
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2641) 			}
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2642) 		}
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2643) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2644) 		echo "<input class='frm' type='hidden' name='qtde_item' value='$qtde_item'>\n";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2645) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2646) 		echo "<br><br><center>";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2647) 		echo "<table class='tabela_item' bgcolor='#D9E2EF' width='820'>";
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300 2648) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2649) 			echo "<tr class='titulo_tabela'>";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2650) 				echo "<td colspan='5' align='center'>";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2651) 				echo "<b>Pode ser trocado por:</b>";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2652) 				echo "</td>";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2653) 			echo "</tr>";
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300 2654) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2655) 			//HD #145639 - INSTRUÇÕES
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2656) 			echo "
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2657) 			<tr class='subtitulo'>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2658) 				<td colspan=5 style='padding: 3px;'>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2659) 				<b>KITs:</b> podem ser criados KITs para trocar um produto por vários. Para isto, selecione na coluna KIT o mesmo número para agrupar vários produtos. No momento da troca os produtos com o mesmo número de KIT serão agrupados para seleção.
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2660) 				</td>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2661) 			</tr>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2662) 			";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2663) 			 echo "<tr>\n";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2664) 			echo "<td colspan='3'></td>\n";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2665) 			echo "<td align='right' colspan='2' style='font-size:11px;'>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2666) 					Qtde linhas
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2667) 					<select onChange='qtdeLinhas(this)' class='frm'>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2668) 					<option value='5'>5 Linhas</option>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2669) 					<option value='10'>10 Linhas</option>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2670) 					<option value='15'>15 Linhas</option>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2671) 					<option value='30'>30 Linhas</option>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2672) 					<option value='50'>50 Linhas</option>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2673) 					<option value='100'>100 Linhas</option>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2674) 					</select>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2675) 			</td>\n";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2676) 			echo "</tr>\n";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2677) 			//HD #145639 - NOME DAS COLUNAS
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2678) 			echo "
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2679) 			<tr class='titulo_coluna'>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2680) 				<td></td>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2681) 				<td>Código Produto</td>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2682) 				<td>Nome Produto</td>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2683) 				<td>Voltagem</td>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2684) 				<td>KIT</td>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2685) 			</tr>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2686) 			";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2687) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2688) 			for ($i=0; $i<$qtde_item; $i++) {
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2689) 				$referencia_opcao    = "";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2690) 				$descricao_opcao     = "";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2691) 				$produto_opcao       = "";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2692) 				$produto_troca_opcao = "";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2693) 				$voltagem_opcao = "";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2694) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2695) 				if ($i<$qtde_linhas){
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2696) 					$referencia_opcao    = pg_fetch_result($res,$i,referencia);
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2697) 					$descricao_opcao     = pg_fetch_result($res,$i,descricao);
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2698) 					$produto_opcao       = pg_fetch_result($res,$i,produto);
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2699) 					$produto_troca_opcao = pg_fetch_result($res,$i,produto_troca_opcao);
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2700) 					$voltagem_opcao      = pg_fetch_result($res,$i,voltagem);
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2701) 					$kit_opcao             = pg_fetch_result($res,$i,kit);
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2702) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2703) 					$erro_linha = "erro_linha" . $i;
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2704) 					$erro_linha = $$erro_linha;
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2705) 					$cor_erro = "#FFFFFF";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2706) 					if ($erro_linha == 1) $cor_erro = "#FF9999";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2707) 				}
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2708) 				else $kit_opcao = "";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2709) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2710) 				$ocultar_linha = "";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2711) 				if ($i+1 > $qtde_item_visiveis and $i+1 > $qtde_linhas){
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2712) 					$ocultar_linha = " style='display:none' ";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2713) 				}
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2714) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2715) 				echo "\n<tr ".$ocultar_linha." rel='$i' bgcolor='$cor_erro' style='font-size:11px;'>";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2716) 					echo "<td align='center'><input class='frm' type='hidden' name='produto_opcao_$i'    ; rel='produtos'                          value='$produto_opcao'>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2717) 											 <input class='frm' type='hidden' name='produto_troca_opcao_$i'    ; rel='produtos' value='$produto_troca_opcao'>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2718) 											 <input class='frm' type='hidden' name='voltagem_troca_opcao_$i'    ; rel='produtos' value=''>".($i+1)."</td>";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2719) 					echo "<td align='center'><input class='frm' type='text'   name='referencia_opcao_$i' ; rel='produtos' size='20' maxlength='30' value='$referencia_opcao' onchange=\"javascript: document.frm_produto.voltagem_opcao_$i.value = ''\">
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2720) 						  <img src='imagens/lupa.png' border='0' align='absmiddle' onclick='javascript: fnc_pesquisa_produto_opcao (document.frm_produto.referencia_opcao_$i,document.frm_produto.descricao_opcao_$i,document.frm_produto.produto_opcao_$i,document.frm_produto.voltagem_opcao_$i,\"referencia\")' style='cursor:pointer;'></td>";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2721) 					echo "<td align='center'><input class='frm' type='text'   name='descricao_opcao_$i'   ; rel='produtos' size='50' maxlength='50' value='$descricao_opcao' onchange=\"javascript: document.frm_produto.voltagem_opcao_$i.value = ''\">
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2722) 						  <img src='imagens/lupa.png' border='0' align='absmiddle' onclick='javascript: fnc_pesquisa_produto_opcao (document.frm_produto.referencia_opcao_$i,document.frm_produto.descricao_opcao_$i,document.frm_produto.produto_opcao_$i,document.frm_produto.voltagem_opcao_$i,\"descricao\")' style='cursor:pointer;'></td>";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2723) 					echo "<td align='left'><input class='frm' type='text' name='voltagem_opcao_$i'; rel='produtos' value='$voltagem_opcao' readonly></td>";
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300 2724) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2725) 					//HD #145639 - COLUNA DE KITS
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2726) 					$n_kit_opcoes = 20;
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2727) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2728) 					echo "
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2729) 					<td align='center'>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2730) 						<select name='kit_opcao_$i' class='frm'>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2731) 						<option value='0'>--</option>";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2732) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2733) 					for($k = 1; $k <=$n_kit_opcoes; $k++) {
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2734) 						if ($kit_opcao == $k) $selected = "selected";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2735) 						else $selected = "";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2736) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2737) 						echo "
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2738) 						<option $selected value='$k'>$k</option>";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2739) 					}
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300 2740) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2741) 					echo "
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2742) 						</select>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2743) 					</td>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2744) 					";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2745) 				echo "</tr>";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2746) 			}
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2747) 		echo "</table>";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2748)     } ?>
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300 2749) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2750) 	<!-- HD 335150 INICIO -->
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2751) 	<?php
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2752) 
606757d2 (root               2011-07-19 09:50:40 -0300 2753) 	if (in_array($login_fabrica,$fabricaIntervaloSerie)){
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2754) 		?>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2755) 		<table class="formulario" align="center" width="700px" cellpadding="0" cellspacing="0">
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2756) 			<tr>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2757) 				<td>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2758) 					&nbsp;
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2759) 				</td>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2760) 			</tr>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2761) 			<tr>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2762) 				<td colspan="1" class='subtitulo'>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2763) 					Intervalo de Série
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2764) 				</td>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2765) 			</tr>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2766) 			<tr>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2767) 				<td>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2768) 					&nbsp;
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2769) 				</td>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2770) 			</tr>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2771) 		</table>
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300 2772) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2773) 		<table  id="table_serie_in_out" class="tabela" width="700px" cellpadding="1" cellspacing="1" align="center">
a830ce09 (Gabriel Silveira   2012-06-29 10:37:05 -0300 2774)             <?
a830ce09 (Gabriel Silveira   2012-06-29 10:37:05 -0300 2775)             if (strlen($produto) > 0){
a830ce09 (Gabriel Silveira   2012-06-29 10:37:05 -0300 2776)                 $sql = "
a830ce09 (Gabriel Silveira   2012-06-29 10:37:05 -0300 2777)                     SELECT
a830ce09 (Gabriel Silveira   2012-06-29 10:37:05 -0300 2778)                         produto_serie,
a830ce09 (Gabriel Silveira   2012-06-29 10:37:05 -0300 2779)                         serie_inicial ,
a830ce09 (Gabriel Silveira   2012-06-29 10:37:05 -0300 2780)                         serie_final
a830ce09 (Gabriel Silveira   2012-06-29 10:37:05 -0300 2781) 
a830ce09 (Gabriel Silveira   2012-06-29 10:37:05 -0300 2782)                     FROM
a830ce09 (Gabriel Silveira   2012-06-29 10:37:05 -0300 2783)                         tbl_produto_serie
a830ce09 (Gabriel Silveira   2012-06-29 10:37:05 -0300 2784)                     where
a830ce09 (Gabriel Silveira   2012-06-29 10:37:05 -0300 2785)                         tbl_produto_serie.produto = $produto
a830ce09 (Gabriel Silveira   2012-06-29 10:37:05 -0300 2786)                     order by produto_serie
a830ce09 (Gabriel Silveira   2012-06-29 10:37:05 -0300 2787)                 ";
a830ce09 (Gabriel Silveira   2012-06-29 10:37:05 -0300 2788) 
a830ce09 (Gabriel Silveira   2012-06-29 10:37:05 -0300 2789)                 $res = pg_query ($con,$sql);
a830ce09 (Gabriel Silveira   2012-06-29 10:37:05 -0300 2790)                 $linha = pg_num_rows($res);
a830ce09 (Gabriel Silveira   2012-06-29 10:37:05 -0300 2791) 
a830ce09 (Gabriel Silveira   2012-06-29 10:37:05 -0300 2792)                 if ( $_POST['qtde_itens'] >0 ){
a830ce09 (Gabriel Silveira   2012-06-29 10:37:05 -0300 2793)                     $linha = $_POST['qtde_itens'];
a830ce09 (Gabriel Silveira   2012-06-29 10:37:05 -0300 2794)                 }
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300 2795) 
a830ce09 (Gabriel Silveira   2012-06-29 10:37:05 -0300 2796)             ?>
a830ce09 (Gabriel Silveira   2012-06-29 10:37:05 -0300 2797)             <input type="hidden" name="qtde_itens" value="<?=$linha?>" id="qtde_itens">
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2798) 			<tr class="titulo_coluna">
a830ce09 (Gabriel Silveira   2012-06-29 10:37:05 -0300 2799) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2800) 				<th>Série Inicial</th>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2801) 				<th>Série Final</th>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2802) 				<th width="25%">Ações</th>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2803) 			</tr>
a830ce09 (Gabriel Silveira   2012-06-29 10:37:05 -0300 2804) 			
a830ce09 (Gabriel Silveira   2012-06-29 10:37:05 -0300 2805)             <?
cb10c977 (Gabriel Silveira   2012-06-28 15:16:21 -0300 2806) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2807) 				for ($i = 0; $i < $linha; $i++){
cb10c977 (Gabriel Silveira   2012-06-28 15:16:21 -0300 2808) 					
a830ce09 (Gabriel Silveira   2012-06-29 10:37:05 -0300 2809)                     if ( $_POST['qtde_itens'] > 0 and $msg_erro){
cb10c977 (Gabriel Silveira   2012-06-28 15:16:21 -0300 2810) 
a830ce09 (Gabriel Silveira   2012-06-29 10:37:05 -0300 2811)                         $produto_serie  = $_POST['produto_serie_in_out_'.$i];
a830ce09 (Gabriel Silveira   2012-06-29 10:37:05 -0300 2812)                         $serie_in       = $_POST['serie_in_'.$i];
a830ce09 (Gabriel Silveira   2012-06-29 10:37:05 -0300 2813)                         $serie_out      = $_POST['serie_out_'.$i];
cb10c977 (Gabriel Silveira   2012-06-28 15:16:21 -0300 2814) 
cb10c977 (Gabriel Silveira   2012-06-28 15:16:21 -0300 2815)                     }else{
cb10c977 (Gabriel Silveira   2012-06-28 15:16:21 -0300 2816) 
cb10c977 (Gabriel Silveira   2012-06-28 15:16:21 -0300 2817)                         $produto_serie = pg_result($res,$i,produto_serie);
cb10c977 (Gabriel Silveira   2012-06-28 15:16:21 -0300 2818)     					$serie_in      = pg_result($res,$i,serie_inicial);
cb10c977 (Gabriel Silveira   2012-06-28 15:16:21 -0300 2819)     					$serie_out     = pg_result($res,$i,serie_final);
cb10c977 (Gabriel Silveira   2012-06-28 15:16:21 -0300 2820)                     }
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300 2821) 
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300 2822) 
40f412d8 (root               2011-06-21 17:15:14 -0300 2823) 					$length_serie_in = ($login_fabrica == 15) ? " maxlength=\"10\" " : null;
40f412d8 (root               2011-06-21 17:15:14 -0300 2824) 					$length_serie_out = ($login_fabrica == 15) ? " maxlength=\"10\" " : null;
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300 2825) 
606757d2 (root               2011-07-19 09:50:40 -0300 2826) 					$on_keyUp = ($login_fabrica == 15 || $login_fabrica == 45) ? " onKeyUp=\"somenteMaiusculaSemAcento(this);\" " : null;
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300 2827) 
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300 2828) 
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300 2829) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2830) 					?>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2831) 					<tr height="25px" style="background-color:#F7F5F0">
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300 2832) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2833) 						<td align="center">
a830ce09 (Gabriel Silveira   2012-06-29 10:37:05 -0300 2834) 							<input type="hidden" name="produto_serie_in_out_<?=$i?>" value="<? echo $produto_serie;?>">
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300 2835) 
a830ce09 (Gabriel Silveira   2012-06-29 10:37:05 -0300 2836) 							<input  type="text" class='frm serie' <?echo $length_serie_in; echo $on_keyUp;?> rel="<?php echo $i;?>" id="serie_in_<?echo $i?>" name="serie_in_<?=$i?>" size="15" maxlength="10" value="<? echo $serie_in;?>">
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2837) 						</td>
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300 2838) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2839) 						<td align="center">
a830ce09 (Gabriel Silveira   2012-06-29 10:37:05 -0300 2840) 							<input type="text"  class='frm serie' <?echo $length_serie_out; echo $on_keyUp;?> rel="<?php echo $i;?>" id="serie_out_<?echo $i?>" name="serie_out_<?=$i?>" size="15" maxlength="10" value="<?echo $serie_out;?>">
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2841) 						</td>
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300 2842) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2843) 						<td align="center">
a830ce09 (Gabriel Silveira   2012-06-29 10:37:05 -0300 2844) 							<input type="checkbox" id="apagar_serie_<?echo $i?>" name="apagar_serie_<?echo $i?>" value="excluir" class="frm">
a830ce09 (Gabriel Silveira   2012-06-29 10:37:05 -0300 2845) 							<label style='cursor:pointer' for="apagar_serie_<?echo $i?>">Excluir</label>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2846) 						</td>
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300 2847) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2848) 					</tr>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2849) 					<?php
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2850) 				}
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2851) 			}
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2852) 		?>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2853) 		</table>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2854) 		<table class="formulario" align="center" width="700px" cellpadding="0" cellspacing="0">
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2855) 			<tr>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2856) 				<td>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2857) 					&nbsp;
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2858) 				</td>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2859) 			</tr>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2860) 			<tr>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2861) 				<td align="center">
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2862) 					<input type='button' id='add_line' value='Acrescentar Intervalo de Série' onclick='adiciona()'>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2863) 				</td>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2864) 			</tr>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2865) 		</table>
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300 2866) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2867) 		<?php
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2868) 	}
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300 2869) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2870) 	?>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2871) 	<!-- HD 335150 FIM -->
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2872) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2873) 		<input type='hidden' name='btnacao' value=''>
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300 2874) 		  <?
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2875) 			if($login_fabrica==1 )
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2876) 				echo '<table class="formulario" align="center" width="820" border="0">';
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2877) 			else
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2878) 				echo '<table class="formulario" align="center" width="700" border="0">';
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2879) 		  ?>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2880) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2881) 		<tr><td>&nbsp;</td></tr>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2882) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2883) 		<tr>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2884) 			<td align="center">
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300 2885) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2886) 			<? if (strlen($produto) > 0){
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2887) 				$onclick = "onclick=\"if (confirm('Você irá atualizar um produto! Confirma esta ação? Caso deseje apenas inserir um novo, cancele a operação, limpe as informações da tela e insira o produto!')) { validaForm(); }\" ";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2888) 			}else{
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2889) 				$onclick = "onclick=\"if (document.frm_produto.btnacao.value == '' ) { validaForm(); } else { alert ('Aguarde submissão'); } return false;\" ";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2890) 			}?>
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300 2891) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2892) 			<input type="button" value="Gravar" alt="Gravar formulário" border='0' style="cursor:pointer;" <?php echo $onclick;?> >
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2893) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2894) 		<? if ($login_fabrica == 1 OR $login_fabrica == 14) {
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2895) 			?>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2896) 			<input type="button" value="Apagar" onclick="javascript: if (document.frm_produto.btnacao.value == '' ) { document.frm_produto.btnacao.value='deletar' ; document.frm_produto.submit() } else { alert ('Aguarde submissão') } return false;" ALT="Apagar produto" border='0' style="cursor:pointer;">
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2897) 			<? } ?>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2898) 			<input type="button" value="Limpar" onclick="javascript:  window.location='<? echo $PHP_SELF ?>'; return false;" ALT="Limpar campos" border='0' style="cursor:pointer;">
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2899) 			</td>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2900) 		</tr>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2901) 	</table>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2902) </form>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2903) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2904) <br />
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2905) <?php
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2906) if (strlen($produto) > 0) {
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2907)     if (strlen($admin) > 0 and strlen($data_atualizacao) > 0) { ?>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2908)         <div id="wrapper">
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2909)             <!-- <a href='PROVISORIO_produto_garantia.php' TARGET='_blank'></a> -->
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2910)             ÚLTIMA ATUALIZAÇÃO
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300 2911) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2912)             <!-- <a href='PROVISORIO_produto_garantia.php' TARGET='_blank'></a> -->
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2913)             <?echo $admin ." - ". $data_atualizacao;?>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2914)         </div><?php
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2915)     }
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2916) }?>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2917) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2918) </div>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2919) </div><?php
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2920) // SE FOR INTELBRÁS OU MAXCOM HD 40530
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2921) if (($login_fabrica == 14 or $login_fabrica == 66) and strlen($produto) > 0) {
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2922)     $sql = "SELECT  tbl_produto.produto   ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2923)                     tbl_produto.referencia,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2924)                     tbl_produto.descricao
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2925)             FROM    tbl_subproduto
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2926)             JOIN    tbl_produto ON tbl_produto.produto = tbl_subproduto.produto_filho
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2927)             JOIN    tbl_linha   ON tbl_linha.linha     = tbl_produto.linha
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2928)             WHERE   tbl_linha.fabrica          = $login_fabrica
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2929)             AND     tbl_subproduto.produto_pai = $produto
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2930)             ORDER BY tbl_produto.descricao;";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2931) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2932)     $res0 = @pg_query ($con,$sql);
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2933) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2934)     if (@pg_num_rows($res0) > 0) {
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2935) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2936)         echo "<table width='400' border='0' class='titulo' cellpadding='2' cellspacing='1' align='center'>\n";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2937)         echo "<tr align='center'>\n";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2938)         echo "<td colspan='3' bgcolor='#D9E2EF' nowrap>PRODUTOS / SUBPRODUTOS RELACIONADOS</td>\n";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2939)         echo "</tr>\n";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2940)         echo "<tr align='center'>\n";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2941)         echo "<td bgcolor='#D9E2EF' nowrap>REFERÊNCIA</td>\n";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2942)         echo "<td bgcolor='#D9E2EF' nowrap>DESCRIÇÃO</td>\n";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2943)         echo "<td bgcolor='#D9E2EF' nowrap>LISTA BÁSICA</td>\n";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2944)         echo "</tr>\n";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2945) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2946)         for ($y = 0; $y < @pg_num_rows($res0); $y++) {
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2947) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2948)             $produto    = trim(pg_fetch_result($res0,$y,produto));
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2949)             $referencia = trim(pg_fetch_result($res0,$y,referencia));
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2950)             $descricao  = trim(pg_fetch_result($res0,$y,descricao));
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2951) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2952)             $cor = ($y % 2 == 0) ? "#F1F4FA" : "#F7F5F0";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2953) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2954)             echo "<tr bgcolor='$cor'>\n";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2955)             echo "<td width='15%' align='center' nowrap><a href='$PHP_SELF?produto=$produto'>$referencia</a></td>";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2956)             echo "<td width='85%' align='left' nowrap><a href='$PHP_SELF?produto=$produto'>$descricao</a></td>\n";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2957)             echo "<td width='85%' align='center' nowrap><a href='lbm_cadastro.php?produto=$produto' target='_blank'><img src='imagens/btn_lista.gif' border=0/></a></td>\n";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2958)             echo "</tr>\n";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2959)         }
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2960)         echo "</table>\n\n";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2961)         echo "<br>\n\n";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2962)     }
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2963) }
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2964) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2965) if (strlen($produto) > 0 AND $ip == '201.0.9.216') {
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2966)     echo "<font size='1'><a href='preco_cadastro_produto_lbm.php?produto=$produto&btn_acao=listar'>CLIQUE AQUI PARA LISTAR A TABELA DE PREÇOS</a></font>\n<br>\n<br>\n";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2967) }
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2968) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2969) if ($login_fabrica == 3) {?>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2970)     <div id="wrapper">
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2971)         <a href='produto_consulta_parametro.php' target='_blank'>CLIQUE AQUI PARA CONSULTAR TODOS OS PRODUTOS, FILTRANDO DE ACORDO COM O TIPO (EX.: TROCA OBRIGATÓRIA)</a>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2972)     </div><?php
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2973) }?>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2974) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2975) <div id="wrapper">
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2976)    <button onclick="window.location='<?echo $PHP_SELF;?>?listartudo=1'">Listar Todos os Produtos</button>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2977) </div><?php
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2978) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2979) $listartudo = $_GET['listartudo'];
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2980) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2981) if ($listartudo == 1) {
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 2982) 
beda7224 (Brayan Laurindo    2011-10-03 11:03:09 -0300 2983) 	if ( $login_fabrica == 20 ) { //703506
beda7224 (Brayan Laurindo    2011-10-03 11:03:09 -0300 2984) 
beda7224 (Brayan Laurindo    2011-10-03 11:03:09 -0300 2985) 		$sql = "SELECT  tbl_produto.referencia,
beda7224 (Brayan Laurindo    2011-10-03 11:03:09 -0300 2986) 					tbl_produto.referencia_fabrica,
beda7224 (Brayan Laurindo    2011-10-03 11:03:09 -0300 2987)                     tbl_produto.voltagem  ,
beda7224 (Brayan Laurindo    2011-10-03 11:03:09 -0300 2988) 					tbl_produto.nome_comercial,
beda7224 (Brayan Laurindo    2011-10-03 11:03:09 -0300 2989) 					tbl_produto.origem,
beda7224 (Brayan Laurindo    2011-10-03 11:03:09 -0300 2990) 					tbl_produto.ipi,
beda7224 (Brayan Laurindo    2011-10-03 11:03:09 -0300 2991) 					tbl_produto.classificacao_fiscal,
beda7224 (Brayan Laurindo    2011-10-03 11:03:09 -0300 2992)                     tbl_produto.descricao ,
beda7224 (Brayan Laurindo    2011-10-03 11:03:09 -0300 2993)                     CASE WHEN tbl_produto.ativo IS TRUE THEN 'Ativo' ELSE 'Inativo' END AS ativo     ,
beda7224 (Brayan Laurindo    2011-10-03 11:03:09 -0300 2994)                     tbl_produto.uso_interno_ativo     ,
beda7224 (Brayan Laurindo    2011-10-03 11:03:09 -0300 2995)                     tbl_produto.locador   ,
beda7224 (Brayan Laurindo    2011-10-03 11:03:09 -0300 2996)                     tbl_familia.descricao AS familia,
beda7224 (Brayan Laurindo    2011-10-03 11:03:09 -0300 2997)                     tbl_linha.nome        AS linha
beda7224 (Brayan Laurindo    2011-10-03 11:03:09 -0300 2998)             FROM    tbl_produto
beda7224 (Brayan Laurindo    2011-10-03 11:03:09 -0300 2999)             JOIN    tbl_linha     USING (linha)
beda7224 (Brayan Laurindo    2011-10-03 11:03:09 -0300 3000)             LEFT JOIN tbl_familia USING (familia)
beda7224 (Brayan Laurindo    2011-10-03 11:03:09 -0300 3001)             WHERE   tbl_linha.fabrica = $login_fabrica ";
beda7224 (Brayan Laurindo    2011-10-03 11:03:09 -0300 3002) 
beda7224 (Brayan Laurindo    2011-10-03 11:03:09 -0300 3003) 		$res = pg_query($con,$sql);
beda7224 (Brayan Laurindo    2011-10-03 11:03:09 -0300 3004) 
beda7224 (Brayan Laurindo    2011-10-03 11:03:09 -0300 3005) 		if ( pg_num_rows($res) ) {
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300 3006) 
beda7224 (Brayan Laurindo    2011-10-03 11:03:09 -0300 3007) 			$file 	= "xls/relatorio-produtos-$login_fabrica.xls";
beda7224 (Brayan Laurindo    2011-10-03 11:03:09 -0300 3008) 			$fp		= fopen($file,"w");
beda7224 (Brayan Laurindo    2011-10-03 11:03:09 -0300 3009) 
beda7224 (Brayan Laurindo    2011-10-03 11:03:09 -0300 3010) 			ob_start();
beda7224 (Brayan Laurindo    2011-10-03 11:03:09 -0300 3011) 
beda7224 (Brayan Laurindo    2011-10-03 11:03:09 -0300 3012) 			echo '<table border="1">
beda7224 (Brayan Laurindo    2011-10-03 11:03:09 -0300 3013) 					<tr>
beda7224 (Brayan Laurindo    2011-10-03 11:03:09 -0300 3014) 						<th>Referência</th>
beda7224 (Brayan Laurindo    2011-10-03 11:03:09 -0300 3015) 						<th>Descrição</th>
beda7224 (Brayan Laurindo    2011-10-03 11:03:09 -0300 3016) 						<th>Linha</th>
beda7224 (Brayan Laurindo    2011-10-03 11:03:09 -0300 3017) 						<th>Família</th>
beda7224 (Brayan Laurindo    2011-10-03 11:03:09 -0300 3018) 						<th>Origem</th>
beda7224 (Brayan Laurindo    2011-10-03 11:03:09 -0300 3019) 						<th>Voltagem</th>
beda7224 (Brayan Laurindo    2011-10-03 11:03:09 -0300 3020) 						<th>Status Rede</th>
beda7224 (Brayan Laurindo    2011-10-03 11:03:09 -0300 3021) 						<th>Bar Tool(*)</th>
beda7224 (Brayan Laurindo    2011-10-03 11:03:09 -0300 3022) 						<th>Nome Comercial</th>
beda7224 (Brayan Laurindo    2011-10-03 11:03:09 -0300 3023) 						<th>Classificação Fiscal</th>
beda7224 (Brayan Laurindo    2011-10-03 11:03:09 -0300 3024) 						<th>IPI</th>
beda7224 (Brayan Laurindo    2011-10-03 11:03:09 -0300 3025) 					</tr>';
beda7224 (Brayan Laurindo    2011-10-03 11:03:09 -0300 3026) 
beda7224 (Brayan Laurindo    2011-10-03 11:03:09 -0300 3027) 			for ( $i = 0; $i < pg_num_rows($res); $i++ ) {
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300 3028) 
beda7224 (Brayan Laurindo    2011-10-03 11:03:09 -0300 3029) 				echo '<tr>
beda7224 (Brayan Laurindo    2011-10-03 11:03:09 -0300 3030) 						<td>' . pg_result($res,$i,'referencia') . '</td>
beda7224 (Brayan Laurindo    2011-10-03 11:03:09 -0300 3031) 						<td>' . pg_result($res,$i,'descricao') . '</td>
beda7224 (Brayan Laurindo    2011-10-03 11:03:09 -0300 3032) 						<td>' . pg_result($res,$i,'linha') . '</td>
beda7224 (Brayan Laurindo    2011-10-03 11:03:09 -0300 3033) 						<td>' . pg_result($res,$i,'familia') . '</td>
beda7224 (Brayan Laurindo    2011-10-03 11:03:09 -0300 3034) 						<td>' . pg_result($res,$i,'origem') . '</td>
beda7224 (Brayan Laurindo    2011-10-03 11:03:09 -0300 3035) 						<td>' . pg_result($res,$i,'voltagem') . '</td>
beda7224 (Brayan Laurindo    2011-10-03 11:03:09 -0300 3036) 						<td>' . pg_result($res,$i,'ativo') . '</td>
beda7224 (Brayan Laurindo    2011-10-03 11:03:09 -0300 3037) 						<td>' . pg_result($res,$i,'referencia_fabrica') . '</td>
beda7224 (Brayan Laurindo    2011-10-03 11:03:09 -0300 3038) 						<td>' . pg_result($res,$i,'nome_comercial') . '</td>
beda7224 (Brayan Laurindo    2011-10-03 11:03:09 -0300 3039) 						<td>' . pg_result($res,$i,'classificacao_fiscal') . '</td>
beda7224 (Brayan Laurindo    2011-10-03 11:03:09 -0300 3040) 						<td>' . pg_result($res,$i,'ipi') . '</td>
beda7224 (Brayan Laurindo    2011-10-03 11:03:09 -0300 3041) 					 </tr>';
beda7224 (Brayan Laurindo    2011-10-03 11:03:09 -0300 3042) 
beda7224 (Brayan Laurindo    2011-10-03 11:03:09 -0300 3043) 			}
beda7224 (Brayan Laurindo    2011-10-03 11:03:09 -0300 3044) 
beda7224 (Brayan Laurindo    2011-10-03 11:03:09 -0300 3045) 			echo '</table>';
beda7224 (Brayan Laurindo    2011-10-03 11:03:09 -0300 3046) 
beda7224 (Brayan Laurindo    2011-10-03 11:03:09 -0300 3047) 			$result = ob_get_contents();
beda7224 (Brayan Laurindo    2011-10-03 11:03:09 -0300 3048) 			fwrite($fp,$result);
beda7224 (Brayan Laurindo    2011-10-03 11:03:09 -0300 3049) 			ob_clean();
beda7224 (Brayan Laurindo    2011-10-03 11:03:09 -0300 3050) 
beda7224 (Brayan Laurindo    2011-10-03 11:03:09 -0300 3051) 			echo '<br /><button type="button" onclick="window.open(\''.$file.'\');">Download XLS</button>';
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300 3052) 
beda7224 (Brayan Laurindo    2011-10-03 11:03:09 -0300 3053) 		}
beda7224 (Brayan Laurindo    2011-10-03 11:03:09 -0300 3054) 
beda7224 (Brayan Laurindo    2011-10-03 11:03:09 -0300 3055) 	}
beda7224 (Brayan Laurindo    2011-10-03 11:03:09 -0300 3056) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 3057)     $sql = "SELECT  tbl_produto.referencia,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 3058)                     tbl_produto.voltagem  ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 3059)                     tbl_produto.produto   ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 3060)                     tbl_produto.descricao ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 3061)                     tbl_produto.ativo     ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 3062)                     tbl_produto.uso_interno_ativo     ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 3063)                     tbl_produto.locador   ,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 3064)                     tbl_produto.referencia_fabrica,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 3065)                     tbl_familia.descricao AS familia,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 3066)                     tbl_linha.nome        AS linha
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 3067)             FROM    tbl_produto
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 3068)             JOIN    tbl_linha     USING (linha)
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 3069)             LEFT JOIN tbl_familia USING (familia)
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 3070)             WHERE   tbl_linha.fabrica = $login_fabrica ";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 3071) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 3072)     if ($login_fabrica == 35 or $login_fabrica == 81) {
a4eb7b68 (Francisco Ambrozio 2012-01-31 09:49:39 -0300 3073)                 $sql .= " ORDER BY
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 3074)                 tbl_produto.referencia ASC,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 3075)                 tbl_linha.nome        ASC,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 3076)                 tbl_produto.voltagem  ASC,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 3077)                 tbl_familia.descricao ASC; ";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 3078)     } else {
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 3079)         $sql .=    " ORDER BY    tbl_linha.nome ASC,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 3080)                     tbl_produto.voltagem  ASC,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 3081)                     tbl_produto.descricao ASC,
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 3082)                     tbl_familia.descricao ASC; ";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 3083)     }
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 3084) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 3085)     $res = @pg_query ($con,$sql);
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 3086) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 3087)     for ($i = 0; $i < pg_num_rows($res); $i++) {
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 3088) 		if ($i % 2 == 0) $cor = "#F7F5F0"; else $cor = "#F1F4FA";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 3089)         if ($i % 20 == 0) {
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 3090)             if ($i > 0) echo "</table>";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 3091)             flush();
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 3092) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 3093)             echo "<br />\n";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 3094)             echo "<table width='820' align='center' border='0' class='tabela' cellpadding='2' cellspacing='1'>";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 3095)             echo "<tr class='titulo_coluna'>";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 3096) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 3097)             echo "<td align='center' width='50'>";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 3098)             echo "<b>Status Rede</b>";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 3099)             echo "</td>";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 3100) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 3101)             echo "<td align='center' width='50'>";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 3102)             echo "<b>Status uso Interno</b>";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 3103)             echo "</td>";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 3104) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 3105)             echo "<td align='center' width='200'>";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 3106)             echo "<b>Referência</b>";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 3107)             echo "</td>";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 3108) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 3109)             echo "<td align='center'>";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 3110)             echo "<b>Descrição</b>";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 3111)             echo "</td>";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 3112) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 3113)             if ($login_fabrica == 1 or $login_fabrica == 80) { // HD  90109
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 3114) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 3115)                 echo "<td align='center'>";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 3116)                 echo "<b>Voltagem</b>";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 3117)                 echo "</td>";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 3118) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 3119)                 echo "<td align='center'>";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 3120)                 echo "<b>Referência Interna</b>";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 3121)                 echo "</td>";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 3122) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 3123)                 if ($login_fabrica == 1) {
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 3124)                     echo "<td align='center'>";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 3125)                     echo "<b>Code Convention</b>";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 3126)                     echo "</td>";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 3127)                 }
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 3128) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 3129)             }
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 3130)             echo "<td align='center'>";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 3131)             echo "<b>Família</b>";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 3132)             echo "</td>";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 3133) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 3134)             echo "<td align='center'>";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 3135)             echo "<b>Linha</b>";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 3136)             echo "</td>";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 3137) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 3138)             if ($login_fabrica == 1) { // HD 90109
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 3139)                 echo "<td align='center'>";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 3140)                 echo "<b>Locador</b>";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 3141)                 echo "</td>";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 3142)             }
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 3143) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 3144)             echo "</tr>";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 3145)         }
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 3146) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 3147)         echo "<tr bgcolor = '$cor'>";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 3148) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 3149)         echo "<td align='center'>";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 3150)         if (pg_fetch_result($res,$i,ativo) <> 't') echo "<img src='imagens_admin/status_vermelho.gif' border='0' alt='Inativo'>";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 3151)         else                                  echo "<img src='imagens_admin/status_verde.gif' border='0' alt='Ativo'>";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 3152)         echo "&nbsp;</td>";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 3153)         echo "<td align='center'>";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 3154)         if (pg_fetch_result($res,$i,uso_interno_ativo) <> 't') echo "<img src='imagens_admin/status_vermelho.gif' border='0' alt='Inativo'>";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 3155)         else                                  echo "<img src='imagens_admin/status_verde.gif' border='0' alt='Ativo'>";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 3156)         echo "&nbsp;</td>";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 3157) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 3158)         echo "<td align='left' nowrap>";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 3159)         echo pg_fetch_result($res,$i,referencia);
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 3160)         if ($login_fabrica <> 1 and $login_fabrica <> 80) {
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 3161)             if ($login_fabrica <> 81){
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 3162)                 if (strlen(pg_fetch_result($res,$i,voltagem)) > 0) echo " / ". pg_fetch_result($res,$i,voltagem);
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 3163)             }
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 3164)         }
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 3165) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 3166)         echo "&nbsp;</td>";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 3167) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 3168)         echo "<td align='left' nowrap>";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 3169)         echo "<a href='$PHP_SELF?produto=" . pg_fetch_result($res,$i,produto) . "'>";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 3170)         echo pg_fetch_result($res,$i,descricao);
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 3171)         echo "</a>";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 3172)         echo "&nbsp;</td>";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 3173) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 3174)         if ($login_fabrica == 1 or $login_fabrica == 80) { // HD 90109
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 3175)             echo "<td align='left' nowrap>";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 3176)             echo pg_fetch_result($res,$i,voltagem);
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 3177)             echo "&nbsp;</td>";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 3178) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 3179)             echo "<td align='left' nowrap>";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 3180)             echo pg_fetch_result($res,$i,referencia_fabrica);
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 3181)             echo "&nbsp;</td>";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 3182)         }
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 3183) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 3184)         echo "<td align='left' nowrap>";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 3185)         echo pg_fetch_result($res,$i,familia);
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 3186)         echo "&nbsp;</td>";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 3187) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 3188)         echo "<td align='left' nowrap>";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 3189)         echo pg_fetch_result($res,$i,linha);
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 3190)         echo "&nbsp;</td>";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 3191) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 3192)         if ($login_fabrica == 1) { // HD 90109
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 3193)             echo "<td align='center'>";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 3194)             if (pg_fetch_result($res,$i,locador) <> 't') echo "Não";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 3195)             else                                  echo "Sim";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 3196)             echo "&nbsp;</td>";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 3197)         }
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 3198)         echo "</tr>";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 3199)     }
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 3200)     echo "</table>";
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 3201) }?>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 3202) </center>
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 3203) 
^6bef035 (Tulio Oliveira     2011-06-07 19:01:53 -0300 3204) <?php include "rodape.php"; ?>
